!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define("microsoftTeams",[],n):"object"==typeof exports?exports.microsoftTeams=n():e.microsoftTeams=n()}("undefined"!=typeof self?self:this,(()=>(()=>{var e={302:(e,n,t)=>{n.formatArgs=function(n){if(n[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+n[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const t="color: "+this.color;n.splice(1,0,t,"color: inherit");let o=0,r=0;n[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(o++,"%c"===e&&(r=o))})),n.splice(r,0,t)},n.save=function(e){try{e?n.storage.setItem("debug",e):n.storage.removeItem("debug")}catch(e){}},n.load=function(){let e;try{e=n.storage.getItem("debug")}catch(e){}!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG);return e},n.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},n.storage=function(){try{return localStorage}catch(e){}}(),n.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),n.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],n.log=console.debug||console.log||(()=>{}),e.exports=t(65)(n);const{formatters:o}=e.exports;o.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},65:(e,n,t)=>{e.exports=function(e){function n(e){let t,r,i,a=null;function s(...e){if(!s.enabled)return;const o=s,r=Number(new Date),i=r-(t||r);o.diff=i,o.prev=t,o.curr=r,t=r,e[0]=n.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((t,r)=>{if("%%"===t)return"%";a++;const i=n.formatters[r];if("function"==typeof i){const n=e[a];t=i.call(o,n),e.splice(a,1),a--}return t})),n.formatArgs.call(o,e);(o.log||n.log).apply(o,e)}return s.namespace=e,s.useColors=n.useColors(),s.color=n.selectColor(e),s.extend=o,s.destroy=n.destroy,Object.defineProperty(s,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==a?a:(r!==n.namespaces&&(r=n.namespaces,i=n.enabled(e)),i),set:e=>{a=e}}),"function"==typeof n.init&&n.init(s),s}function o(e,t){const o=n(this.namespace+(void 0===t?":":t)+e);return o.log=this.log,o}function r(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return n.debug=n,n.default=n,n.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},n.disable=function(){const e=[...n.names.map(r),...n.skips.map(r).map((e=>"-"+e))].join(",");return n.enable(""),e},n.enable=function(e){let t;n.save(e),n.namespaces=e,n.names=[],n.skips=[];const o=("string"==typeof e?e:"").split(/[\s,]+/),r=o.length;for(t=0;t<r;t++)o[t]&&("-"===(e=o[t].replace(/\*/g,".*?"))[0]?n.skips.push(new RegExp("^"+e.slice(1)+"$")):n.names.push(new RegExp("^"+e+"$")))},n.enabled=function(e){if("*"===e[e.length-1])return!0;let t,o;for(t=0,o=n.skips.length;t<o;t++)if(n.skips[t].test(e))return!1;for(t=0,o=n.names.length;t<o;t++)if(n.names[t].test(e))return!0;return!1},n.humanize=t(247),n.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((t=>{n[t]=e[t]})),n.names=[],n.skips=[],n.formatters={},n.selectColor=function(e){let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return n.colors[Math.abs(t)%n.colors.length]},n.enable(n.load()),n}},247:e=>{var n=1e3,t=60*n,o=60*t,r=24*o,i=7*r,a=365.25*r;function s(e){if(!((e=String(e)).length>100)){var s=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(s){var c=parseFloat(s[1]);switch((s[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return c*a;case"weeks":case"week":case"w":return c*i;case"days":case"day":case"d":return c*r;case"hours":case"hour":case"hrs":case"hr":case"h":return c*o;case"minutes":case"minute":case"mins":case"min":case"m":return c*t;case"seconds":case"second":case"secs":case"sec":case"s":return c*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}}}function c(e){var i=Math.abs(e);return i>=r?Math.round(e/r)+"d":i>=o?Math.round(e/o)+"h":i>=t?Math.round(e/t)+"m":i>=n?Math.round(e/n)+"s":e+"ms"}function l(e){var i=Math.abs(e);return i>=r?u(e,i,r,"day"):i>=o?u(e,i,o,"hour"):i>=t?u(e,i,t,"minute"):i>=n?u(e,i,n,"second"):e+" ms"}function u(e,n,t,o){var r=n>=1.5*t;return Math.round(e/t)+" "+o+(r?"s":"")}e.exports=function(e,n){n=n||{};var t=typeof e;if("string"===t&&e.length>0)return s(e);if("number"===t&&isFinite(e))return n.long?l(e):c(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}}},n={};function t(o){var r=n[o];if(void 0!==r)return r.exports;var i=n[o]={exports:{}};return e[o](i,i.exports,t),i.exports}(()=>{t.d=(e,n)=>{for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})}})(),(()=>{t.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n)})(),(()=>{t.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}})();var o={};return(()=>{"use strict";t.r(o),t.d(o,{ActionObjectType:()=>R,ChannelType:()=>W,ChildAppWindow:()=>At,ContainerState:()=>Mo,DialogDimension:()=>x,ErrorCode:()=>M,FileOpenPreference:()=>A,FrameContexts:()=>U,HostClientType:()=>N,HostName:()=>L,LiveShareHost:()=>_o,NotificationTypes:()=>Pn,ParentAppWindow:()=>Rt,SecondaryM365ContentIdName:()=>O,TaskModuleDimension:()=>_,TeamType:()=>H,UserMeetingRole:()=>Oo,UserSettingTypes:()=>kn,UserTeamRole:()=>V,ViewerActionTypes:()=>Fn,app:()=>Ee,appEntity:()=>Vo,appInitialization:()=>Yt,appInstallDialog:()=>jn,authentication:()=>ye,barCode:()=>ut,calendar:()=>Dt,call:()=>$t,chat:()=>dt,conversations:()=>An,dialog:()=>be,enablePrintCapability:()=>ao,executeDeepLink:()=>To,files:()=>No,geoLocation:()=>ft,getAdaptiveCardSchemaVersion:()=>Pt,getContext:()=>co,getMruTabInstances:()=>bo,getTabInstances:()=>yo,initialize:()=>io,initializeWithFrameContext:()=>Io,isSupported:()=>Bo,location:()=>kt,logs:()=>In,mail:()=>Nt,media:()=>lt,meeting:()=>Ot,meetingRoom:()=>Lo,menus:()=>Se,monetization:()=>Mt,navigateBack:()=>Ao,navigateCrossDomain:()=>ko,navigateToTab:()=>Fo,notifications:()=>Uo,openFilePreview:()=>zn,pages:()=>Ie,people:()=>Lt,print:()=>so,profile:()=>Ut,registerAppButtonClickHandler:()=>fo,registerAppButtonHoverEnterHandler:()=>po,registerAppButtonHoverLeaveHandler:()=>go,registerBackButtonHandler:()=>mo,registerBeforeUnloadHandler:()=>wo,registerChangeSettingsHandler:()=>vo,registerCustomHandler:()=>_n,registerFocusEnterHandler:()=>Co,registerFullScreenHandler:()=>uo,registerOnLoadHandler:()=>ho,registerOnThemeChangeHandler:()=>lo,registerUserSettingsChangeHandler:()=>Bn,remoteCamera:()=>Ho,returnFocus:()=>Po,search:()=>Zt,secondaryBrowser:()=>Ft,sendCustomEvent:()=>Wn,sendCustomMessage:()=>xn,setFrameContext:()=>Eo,settings:()=>eo,shareDeepLink:()=>So,sharing:()=>Jt,stageView:()=>Qt,tasks:()=>Ro,teams:()=>xo,teamsCore:()=>Te,uploadCustomApp:()=>Vn,version:()=>Pe,video:()=>Kt,videoEx:()=>Wo,webStorage:()=>Xt});var e="2.0.1",n="2.0.2",r="2.0.3",i="2.0.4",a="2.0.1",s="1.9.0",c="2.0.0",l="1.7.0",u="1.8.0",d="1.9.0",f=["teams.microsoft.com","teams.microsoft.us","gov.teams.microsoft.us","dod.teams.microsoft.us","int.teams.microsoft.com","teams.live.com","devspaces.skype.com","ssauth.skype.com","local.teams.live.com","local.teams.live.com:8080","local.teams.office.com","local.teams.office.com:8080","outlook.office.com","outlook-sdf.office.com","outlook.office365.com","outlook-sdf.office365.com","outlook.live.com","outlook-sdf.live.com","*.teams.microsoft.com","*.www.office.com","www.office.com","word.office.com","excel.office.com","powerpoint.office.com","www.officeppe.com","*.www.microsoft365.com","www.microsoft365.com"],p=/^https:\/\//,g="https",m="teams.microsoft.com",h="The library has not yet been initialized",w="The runtime has not yet been initialized",C="The runtime version is not supported",v=function(){function e(){}return e.initializeCalled=!1,e.initializeCompleted=!1,e.additionalValidOrigins=[],e.isFramelessWindow=!1,e.printCapabilityEnabled=!1,e}(),y=(0,t(302).debug)("teamsJs");function b(e){return y.extend(e)}const S={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let T;const E=new Uint8Array(16);function I(){if(!T&&(T="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!T))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return T(E)}const P=[];for(let e=0;e<256;++e)P.push((e+256).toString(16).slice(1));function F(e,n=0){return(P[e[n+0]]+P[e[n+1]]+P[e[n+2]]+P[e[n+3]]+"-"+P[e[n+4]]+P[e[n+5]]+"-"+P[e[n+6]]+P[e[n+7]]+"-"+P[e[n+8]]+P[e[n+9]]+"-"+P[e[n+10]]+P[e[n+11]]+P[e[n+12]]+P[e[n+13]]+P[e[n+14]]+P[e[n+15]]).toLowerCase()}const k=function(e,n,t){if(S.randomUUID&&!n&&!e)return S.randomUUID();const o=(e=e||{}).random||(e.rng||I)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,n){t=t||0;for(let e=0;e<16;++e)n[t+e]=o[e];return n}return F(o)};var A,R,O,M,D,N,L,U,H,V,x;!function(e){e.Inline="inline",e.Desktop="desktop",e.Web="web"}(A||(A={})),function(e){e.M365Content="m365content"}(R||(R={})),function(e){e.DriveId="driveId",e.GroupId="groupId",e.SiteId="siteId",e.UserId="userId"}(O||(O={})),function(e){e[e.NOT_SUPPORTED_ON_PLATFORM=100]="NOT_SUPPORTED_ON_PLATFORM",e[e.INTERNAL_ERROR=500]="INTERNAL_ERROR",e[e.NOT_SUPPORTED_IN_CURRENT_CONTEXT=501]="NOT_SUPPORTED_IN_CURRENT_CONTEXT",e[e.PERMISSION_DENIED=1e3]="PERMISSION_DENIED",e[e.NETWORK_ERROR=2e3]="NETWORK_ERROR",e[e.NO_HW_SUPPORT=3e3]="NO_HW_SUPPORT",e[e.INVALID_ARGUMENTS=4e3]="INVALID_ARGUMENTS",e[e.UNAUTHORIZED_USER_OPERATION=5e3]="UNAUTHORIZED_USER_OPERATION",e[e.INSUFFICIENT_RESOURCES=6e3]="INSUFFICIENT_RESOURCES",e[e.THROTTLE=7e3]="THROTTLE",e[e.USER_ABORT=8e3]="USER_ABORT",e[e.OPERATION_TIMED_OUT=8001]="OPERATION_TIMED_OUT",e[e.OLD_PLATFORM=9e3]="OLD_PLATFORM",e[e.FILE_NOT_FOUND=404]="FILE_NOT_FOUND",e[e.SIZE_EXCEEDED=1e4]="SIZE_EXCEEDED"}(M||(M={})),function(e){e.GeoLocation="geolocation",e.Media="media"}(D||(D={})),function(e){e.desktop="desktop",e.web="web",e.android="android",e.ios="ios",e.ipados="ipados",e.rigel="rigel",e.surfaceHub="surfaceHub",e.teamsRoomsWindows="teamsRoomsWindows",e.teamsRoomsAndroid="teamsRoomsAndroid",e.teamsPhones="teamsPhones",e.teamsDisplays="teamsDisplays"}(N||(N={})),function(e){e.office="Office",e.outlook="Outlook",e.outlookWin32="OutlookWin32",e.orange="Orange",e.teams="Teams",e.teamsModern="TeamsModern"}(L||(L={})),function(e){e.settings="settings",e.content="content",e.authentication="authentication",e.remove="remove",e.task="task",e.sidePanel="sidePanel",e.stage="stage",e.meetingStage="meetingStage"}(U||(U={})),function(e){e[e.Standard=0]="Standard",e[e.Edu=1]="Edu",e[e.Class=2]="Class",e[e.Plc=3]="Plc",e[e.Staff=4]="Staff"}(H||(H={})),function(e){e[e.Admin=0]="Admin",e[e.User=1]="User",e[e.Guest=2]="Guest"}(V||(V={})),function(e){e.Large="large",e.Medium="medium",e.Small="small"}(x||(x={}));var W,_=x;!function(e){e.Regular="Regular",e.Private="Private",e.Shared="Shared"}(W||(W={}));var B={errorCode:M.NOT_SUPPORTED_ON_PLATFORM},z={majorVersion:1,minorVersion:5},j={adaptiveCardSchemaVersion:{majorVersion:1,minorVersion:5}};function G(e,n){if("*."===e.substring(0,2)){var t=e.substring(1);if(n.length>t.length&&n.split(".").length===t.split(".").length&&n.substring(n.length-t.length)===t)return!0}else if(e===n)return!0;return!1}function q(e){if(!oe(e))return!1;var n=e.host;if(f.some((function(e){return G(e,n)})))return!0;for(var t=0,o=v.additionalValidOrigins;t<o.length;t++){var r=o[t];if(G("https://"===r.substring(0,8)?r.substring(8):r,n))return!0}return!1}function K(e){return function(n,t){if(!n)throw new Error(e||t)}}function Z(e,n){if("string"!=typeof e||"string"!=typeof n)return NaN;var t=e.split("."),o=n.split(".");function r(e){return/^\d+$/.test(e)}if(!t.every(r)||!o.every(r))return NaN;for(;t.length<o.length;)t.push("0");for(;o.length<t.length;)o.push("0");for(var i=0;i<t.length;++i)if(Number(t[i])!=Number(o[i]))return Number(t[i])>Number(o[i])?1:-1;return 0}function J(){return k()}function Q(e){return Object.keys(e).forEach((function(n){"object"==typeof e[n]&&Q(e[n])})),Object.freeze(e)}function X(e,n){for(var t=[],o=2;o<arguments.length;o++)t[o-2]=arguments[o];var r=e.apply(void 0,t);return r.then((function(e){n&&n(void 0,e)})).catch((function(e){n&&n(e)})),r}function $(e,n){for(var t=[],o=2;o<arguments.length;o++)t[o-2]=arguments[o];var r=e.apply(void 0,t);return r.then((function(){n&&n(null)})).catch((function(e){n&&n(e)})),r}function Y(e,n){for(var t=[],o=2;o<arguments.length;o++)t[o-2]=arguments[o];var r=e.apply(void 0,t);return r.then((function(e){n&&n(null,e)})).catch((function(e){n&&n(e,null)})),r}function ee(e,n,t){return new Promise((function(o,r){var i=setTimeout(r,n,t);e().then((function(e){clearTimeout(i),o(e)})).catch((function(e){clearTimeout(i),r(e)}))}))}function ne(e){var n=new URL("https://teams.microsoft.com/l/entity/"+encodeURIComponent(e.appId)+"/"+encodeURIComponent(e.pageId));return e.webUrl&&n.searchParams.append("webUrl",e.webUrl),(e.channelId||e.subPageId)&&n.searchParams.append("context",JSON.stringify({channelId:e.channelId,subEntityId:e.subPageId})),n.toString()}function te(e){return!(Z("".concat(e.majorVersion,".").concat(e.minorVersion),"".concat(z.majorVersion,".").concat(z.minorVersion))>=0)}function oe(e){return"https:"===e.protocol}var re=function(){return re=Object.assign||function(e){for(var n,t=1,o=arguments.length;t<o;t++)for(var r in n=arguments[t])Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e},re.apply(this,arguments)},ie=b("runtime"),ae=2;function se(e){return e.apiVersion===ae}var ce={apiVersion:-1,supports:{}};function le(e){if(se(e))return!0;throw-1===e.apiVersion?new Error(w):new Error(C)}var ue=ce,de={apiVersion:2,hostVersionsInfo:j,isLegacyTeams:!0,supports:{appInstallDialog:{},appEntity:{},call:{},chat:{},conversations:{},dialog:{card:{bot:{}},url:{bot:{}},update:{}},interactive:{},logs:{},meetingRoom:{},menus:{},monetization:{},notifications:{},pages:{appButton:{},tabs:{},config:{},backStack:{},fullTrust:{}},remoteCamera:{},stageView:{},teams:{fullTrust:{}},teamsCore:{},video:{sharedFrame:{}}}},fe=[N.desktop,N.web,N.android,N.ios,N.rigel,N.surfaceHub,N.teamsRoomsWindows,N.teamsRoomsAndroid,N.teamsPhones,N.teamsDisplays];function pe(e){var n=e;if(n.apiVersion<ae&&ge.forEach((function(e){n.apiVersion===e.versionToUpgradeFrom&&(n=e.upgradeToNextVersion(n))})),se(n))return n;throw new Error("Received a runtime that could not be upgraded to the latest version")}var ge=[{versionToUpgradeFrom:1,upgradeToNextVersion:function(e){var n;return{apiVersion:2,hostVersionsInfo:void 0,isLegacyTeams:e.isLegacyTeams,supports:re(re({},e.supports),{dialog:e.supports.dialog?{card:void 0,url:e.supports.dialog,update:null===(n=e.supports.dialog)||void 0===n?void 0:n.update}:void 0})}}}],me={"1.9.0":[{capability:{location:{}},hostClientTypes:fe}],"2.0.0":[{capability:{people:{}},hostClientTypes:fe},{capability:{sharing:{}},hostClientTypes:[N.desktop,N.web]}],"2.0.1":[{capability:{teams:{fullTrust:{joinedTeams:{}}}},hostClientTypes:[N.android,N.desktop,N.ios,N.teamsRoomsAndroid,N.teamsPhones,N.teamsDisplays,N.web]},{capability:{webStorage:{}},hostClientTypes:[N.desktop]}],"2.0.5":[{capability:{webStorage:{}},hostClientTypes:[N.android,N.desktop,N.ios]}]},he=ie.extend("generateBackCompatRuntimeConfig");function we(e){he("generating back compat runtime config for %s",e);var n=re({},de.supports);he("Supported capabilities in config before updating based on highestSupportedVersion: %o",n),Object.keys(me).forEach((function(t){Z(e,t)>=0&&me[t].forEach((function(e){e.hostClientTypes.includes(v.hostClientType)&&(n=re(re({},n),e.capability))}))}));var t={apiVersion:2,hostVersionsInfo:j,isLegacyTeams:!0,supports:n};return he("Runtime config after updating based on highestSupportedVersion: %o",t),t}var Ce=ie.extend("applyRuntimeConfig");function ve(e){"string"==typeof e.apiVersion&&(Ce("Trying to apply runtime with string apiVersion, processing as v1: %o",e),e=re(re({},e),{apiVersion:1})),Ce("Fast-forwarding runtime %o",e);var n=pe(e);Ce("Applying runtime %o",n),ue=Q(n)}var ye,be,Se,Te,Ee,Ie,Pe="2.12.0",Fe=b("internal"),ke=Fe.extend("ensureInitializeCalled"),Ae=Fe.extend("ensureInitialized");function Re(){if(!v.initializeCalled)throw ke(h),new Error(h)}function Oe(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];if(!v.initializeCompleted)throw Ae("%s. initializeCalled: %s",h,v.initializeCalled.toString()),new Error(h);if(n&&n.length>0){for(var o=!1,r=0;r<n.length;r++)if(n[r]===v.frameContext){o=!0;break}if(!o)throw new Error("This call is only allowed in following contexts: ".concat(JSON.stringify(n),". ")+'Current context: "'.concat(v.frameContext,'".'))}return le(e)}function Me(n){void 0===n&&(n=e);var t=Z(v.clientSupportedSDKVersion,n);return!isNaN(t)&&t>=0}function De(){return v.hostClientType==N.android||v.hostClientType==N.ios||v.hostClientType==N.ipados}function Ne(n){if(void 0===n&&(n=e),!De())throw{errorCode:M.NOT_SUPPORTED_ON_PLATFORM};if(!Me(n))throw{errorCode:M.OLD_PLATFORM}}function Le(e){var n=v.additionalValidOrigins.concat(e.filter((function(e){return"string"==typeof e&&p.test(e)}))),t={};n=n.filter((function(e){return!t[e]&&(t[e]=!0,!0)})),v.additionalValidOrigins=n}function Ue(){return"undefined"==typeof window}function He(e){return{actionInfo:e.actionInfo,app:{locale:e.locale,sessionId:e.appSessionId?e.appSessionId:"",theme:e.theme?e.theme:"default",iconPositionVertical:e.appIconPosition,osLocaleInfo:e.osLocaleInfo,parentMessageId:e.parentMessageId,userClickTime:e.userClickTime,userFileOpenPreference:e.userFileOpenPreference,host:{name:e.hostName?e.hostName:L.teams,clientType:e.hostClientType?e.hostClientType:N.web,sessionId:e.sessionId?e.sessionId:"",ringId:e.ringId},appLaunchId:e.appLaunchId},page:{id:e.entityId,frameContext:e.frameContext?e.frameContext:v.frameContext,subPageId:e.subEntityId,isFullScreen:e.isFullScreen,isMultiWindow:e.isMultiWindow,sourceOrigin:e.sourceOrigin},user:{id:e.userObjectId,displayName:e.userDisplayName,isCallingAllowed:e.isCallingAllowed,isPSTNCallingAllowed:e.isPSTNCallingAllowed,licenseType:e.userLicenseType,loginHint:e.loginHint,userPrincipalName:e.userPrincipalName,tenant:e.tid?{id:e.tid,teamsSku:e.tenantSKU}:void 0},channel:e.channelId?{id:e.channelId,displayName:e.channelName,relativeUrl:e.channelRelativeUrl,membershipType:e.channelType,defaultOneNoteSectionId:e.defaultOneNoteSectionId,ownerGroupId:e.hostTeamGroupId,ownerTenantId:e.hostTeamTenantId}:void 0,chat:e.chatId?{id:e.chatId}:void 0,meeting:e.meetingId?{id:e.meetingId}:void 0,sharepoint:e.sharepoint,team:e.teamId?{internalId:e.teamId,displayName:e.teamName,type:e.teamType,groupId:e.groupId,templateId:e.teamTemplateId,isArchived:e.isTeamArchived,userRole:e.userTeamRole}:void 0,sharePointSite:e.teamSiteUrl||e.teamSiteDomain||e.teamSitePath||e.mySitePath||e.mySiteDomain?{teamSiteUrl:e.teamSiteUrl,teamSiteDomain:e.teamSiteDomain,teamSitePath:e.teamSitePath,teamSiteId:e.teamSiteId,mySitePath:e.mySitePath,mySiteDomain:e.mySiteDomain}:void 0}}!function(e){var n,t,o;function r(e){return new Promise((function(t,o){if(v.hostClientType===N.desktop||v.hostClientType===N.android||v.hostClientType===N.ios||v.hostClientType===N.ipados||v.hostClientType===N.rigel||v.hostClientType===N.teamsRoomsWindows||v.hostClientType===N.teamsRoomsAndroid||v.hostClientType===N.teamsPhones||v.hostClientType===N.teamsDisplays){var r=document.createElement("a");r.href=e.url,t(dn("authentication.authenticate",[r.href,e.width,e.height,e.isExternal]).then((function(e){var n=e[0],t=e[1];if(n)return t;throw new Error(t)})))}else n={success:t,fail:o},c(e)}))}function i(e){return new Promise((function(n){n(dn("authentication.getAuthToken",[null==e?void 0:e.resources,null==e?void 0:e.claims,null==e?void 0:e.silent]))})).then((function(e){var n=e[0],t=e[1];if(n)return t;throw new Error(t)}))}function a(){return new Promise((function(e){e(dn("authentication.getUser"))})).then((function(e){var n=e[0],t=e[1];if(n)return t;throw new Error(t)}))}function s(){l();try{tn.childWindow&&tn.childWindow.close()}finally{tn.childWindow=null,tn.childOrigin=null}}function c(e){s();var n=e.width||600,t=e.height||400;n=Math.min(n,tn.currentWindow.outerWidth-400),t=Math.min(t,tn.currentWindow.outerHeight-200);var o=document.createElement("a");o.href=e.url.replace("{oauthRedirectMethod}","web");var r=void 0!==tn.currentWindow.screenLeft?tn.currentWindow.screenLeft:tn.currentWindow.screenX,i=void 0!==tn.currentWindow.screenTop?tn.currentWindow.screenTop:tn.currentWindow.screenY;r+=tn.currentWindow.outerWidth/2-n/2,i+=tn.currentWindow.outerHeight/2-t/2,tn.childWindow=tn.currentWindow.open(o.href,"_blank","toolbar=no, location=yes, status=no, menubar=no, scrollbars=yes, top="+i+", left="+r+", width="+n+", height="+t),tn.childWindow?u():f("FailedToOpenWindow")}function l(){t&&(clearInterval(t),t=0),Ge("initialize"),Ge("navigateCrossDomain")}function u(){l(),t=tn.currentWindow.setInterval((function(){if(!tn.childWindow||tn.childWindow.closed)f("CancelledByUser");else{var e=tn.childOrigin;try{tn.childOrigin="*",Nn("ping")}finally{tn.childOrigin=e}}}),100),je("initialize",(function(){return[U.authentication,v.hostClientType]})),je("navigateCrossDomain",(function(){return!1}))}function d(e){try{n&&n.success(e)}finally{n=null,s()}}function f(e){try{n&&n.fail(new Error(e))}finally{n=null,s()}}function p(e,n,t){if(e){var o=document.createElement("a");o.href=decodeURIComponent(e),o.host&&o.host!==window.location.host&&"outlook.office.com"===o.host&&o.search.indexOf("client_type=Win32_Outlook")>-1&&(n&&"result"===n&&(t&&(o.href=g(o.href,"result",t)),tn.currentWindow.location.assign(g(o.href,"authSuccess",""))),n&&"reason"===n&&(t&&(o.href=g(o.href,"reason",t)),tn.currentWindow.location.assign(g(o.href,"authFailure",""))))}}function g(e,n,t){var o=e.indexOf("#"),r=-1===o?"#":e.substr(o);return r=r+"&"+n+(""!==t?"="+t:""),(e=-1===o?e:e.substr(0,o))+r}e.initialize=function(){je("authentication.authenticate.success",d,!1),je("authentication.authenticate.failure",f,!1)},e.registerAuthenticationHandlers=function(e){o=e},e.authenticate=function(e){var n=void 0!==e,t=n?e:o;if(!t)throw new Error("No parameters are provided for authentication");return Oe(ue,U.content,U.sidePanel,U.settings,U.remove,U.task,U.stage,U.meetingStage),r(t).then((function(e){try{return t&&t.successCallback?(t.successCallback(e),""):e}finally{n||(o=null)}})).catch((function(e){try{if(t&&t.failureCallback)return t.failureCallback(e.message),"";throw e}finally{n||(o=null)}}))},e.getAuthToken=function(e){return Re(),i(e).then((function(n){return e&&e.successCallback?(e.successCallback(n),""):n})).catch((function(n){if(e&&e.failureCallback)return e.failureCallback(n.message),"";throw n}))},e.getUser=function(e){return Re(),a().then((function(n){return e&&e.successCallback?(e.successCallback(n),null):n})).catch((function(n){if(e&&e.failureCallback)return e.failureCallback(n.message),null;throw n}))},e.notifySuccess=function(e,n){p(n,"result",e),Oe(ue,U.authentication),pn("authentication.authenticate.success",[e]),Mn(tn.parentWindow,(function(){return setTimeout((function(){return tn.currentWindow.close()}),200)}))},e.notifyFailure=function(e,n){p(n,"reason",e),Oe(ue,U.authentication),pn("authentication.authenticate.failure",[e]),Mn(tn.parentWindow,(function(){return setTimeout((function(){return tn.currentWindow.close()}),200)}))},function(e){e.Public="public",e.EUDB="eudb",e.Other="other"}(e.DataResidency||(e.DataResidency={}))}(ye||(ye={})),function(e){var n=[];function t(e){v.frameContext&&(v.frameContext===U.task?n.push(e):Ge("messageForChild"))}e.initialize=function(){je("messageForChild",t,!1)},function(e){function t(){return Oe(ue)&&void 0!==(ue.supports.dialog&&ue.supports.dialog.url)}function o(e){return{url:e.url,height:e.size?e.size.height:x.Small,width:e.size?e.size.width:x.Small,title:e.title,fallbackUrl:e.fallbackUrl}}function r(e){var n=o(e);return n.completionBotId=e.completionBotId,n}e.open=function(e,n,r){if(Oe(ue,U.content,U.sidePanel,U.meetingStage),!t())throw B;r&&je("messageForParent",r),pn("tasks.startTask",[o(e)],(function(e,t){null==n||n({err:e,result:t}),Ge("messageForParent")}))},e.submit=function(e,n){if(Oe(ue,U.content,U.task),!t())throw B;pn("tasks.completeTask",[e,n?Array.isArray(n)?n:[n]:[]])},e.sendMessageToParentFromDialog=function(e){if(Oe(ue,U.task),!t())throw B;pn("messageForParent",[e])},e.sendMessageToDialog=function(e){if(Oe(ue,U.content,U.sidePanel,U.meetingStage),!t())throw B;pn("messageForChild",[e])},e.registerOnMessageFromParent=function(e){if(Oe(ue,U.task),!t())throw B;for(Ge("messageForChild"),je("messageForChild",e),n.reverse();n.length>0;){e(n.pop())}},e.isSupported=t,function(e){function n(){return Oe(ue)&&void 0!==(ue.supports.dialog&&ue.supports.dialog.url&&ue.supports.dialog.url.bot)}e.open=function(e,t,o){if(Oe(ue,U.content,U.sidePanel,U.meetingStage),!n())throw B;o&&je("messageForParent",o),pn("tasks.startTask",[r(e)],(function(e,n){null==t||t({err:e,result:n}),Ge("messageForParent")}))},e.isSupported=n}(e.bot||(e.bot={})),e.getDialogInfoFromUrlDialogInfo=o,e.getDialogInfoFromBotUrlDialogInfo=r}(e.url||(e.url={})),e.isSupported=function(){return!(!Oe(ue)||!ue.supports.dialog)},function(e){function n(){return!(!Oe(ue)||!ue.supports.dialog)&&!!ue.supports.dialog.update}e.resize=function(e){if(Oe(ue,U.content,U.sidePanel,U.task,U.meetingStage),!n())throw B;pn("tasks.updateTask",[e])},e.isSupported=n}(e.update||(e.update={})),function(e){function n(){var e=ue.hostVersionsInfo&&ue.hostVersionsInfo.adaptiveCardSchemaVersion&&!te(ue.hostVersionsInfo.adaptiveCardSchemaVersion);return Oe(ue)&&void 0!==(e&&ue.supports.dialog&&ue.supports.dialog.card)}function t(e){return{card:e.card,height:e.size?e.size.height:x.Small,width:e.size?e.size.width:x.Small,title:e.title}}function o(e){var n=t(e);return n.completionBotId=e.completionBotId,n}e.open=function(e,o){if(Oe(ue,U.content,U.sidePanel,U.meetingStage),!n())throw B;pn("tasks.startTask",[t(e)],(function(e,n){null==o||o({err:e,result:n})}))},e.isSupported=n,function(e){function n(){var e=ue.hostVersionsInfo&&ue.hostVersionsInfo.adaptiveCardSchemaVersion&&!te(ue.hostVersionsInfo.adaptiveCardSchemaVersion);return Oe(ue)&&void 0!==(e&&ue.supports.dialog&&ue.supports.dialog.card&&ue.supports.dialog.card.bot)}e.open=function(e,t){if(Oe(ue,U.content,U.sidePanel,U.meetingStage),!n())throw B;pn("tasks.startTask",[o(e)],(function(e,n){null==t||t({err:e,result:n})}))},e.isSupported=n}(e.bot||(e.bot={}))}(e.adaptiveCard||(e.adaptiveCard={}))}(be||(be={})),function(e){!function(e){e[e.ifRoom=0]="ifRoom",e[e.overflowOnly=1]="overflowOnly"}(e.DisplayMode||(e.DisplayMode={}));var n,t,o,r=function(){return function(){this.enabled=!0,this.selected=!1}}();function i(e){o&&o(e)||(Oe(ue),pn("viewConfigItemPress",[e]))}function a(e){n&&n(e)||(Oe(ue),pn("handleNavBarMenuItemPress",[e]))}function s(e){t&&t(e)||(Oe(ue),pn("handleActionMenuItemPress",[e]))}function c(){return!(!Oe(ue)||!ue.supports.menus)}e.MenuItem=r,function(e){e.dropDown="dropDown",e.popOver="popOver"}(e.MenuListType||(e.MenuListType={})),e.initialize=function(){je("navBarMenuItemPress",a,!1),je("actionMenuItemPress",s,!1),je("setModuleView",i,!1)},e.setUpViews=function(e,n){if(Oe(ue),!c())throw B;o=n,pn("setUpViews",[e])},e.setNavBarMenu=function(e,t){if(Oe(ue),!c())throw B;n=t,pn("setNavBarMenu",[e])},e.showActionMenu=function(e,n){if(Oe(ue),!c())throw B;t=n,pn("showActionMenu",[e])},e.isSupported=c}(Se||(Se={})),function(e){function n(){if("undefined"==typeof window)throw new Error("window object undefined at print call");window.print()}function t(e,n){e&&Oe(ue),e&&n&&n(),Qe(e)}function o(e,n){e&&Oe(ue),e&&n&&n(),$e(e)}function r(){return!(!Oe(ue)||!ue.supports.teamsCore)}e.enablePrintCapability=function(){if(!v.printCapabilityEnabled){if(Oe(ue),!r())throw B;v.printCapabilityEnabled=!0,document.addEventListener("keydown",(function(e){(e.ctrlKey||e.metaKey)&&80===e.keyCode&&(n(),e.cancelBubble=!0,e.preventDefault(),e.stopImmediatePropagation())}))}},e.print=n,e.registerOnLoadHandler=function(e){t(e,(function(){if(e&&!r())throw B}))},e.registerOnLoadHandlerHelper=t,e.registerBeforeUnloadHandler=function(e){o(e,(function(){if(e&&!r())throw B}))},e.registerBeforeUnloadHandlerHelper=o,e.isSupported=r}(Te||(Te={})),function(n){var t=b("app");n.Messages={AppLoaded:"appInitialization.appLoaded",Success:"appInitialization.success",Failure:"appInitialization.failure",ExpectedFailure:"appInitialization.expectedFailure"},function(e){e.AuthFailed="AuthFailed",e.Timeout="Timeout",e.Other="Other"}(n.FailedReason||(n.FailedReason={})),function(e){e.PermissionError="PermissionError",e.NotFound="NotFound",e.Throttling="Throttling",e.Offline="Offline",e.Other="Other"}(n.ExpectedFailureReason||(n.ExpectedFailureReason={})),n.isInitialized=function(){return v.initializeCompleted},n.getFrameContext=function(){return v.frameContext};var o=5e3;n.initialize=function(e){return Ue()?(t.extend("initialize")("window object undefined at initialization"),Promise.resolve()):ee((function(){return i(e)}),o,new Error("SDK initialization timed out."))};var r=t.extend("initializeHelper");function i(n){return new Promise((function(t){v.initializeCalled||(v.initializeCalled=!0,_e(),v.initializePromise=rn(n).then((function(n){var t=n.context,o=n.clientType,i=n.runtimeConfig,a=n.clientSupportedSDKVersion,s=void 0===a?e:a;v.frameContext=t,v.hostClientType=o,v.clientSupportedSDKVersion=s;try{r("Parsing %s",i);var c=JSON.parse(i);if(r("Checking if %o is a valid runtime object",null!=c?c:"null"),!c||!c.apiVersion)throw new Error("Received runtime config is invalid");i&&ve(c)}catch(n){if(!(n instanceof SyntaxError))throw n;try{r("Attempting to parse %s as an SDK version",i),isNaN(Z(i,e))||(v.clientSupportedSDKVersion=i);c=JSON.parse(s);if(r("givenRuntimeConfig parsed to %o",null!=c?c:"null"),!c)throw new Error("givenRuntimeConfig string was successfully parsed. However, it parsed to value of null");ve(c)}catch(e){if(!(e instanceof SyntaxError))throw e;ve(we(v.clientSupportedSDKVersion))}}v.initializeCompleted=!0})),ye.initialize(),Se.initialize(),Ie.config.initialize(),be.initialize()),Array.isArray(n)&&Le(n),t(v.initializePromise)}))}function a(e){e&&Re(),Ze(e)}n._initialize=function(e){tn.currentWindow=e},n._uninitialize=function(){v.initializeCalled&&(v.frameContext&&(a(null),Ie.backStack.registerBackButtonHandler(null),Ie.registerFullScreenHandler(null),Te.registerBeforeUnloadHandler(null),Te.registerOnLoadHandler(null),In.registerGetLogHandler(null)),v.frameContext===U.settings&&Ie.config.registerOnSaveHandler(null),v.frameContext===U.remove&&Ie.config.registerOnRemoveHandler(null),v.initializeCalled=!1,v.initializeCompleted=!1,v.initializePromise=null,v.additionalValidOrigins=[],v.frameContext=null,v.hostClientType=null,v.isFramelessWindow=!1,an())},n.getContext=function(){return new Promise((function(e){Re(),e(sn("getContext"))})).then((function(e){return He(e)}))},n.notifyAppLoaded=function(){Re(),pn(n.Messages.AppLoaded,[Pe])},n.notifySuccess=function(){Re(),pn(n.Messages.Success,[Pe])},n.notifyFailure=function(e){Re(),pn(n.Messages.Failure,[e.reason,e.message])},n.notifyExpectedFailure=function(e){Re(),pn(n.Messages.ExpectedFailure,[e.reason,e.message])},n.registerOnThemeChangeHandler=a,n.openLink=function(e){return new Promise((function(n){Oe(ue,U.content,U.sidePanel,U.settings,U.task,U.stage,U.meetingStage),n(cn("executeDeepLink",e))}))}}(Ee||(Ee={})),function(e){function n(e){if(Oe(ue,U.content),!t())throw B;pn("setFrameContext",[e])}function t(){return!(!Oe(ue)||!ue.supports.pages)}e.returnFocus=function(e){if(Oe(ue),!t())throw B;pn("returnFocus",[e])},e.registerFocusEnterHandler=function(e){Ke("focusEnter",e,[],(function(){if(!t())throw B}))},e.setCurrentFrame=n,e.initializeWithFrameContext=function(e,t,o){Ee.initialize(o).then((function(){return t&&t()})),n(e)},e.getConfig=function(){return new Promise((function(e){if(Oe(ue,U.content,U.settings,U.remove,U.sidePanel),!t())throw B;e(sn("settings.getSettings"))}))},e.navigateCrossDomain=function(e){return new Promise((function(n){if(Oe(ue,U.content,U.sidePanel,U.settings,U.remove,U.task,U.stage,U.meetingStage),!t())throw B;n(ln("navigateCrossDomain","Cross-origin navigation is only supported for URLs matching the pattern registered in the manifest.",e))}))},e.navigateToApp=function(e){return new Promise((function(n){if(Oe(ue,U.content,U.sidePanel,U.settings,U.task,U.stage,U.meetingStage),!t())throw B;ue.isLegacyTeams?n(cn("executeDeepLink",ne(e))):n(cn("pages.navigateToApp",e))}))},e.shareDeepLink=function(e){if(Oe(ue,U.content,U.sidePanel,U.meetingStage),!t())throw B;pn("shareDeepLink",[e.subPageId,e.subPageLabel,e.subPageWebUrl])},e.registerFullScreenHandler=function(e){Ke("fullScreenChange",e,[],(function(){if(e&&!t())throw B}))},e.isSupported=t,function(e){function n(){return!(!Oe(ue)||!ue.supports.pages)&&!!ue.supports.pages.tabs}e.navigateToTab=function(e){return new Promise((function(t){if(Oe(ue),!n())throw B;t(ln("navigateToTab","Invalid internalTabInstanceId and/or channelId were/was provided",e))}))},e.getTabInstances=function(e){return new Promise((function(t){if(Oe(ue),!n())throw B;t(sn("getTabInstances",e))}))},e.getMruTabInstances=function(e){return new Promise((function(t){if(Oe(ue),!n())throw B;t(sn("getMruTabInstances",e))}))},e.isSupported=n}(e.tabs||(e.tabs={})),function(e){var n,t;function o(e,t){e&&Oe(ue,U.settings),t&&t(),n=e,e&&pn("registerHandler",["save"])}function r(e,n){e&&Oe(ue,U.remove,U.settings),n&&n(),t=e,e&&pn("registerHandler",["remove"])}function i(e){var t=new a(e);n?n(t):tn.childWindow?Nn("settings.save",[e]):t.notifySuccess()}e.initialize=function(){je("settings.save",i,!1),je("settings.remove",s,!1)},e.setValidityState=function(e){if(Oe(ue,U.settings,U.remove),!l())throw B;pn("settings.setValidityState",[e])},e.setConfig=function(e){return new Promise((function(n){if(Oe(ue,U.content,U.settings,U.sidePanel),!l())throw B;n(cn("settings.setSettings",e))}))},e.registerOnSaveHandler=function(e){o(e,(function(){if(e&&!l())throw B}))},e.registerOnSaveHandlerHelper=o,e.registerOnRemoveHandler=function(e){r(e,(function(){if(e&&!l())throw B}))},e.registerOnRemoveHandlerHelper=r,e.registerChangeConfigHandler=function(e){Ke("changeSettings",e,[U.content],(function(){if(!l())throw B}))};var a=function(){function e(e){this.notified=!1,this.result=e||{}}return e.prototype.notifySuccess=function(){this.ensureNotNotified(),pn("settings.save.success"),this.notified=!0},e.prototype.notifyFailure=function(e){this.ensureNotNotified(),pn("settings.save.failure",[e]),this.notified=!0},e.prototype.ensureNotNotified=function(){if(this.notified)throw new Error("The SaveEvent may only notify success or failure once.")},e}();function s(){var e=new c;t?t(e):tn.childWindow?Nn("settings.remove",[]):e.notifySuccess()}var c=function(){function e(){this.notified=!1}return e.prototype.notifySuccess=function(){this.ensureNotNotified(),pn("settings.remove.success"),this.notified=!0},e.prototype.notifyFailure=function(e){this.ensureNotNotified(),pn("settings.remove.failure",[e]),this.notified=!0},e.prototype.ensureNotNotified=function(){if(this.notified)throw new Error("The removeEventType may only notify success or failure once.")},e}();function l(){return!(!Oe(ue)||!ue.supports.pages)&&!!ue.supports.pages.config}e.isSupported=l}(e.config||(e.config={})),function(e){var n;function t(){return new Promise((function(e){if(Oe(ue),!i())throw B;e(ln("navigateBack","Back navigation is not supported in the current client or context."))}))}function o(e,t){e&&Oe(ue),t&&t(),n=e,e&&pn("registerHandler",["backButton"])}function r(){n&&n()||(tn.childWindow?Nn("backButtonPress",[]):t())}function i(){return!(!Oe(ue)||!ue.supports.pages)&&!!ue.supports.pages.backStack}e._initialize=function(){je("backButtonPress",r,!1)},e.navigateBack=t,e.registerBackButtonHandler=function(e){o(e,(function(){if(e&&!i())throw B}))},e.registerBackButtonHandlerHelper=o,e.isSupported=i}(e.backStack||(e.backStack={})),function(e){function n(){return!(!Oe(ue)||!ue.supports.pages)&&!!ue.supports.pages.fullTrust}e.enterFullscreen=function(){if(Oe(ue,U.content),!n())throw B;pn("enterFullscreen",[])},e.exitFullscreen=function(){if(Oe(ue,U.content),!n())throw B;pn("exitFullscreen",[])},e.isSupported=n}(e.fullTrust||(e.fullTrust={})),function(e){function n(){return!(!Oe(ue)||!ue.supports.pages)&&!!ue.supports.pages.appButton}e.onClick=function(e){Ke("appButtonClick",e,[U.content],(function(){if(!n())throw B}))},e.onHoverEnter=function(e){Ke("appButtonHoverEnter",e,[U.content],(function(){if(!n())throw B}))},e.onHoverLeave=function(e){Ke("appButtonHoverLeave",e,[U.content],(function(){if(!n())throw B}))},e.isSupported=n}(e.appButton||(e.appButton={})),function(e){function n(){return!(!Oe(ue)||!ue.supports.pages)&&!!ue.supports.pages.currentApp}e.navigateTo=function(e){return new Promise((function(t){if(Oe(ue,U.content,U.sidePanel,U.settings,U.task,U.stage,U.meetingStage),!n())throw B;t(un("pages.currentApp.navigateTo",e))}))},e.navigateToDefaultPage=function(){return new Promise((function(e){if(Oe(ue,U.content,U.sidePanel,U.settings,U.task,U.stage,U.meetingStage),!n())throw B;e(un("pages.currentApp.navigateToDefaultPage"))}))},e.isSupported=n}(e.currentApp||(e.currentApp={}))}(Ie||(Ie={}));var Ve=function(e,n,t){if(t||2===arguments.length)for(var o,r=0,i=n.length;r<i;r++)!o&&r in n||(o||(o=Array.prototype.slice.call(n,0,r)),o[r]=n[r]);return e.concat(o||Array.prototype.slice.call(n))},xe=b("handlers"),We=function(){function e(){}return e.handlers={},e}();function _e(){We.handlers.themeChange=Je,We.handlers.load=Xe,We.handlers.beforeUnload=Ye,Ie.backStack._initialize()}var Be=xe.extend("callHandler");function ze(e,n){var t=We.handlers[e];return t?(Be("Invoking the registered handler for message %s with arguments %o",e,n),[!0,t.apply(this,n)]):tn.childWindow?(Nn(e,n),[!1,void 0]):(Be("Handler for action message %s not found.",e),[!1,void 0])}function je(e,n,t,o){void 0===t&&(t=!0),void 0===o&&(o=[]),n?(We.handlers[e]=n,t&&pn("registerHandler",Ve([e],o,!0))):delete We.handlers[e]}function Ge(e){delete We.handlers[e]}function qe(e){return null!=We.handlers[e]}function Ke(e,n,t,o){n&&Oe.apply(void 0,Ve([ue],t,!1)),o&&o(),je(e,n)}function Ze(e){We.themeChangeHandler=e,e&&pn("registerHandler",["themeChange"])}function Je(e){We.themeChangeHandler&&We.themeChangeHandler(e),tn.childWindow&&Nn("themeChange",[e])}function Qe(e){We.loadHandler=e,e&&pn("registerHandler",["load"])}function Xe(e){We.loadHandler&&We.loadHandler(e),tn.childWindow&&Nn("load",[e])}function $e(e){We.beforeUnloadHandler=e,e&&pn("registerHandler",["beforeUnload"])}function Ye(){var e=function(){pn("readyToUnload",[])};We.beforeUnloadHandler&&We.beforeUnloadHandler(e)||(tn.childWindow?Nn("beforeUnload"):e())}var en=function(e,n,t){if(t||2===arguments.length)for(var o,r=0,i=n.length;r<i;r++)!o&&r in n||(o||(o=Array.prototype.slice.call(n,0,r)),o[r]=n[r]);return e.concat(o||Array.prototype.slice.call(n))},nn=b("communication"),tn=function(){return function(){}}(),on=function(){function e(){}return e.parentMessageQueue=[],e.childMessageQueue=[],e.nextMessageId=0,e.callbacks={},e.promiseCallbacks={},e}();function rn(e){if(on.messageListener=function(e){return hn(e)},tn.currentWindow=tn.currentWindow||window,tn.parentWindow=tn.currentWindow.parent!==tn.currentWindow.self?tn.currentWindow.parent:tn.currentWindow.opener,(tn.parentWindow||e)&&tn.currentWindow.addEventListener("message",on.messageListener,!1),!tn.parentWindow){var n=tn.currentWindow;if(!n.nativeInterface)return Promise.reject(new Error("Initialization Failed. No Parent window found."));v.isFramelessWindow=!0,n.onNativeMessage=yn}try{return tn.parentOrigin="*",dn("initialize",[Pe,ae]).then((function(e){return{context:e[0],clientType:e[1],runtimeConfig:e[2],clientSupportedSDKVersion:e[3]}}))}finally{tn.parentOrigin=null}}function an(){tn.currentWindow&&tn.currentWindow.removeEventListener("message",on.messageListener,!1),tn.currentWindow=null,tn.parentWindow=null,tn.parentOrigin=null,tn.childWindow=null,tn.childOrigin=null,on.parentMessageQueue=[],on.childMessageQueue=[],on.nextMessageId=0,on.callbacks={},on.promiseCallbacks={}}function sn(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];return dn(e,n).then((function(e){return e[0]}))}function cn(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];return dn(e,n).then((function(e){var n=e[0],t=e[1];if(!n)throw new Error(t)}))}function ln(e,n){for(var t=[],o=2;o<arguments.length;o++)t[o-2]=arguments[o];return dn(e,t).then((function(e){var t=e[0],o=e[1];if(!t)throw new Error(o||n)}))}function un(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];return dn(e,n).then((function(e){var n=e[0],t=e[1];if(n)throw n;return t}))}function dn(e,n){return void 0===n&&(n=void 0),new Promise((function(t){t(fn(mn(e,n).id))}))}function fn(e){return new Promise((function(n){on.promiseCallbacks[e]=n}))}function pn(e,n,t){var o;n instanceof Function?t=n:n instanceof Array&&(o=n);var r=mn(e,o);t&&(on.callbacks[r.id]=t)}var gn=nn.extend("sendMessageToParentHelper");function mn(e,n){var t=gn,o=tn.parentWindow,r=Ln(e,n);if(t("Message %i information: %o",r.id,{actionName:e,args:n}),v.isFramelessWindow)tn.currentWindow&&tn.currentWindow.nativeInterface&&(t("Sending message %i to parent via framelessPostMessage interface",r.id),tn.currentWindow.nativeInterface.framelessPostMessage(JSON.stringify(r)));else{var i=En(o);o&&i?(t("Sending message %i to parent via postMessage",r.id),o.postMessage(r,i)):(t("Adding message %i to parent message queue",r.id),Tn(o).push(r))}return r}function hn(e){if(e&&e.data&&"object"==typeof e.data){var n=e.source||e.originalEvent&&e.originalEvent.source,t=e.origin||e.originalEvent&&e.originalEvent.origin;wn(n,t)&&(Cn(n,t),n===tn.parentWindow?yn(e):n===tn.childWindow&&Sn(e))}}function wn(e,n){return(!tn.currentWindow||e!==tn.currentWindow)&&(!!(tn.currentWindow&&tn.currentWindow.location&&n&&n===tn.currentWindow.location.origin)||q(new URL(n)))}function Cn(e,n){v.isFramelessWindow||tn.parentWindow&&!tn.parentWindow.closed&&e!==tn.parentWindow?tn.childWindow&&!tn.childWindow.closed&&e!==tn.childWindow||(tn.childWindow=e,tn.childOrigin=n):(tn.parentWindow=e,tn.parentOrigin=n),tn.parentWindow&&tn.parentWindow.closed&&(tn.parentWindow=null,tn.parentOrigin=null),tn.childWindow&&tn.childWindow.closed&&(tn.childWindow=null,tn.childOrigin=null),On(tn.parentWindow),On(tn.childWindow)}var vn=nn.extend("handleParentMessage");function yn(e){var n=vn;if("id"in e.data&&"number"==typeof e.data.id){var t=e.data,o=on.callbacks[t.id];n("Received a response from parent for message %i",t.id),o&&(n("Invoking the registered callback for message %i with arguments %o",t.id,t.args),o.apply(null,en(en([],t.args,!0),[t.isPartialResponse],!1)),bn(e)||(n("Removing registered callback for message %i",t.id),delete on.callbacks[t.id]));var r=on.promiseCallbacks[t.id];r&&(n("Invoking the registered promise callback for message %i with arguments %o",t.id,t.args),r(t.args),n("Removing registered promise callback for message %i",t.id),delete on.promiseCallbacks[t.id])}else if("func"in e.data&&"string"==typeof e.data.func){n("Received an action message %s from parent",(t=e.data).func),ze(t.func,t.args)}else n("Received an unknown message: %O",e)}function bn(e){return!0===e.data.isPartialResponse}function Sn(e){if("id"in e.data&&"func"in e.data){var n=e.data,t=ze(n.func,n.args),o=t[0],r=t[1];o&&void 0!==r?Dn(n.id,Array.isArray(r)?r:[r]):pn(n.func,n.args,(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(tn.childWindow){var o=e.pop();Dn(n.id,e,o)}}))}}function Tn(e){return e===tn.parentWindow?on.parentMessageQueue:e===tn.childWindow?on.childMessageQueue:[]}function En(e){return e===tn.parentWindow?tn.parentOrigin:e===tn.childWindow?tn.childOrigin:null}var In,Pn,Fn,kn,An,Rn=nn.extend("flushMessageQueue");function On(e){for(var n=En(e),t=Tn(e),o=e==tn.parentWindow?"parent":"child";e&&n&&t.length>0;){var r=t.shift();Rn("Flushing message %i from "+o+" message queue via postMessage.",r.id),e.postMessage(r,n)}}function Mn(e,n){var t=tn.currentWindow.setInterval((function(){0===Tn(e).length&&(clearInterval(t),n())}),100)}function Dn(e,n,t){var o=tn.childWindow,r=Un(e,n,t),i=En(o);o&&i&&o.postMessage(r,i)}function Nn(e,n){var t=tn.childWindow,o=Hn(e,n),r=En(t);t&&r?t.postMessage(o,r):Tn(t).push(o)}function Ln(e,n){return{id:on.nextMessageId++,func:e,timestamp:Date.now(),args:n||[]}}function Un(e,n,t){return{id:e,args:n||[],isPartialResponse:t}}function Hn(e,n){return{func:e,args:n||[]}}function Vn(e,n){Oe(ue),pn("uploadCustomApp",[e],n||K())}function xn(e,n,t){Oe(ue),pn(e,n,t)}function Wn(e,n){if(Oe(ue),!tn.childWindow)throw new Error("The child window has not yet been initialized or is not present");Nn(e,n)}function _n(e,n){var t=this;Oe(ue),je(e,(function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return n.apply(t,e)}))}function Bn(e,n){Oe(ue),je("userSettingsChange",n,!0,[e])}function zn(e){Oe(ue,U.content,U.task),pn("openFilePreview",[e.entityId,e.title,e.description,e.type,e.objectUrl,e.downloadUrl,e.webPreviewUrl,e.webEditUrl,e.baseUrl,e.editFile,e.subEntityId,e.viewerAction,e.fileOpenPreference,e.conversationId])}!function(e){function n(){return!(!Oe(ue)||!ue.supports.logs)}e.registerGetLogHandler=function(e){if(e&&Oe(ue),e&&!n())throw B;e?je("log.request",(function(){pn("log.receive",[e()])})):Ge("log.request")},e.isSupported=n}(In||(In={})),function(e){e.fileDownloadStart="fileDownloadStart",e.fileDownloadComplete="fileDownloadComplete"}(Pn||(Pn={})),function(e){e.view="view",e.edit="edit",e.editNew="editNew"}(Fn||(Fn={})),function(e){e.fileOpenPreference="fileOpenPreference",e.theme="theme"}(kn||(kn={})),function(e){function n(){return!(!Oe(ue)||!ue.supports.conversations)}e.openConversation=function(e){return new Promise((function(t){if(Oe(ue,U.content),!n())throw B;var o=cn("conversations.openConversation",{title:e.title,subEntityId:e.subEntityId,conversationId:e.conversationId,channelId:e.channelId,entityId:e.entityId});e.onStartConversation&&je("startConversation",(function(n,t,o,r){return e.onStartConversation({subEntityId:n,conversationId:t,channelId:o,entityId:r})})),e.onCloseConversation&&je("closeConversation",(function(n,t,o,r){return e.onCloseConversation({subEntityId:n,conversationId:t,channelId:o,entityId:r})})),t(o)}))},e.closeConversation=function(){if(Oe(ue,U.content),!n())throw B;pn("conversations.closeConversation"),Ge("startConversation"),Ge("closeConversation")},e.getChatMembers=function(){return new Promise((function(e){if(Oe(ue),!n())throw B;e(sn("getChatMembers"))}))},e.isSupported=n}(An||(An={}));var jn,Gn="/l/app/",qn="/l/meeting/new",Kn="attendees",Zn="startTime",Jn="endTime",Qn="subject",Xn="content",$n="/l/call/0/0",Yn="source",et="withVideo",nt="/l/chat/0/0",tt="users",ot="topicName",rt="message";function it(e,n,t){if(0===e.length)throw new Error("Must have at least one user when creating a chat deep link");var o="".concat(tt,"=")+e.map((function(e){return encodeURIComponent(e)})).join(","),r=void 0===n?"":"&".concat(ot,"=").concat(encodeURIComponent(n)),i=void 0===t?"":"&".concat(rt,"=").concat(encodeURIComponent(t));return"".concat(g,"://").concat(m).concat(nt,"?").concat(o).concat(r).concat(i)}function at(e,n,t){if(0===e.length)throw new Error("Must have at least one target when creating a call deep link");var o="".concat(tt,"=")+e.map((function(e){return encodeURIComponent(e)})).join(","),r=void 0===n?"":"&".concat(et,"=").concat(encodeURIComponent(n)),i=void 0===t?"":"&".concat(Yn,"=").concat(encodeURIComponent(t));return"".concat(g,"://").concat(m).concat($n,"?").concat(o).concat(r).concat(i)}function st(e,n,t,o,r){var i=void 0===e?"":"".concat(Kn,"=")+e.map((function(e){return encodeURIComponent(e)})).join(","),a=void 0===n?"":"&".concat(Zn,"=").concat(encodeURIComponent(n)),s=void 0===t?"":"&".concat(Jn,"=").concat(encodeURIComponent(t)),c=void 0===o?"":"&".concat(Qn,"=").concat(encodeURIComponent(o)),l=void 0===r?"":"&".concat(Xn,"=").concat(encodeURIComponent(r));return"".concat(g,"://").concat(m).concat(qn,"?").concat(i).concat(a).concat(s).concat(c).concat(l)}function ct(e){if(!e)throw new Error("App ID must be set when creating an app install dialog deep link");return"".concat(g,"://").concat(m).concat(Gn).concat(encodeURIComponent(e))}!function(e){function n(){return!(!Oe(ue)||!ue.supports.appInstallDialog)}e.openAppInstallDialog=function(e){return new Promise((function(t){if(Oe(ue,U.content,U.sidePanel,U.settings,U.task,U.stage,U.meetingStage),!n())throw new Error("Not supported");ue.isLegacyTeams?t(cn("executeDeepLink",ct(e.appId))):(pn("appInstallDialog.openAppInstallDialog",[e]),t())}))},e.isSupported=n}(jn||(jn={}));var lt,ut,dt,ft,pt=function(){var e=function(n,t){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])},e(n,t)};return function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();function gt(e,n){if(null==e||null==n||e.length<=0)return null;var t,o=1;return e.sort((function(e,n){return e.sequence>n.sequence?1:-1})),e.forEach((function(e){e.sequence==o&&(t=t?new Blob([t,e.file],{type:n}):new Blob([e.file],{type:n}),o++)})),t}function mt(e,n){if(null==e||null==n)return null;for(var t=atob(e.chunk),o=new Array(t.length),r=0;r<t.length;r++)o[r]=t.charCodeAt(r);var i=new Uint8Array(o),a=new Blob([i],{type:n});return{sequence:e.chunkSequence,file:a}}function ht(e){yt(e)?Ne(n):bt(e)?Ne(r):vt(e)&&Ne(i)}function wt(e){return!(e.mediaType!=lt.MediaType.Video||!e.videoProps||!e.videoProps.videoController)}function Ct(e){return!(null==e||e.maxMediaCount>10)}function vt(e){var n;return!((null==e?void 0:e.mediaType)!=lt.MediaType.Image||!(null===(n=null==e?void 0:e.imageProps)||void 0===n?void 0:n.imageOutputFormats))}function yt(e){return!(!e||e.mediaType!=lt.MediaType.VideoAndImage&&!e.videoAndImageProps)}function bt(e){return!(!e||e.mediaType!=lt.MediaType.Video||!e.videoProps||e.videoProps.isFullScreenMode)}function St(e,n,t){return null!=e&&null!=n&&n==lt.FileFormat.ID&&null!=t}function Tt(e){return!(null==e||e.length<=0||e.length>10)}function Et(e){return!e||!(null===e.timeOutIntervalInSec||e.timeOutIntervalInSec<=0||e.timeOutIntervalInSec>60)}function It(e){if(e){if(e.title&&"string"!=typeof e.title)return!1;if(e.setSelected&&"object"!=typeof e.setSelected)return!1;if(e.openOrgWideSearchInChatOrChannel&&"boolean"!=typeof e.openOrgWideSearchInChatOrChannel)return!1;if(e.singleSelect&&"boolean"!=typeof e.singleSelect)return!1}return!0}function Pt(){return ue.hostVersionsInfo?ue.hostVersionsInfo.adaptiveCardSchemaVersion:void 0}!function(e){!function(e){e.Base64="base64",e.ID="id"}(e.FileFormat||(e.FileFormat={}));var n=function(){return function(){}}();e.File=n,e.captureImage=function(e){if(!e)throw new Error("[captureImage] Callback cannot be null");Oe(ue,U.content,U.task),v.isFramelessWindow?Me(l)?pn("captureImage",e):e({errorCode:M.OLD_PLATFORM},void 0):e({errorCode:M.NOT_SUPPORTED_ON_PLATFORM},void 0)};var t=function(e){function n(n){void 0===n&&(n=null);var t=e.call(this)||this;return n&&(t.content=n.content,t.format=n.format,t.mimeType=n.mimeType,t.name=n.name,t.preview=n.preview,t.size=n.size),t}return pt(n,e),n.prototype.getMedia=function(e){if(!e)throw new Error("[get Media] Callback cannot be null");(Oe(ue,U.content,U.task),Me(u))?St(this.mimeType,this.format,this.content)?Me("2.0.0")?this.getMediaViaCallback(e):this.getMediaViaHandler(e):e({errorCode:M.INVALID_ARGUMENTS},null):e({errorCode:M.OLD_PLATFORM},null)},n.prototype.getMediaViaCallback=function(e){var n={mediaMimeType:this.mimeType,assembleAttachment:[]};pn("getMedia",[this.content],(function(t){if(e)if(t&&t.error)e(t.error,null);else if(t&&t.mediaChunk)if(t.mediaChunk.chunkSequence<=0){var o=gt(n.assembleAttachment,n.mediaMimeType);e(t.error,o)}else{var r=mt(t.mediaChunk,n.mediaMimeType);n.assembleAttachment.push(r)}else e({errorCode:M.INTERNAL_ERROR,message:"data received is null"},null)}))},n.prototype.getMediaViaHandler=function(e){var n=J(),t={mediaMimeType:this.mimeType,assembleAttachment:[]},o=[n,this.content];this.content&&e&&pn("getMedia",o),je("getMedia"+n,(function(o){if(e){var r=JSON.parse(o);if(r.error)e(r.error,null),Ge("getMedia"+n);else if(r.mediaChunk)if(r.mediaChunk.chunkSequence<=0){var i=gt(t.assembleAttachment,t.mediaMimeType);e(r.error,i),Ge("getMedia"+n)}else{var a=mt(r.mediaChunk,t.mediaMimeType);t.assembleAttachment.push(a)}else e({errorCode:M.INTERNAL_ERROR,message:"data received is null"},null),Ge("getMedia"+n)}}))},n}(n);e.Media=t;var o,i,a=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return pt(n,e),n.prototype.getMediaType=function(){return i.Video},n.prototype.notifyEventToApp=function(e){if(this.controllerCallback)switch(e){case o.StartRecording:if(this.controllerCallback.onRecordingStarted){this.controllerCallback.onRecordingStarted();break}}},n}(function(){function e(e){this.controllerCallback=e}return e.prototype.notifyEventToHost=function(e,n){Oe(ue,U.content,U.task);try{Ne(r)}catch(e){return void(n&&n(e))}pn("media.controller",[{mediaType:this.getMediaType(),mediaControllerEvent:e}],(function(e){n&&n(e)}))},e.prototype.stop=function(e){this.notifyEventToHost(o.StopRecording,e)},e}());e.VideoController=a,function(e){e[e.StartRecording=1]="StartRecording",e[e.StopRecording=2]="StopRecording"}(o=e.MediaControllerEvent||(e.MediaControllerEvent={})),function(e){e[e.Photo=1]="Photo",e[e.Document=2]="Document",e[e.Whiteboard=3]="Whiteboard",e[e.BusinessCard=4]="BusinessCard"}(e.CameraStartMode||(e.CameraStartMode={})),function(e){e[e.Camera=1]="Camera",e[e.Gallery=2]="Gallery"}(e.Source||(e.Source={})),function(e){e[e.Image=1]="Image",e[e.Video=2]="Video",e[e.VideoAndImage=3]="VideoAndImage",e[e.Audio=4]="Audio"}(i=e.MediaType||(e.MediaType={})),function(e){e[e.ID=1]="ID",e[e.URL=2]="URL"}(e.ImageUriType||(e.ImageUriType={})),function(e){e[e.IMAGE=1]="IMAGE",e[e.PDF=2]="PDF"}(e.ImageOutputFormats||(e.ImageOutputFormats={})),e.selectMedia=function(e,n){if(!n)throw new Error("[select Media] Callback cannot be null");if(Oe(ue,U.content,U.task),Me(u)){try{ht(e)}catch(e){return void n(e,null)}if(Ct(e)){pn("selectMedia",[e],(function(o,r,i){if(i)wt(e)&&e.videoProps.videoController.notifyEventToApp(i);else if(r){for(var a=[],s=0,c=r;s<c.length;s++){var l=c[s];a.push(new t(l))}n(o,a)}else n(o,null)}))}else{var o={errorCode:M.INVALID_ARGUMENTS};n(o,null)}}else{var r={errorCode:M.OLD_PLATFORM};n(r,null)}},e.viewImages=function(e,n){if(!n)throw new Error("[view images] Callback cannot be null");Oe(ue,U.content,U.task),Me(u)?Tt(e)?pn("viewImages",[e],n):n({errorCode:M.INVALID_ARGUMENTS}):n({errorCode:M.OLD_PLATFORM})},e.scanBarCode=function(e,n){if(!e)throw new Error("[media.scanBarCode] Callback cannot be null");Oe(ue,U.content,U.task),v.hostClientType!==N.desktop&&v.hostClientType!==N.web&&v.hostClientType!==N.rigel&&v.hostClientType!==N.teamsRoomsWindows&&v.hostClientType!==N.teamsRoomsAndroid&&v.hostClientType!==N.teamsPhones&&v.hostClientType!==N.teamsDisplays?Me(d)?Et(n)?pn("media.scanBarCode",[n],e):e({errorCode:M.INVALID_ARGUMENTS},null):e({errorCode:M.OLD_PLATFORM},null):e({errorCode:M.NOT_SUPPORTED_ON_PLATFORM},null)}}(lt||(lt={})),function(e){function n(){return!!(Oe(ue)&&ue.supports.barCode&&ue.supports.permissions)}e.scanBarCode=function(e){return new Promise((function(t){if(Oe(ue,U.content,U.task),!n())throw B;if(!Et(e))throw{errorCode:M.INVALID_ARGUMENTS};t(un("media.scanBarCode",e))}))},e.hasPermission=function(){if(Oe(ue,U.content,U.task),!n())throw B;var e=D.Media;return new Promise((function(n){n(un("permissions.has",e))}))},e.requestPermission=function(){if(Oe(ue,U.content,U.task),!n())throw B;var e=D.Media;return new Promise((function(n){n(un("permissions.request",e))}))},e.isSupported=n}(ut||(ut={})),function(e){function n(e){return new Promise((function(n){if(Oe(ue,U.content,U.task),!t())throw B;ue.isLegacyTeams?n(cn("executeDeepLink",it([e.user],void 0,e.message))):n(cn("chat.openChat",{members:e.user,message:e.message}))}))}function t(){return!(!Oe(ue)||!ue.supports.chat)}e.openChat=n,e.openGroupChat=function(e){return new Promise((function(o){if(e.users.length<1)throw Error("OpenGroupChat Failed: No users specified");if(1===e.users.length){n({user:e.users[0],message:e.message})}else{if(Oe(ue,U.content,U.task),!t())throw B;if(ue.isLegacyTeams)o(cn("executeDeepLink",it(e.users,e.topic,e.message)));else o(cn("chat.openChat",{members:e.users,message:e.message,topic:e.topic}))}}))},e.isSupported=t}(dt||(dt={})),function(e){function n(){return!!(Oe(ue)&&ue.supports.geoLocation&&ue.supports.permissions)}e.getCurrentLocation=function(){if(Oe(ue,U.content,U.task),!n())throw B;return un("location.getLocation",{allowChooseLocation:!1,showMap:!1})},e.hasPermission=function(){if(Oe(ue,U.content,U.task),!n())throw B;var e=D.GeoLocation;return new Promise((function(n){n(un("permissions.has",e))}))},e.requestPermission=function(){if(Oe(ue,U.content,U.task),!n())throw B;var e=D.GeoLocation;return new Promise((function(n){n(un("permissions.request",e))}))},e.isSupported=n,function(e){function n(){return!!(Oe(ue)&&ue.supports.geoLocation&&ue.supports.geoLocation.map&&ue.supports.permissions)}e.chooseLocation=function(){if(Oe(ue,U.content,U.task),!n())throw B;return un("location.getLocation",{allowChooseLocation:!0,showMap:!0})},e.showLocation=function(e){if(Oe(ue,U.content,U.task),!n())throw B;if(!e)throw{errorCode:M.INVALID_ARGUMENTS};return un("location.showLocation",e)},e.isSupported=n}(e.map||(e.map={}))}(ft||(ft={}));var Ft,kt,At=function(){function e(){}return e.prototype.postMessage=function(e,n){Oe(ue),pn("messageForChild",[e],n||K())},e.prototype.addEventListener=function(e,n){Oe(ue),"message"===e&&je("messageForParent",n)},e}(),Rt=function(){function e(){}return Object.defineProperty(e,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!1,configurable:!0}),e.prototype.postMessage=function(e,n){Oe(ue,U.task),pn("messageForParent",[e],n||K())},e.prototype.addEventListener=function(e,n){Oe(ue,U.task),"message"===e&&je("messageForChild",n)},e}();!function(e){function n(){return!(!Oe(ue)||!ue.supports.secondaryBrowser)}e.open=function(e){if(Oe(ue,U.content),!n())throw B;if(!e||!oe(e))throw{errorCode:M.INVALID_ARGUMENTS,message:"Invalid Url: Only https URL is allowed"};return un("secondaryBrowser.open",e.toString())},e.isSupported=n}(Ft||(Ft={})),function(e){function n(){return!(!Oe(ue)||!ue.supports.location)}e.getLocation=function(e,t){if(!t)throw new Error("[location.getLocation] Callback cannot be null");if(Oe(ue,U.content,U.task),!Me(s))throw{errorCode:M.OLD_PLATFORM};if(!e)throw{errorCode:M.INVALID_ARGUMENTS};if(!n())throw B;pn("location.getLocation",[e],t)},e.showLocation=function(e,t){if(!t)throw new Error("[location.showLocation] Callback cannot be null");if(Oe(ue,U.content,U.task),!Me(s))throw{errorCode:M.OLD_PLATFORM};if(!e)throw{errorCode:M.INVALID_ARGUMENTS};if(!n())throw B;pn("location.showLocation",[e],t)},e.isSupported=n}(kt||(kt={}));var Ot,Mt,Dt,Nt,Lt,Ut,Ht=function(e,n,t,o){function r(e){return e instanceof t?e:new t((function(n){n(e)}))}return new(t||(t=Promise))((function(t,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){e.done?t(e.value):r(e.value).then(a,s)}c((o=o.apply(e,n||[])).next())}))},Vt=function(e,n){var t,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(e){return function(n){return c([e,n])}}function c(s){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(t=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=n.call(e,a)}catch(e){s=[6,e],o=0}finally{t=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};function xt(e){return e?e.modality&&"string"!=typeof e.modality?[!1,"modality must be a string"]:e.targetElementBoundingRect&&"object"==typeof e.targetElementBoundingRect?e.triggerType&&"string"==typeof e.triggerType?Wt(e.persona):[!1,"triggerType must be a valid string"]:[!1,"targetElementBoundingRect must be a DOMRect"]:[!1,"A request object is required"]}function Wt(e){return e?e.displayName&&"string"!=typeof e.displayName?[!1,"displayName must be a string"]:e.identifiers&&"object"==typeof e.identifiers?e.identifiers.AadObjectId||e.identifiers.Smtp||e.identifiers.Upn?e.identifiers.AadObjectId&&"string"!=typeof e.identifiers.AadObjectId?[!1,"AadObjectId identifier must be a string"]:e.identifiers.Smtp&&"string"!=typeof e.identifiers.Smtp?[!1,"Smtp identifier must be a string"]:e.identifiers.Upn&&"string"!=typeof e.identifiers.Upn?[!1,"Upn identifier must be a string"]:[!0,void 0]:[!1,"at least one valid identifier must be provided"]:[!1,"persona identifiers object must be provided"]:[!1,"persona object must be provided"]}!function(e){var n;function t(e,t){var o=this;pn("meeting.requestAppAudioHandling",[e.isAppHandlingAudio],(function(i,a){if(i&&null!=a)throw new Error("[requestAppAudioHandling] Callback response - both parameters cannot be set");if(i)throw new Error("[requestAppAudioHandling] Callback response - SDK error ".concat(i.errorCode," ").concat(i.message));if("boolean"!=typeof a)throw new Error("[requestAppAudioHandling] Callback response - isHostAudioless must be a boolean");je("meeting.micStateChanged",(function(t){return Ht(o,void 0,void 0,(function(){var o,i;return Vt(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,e.micMuteStateChangedCallback(t)];case 1:return o=a.sent(),i=o.isMicMuted===t.isMicMuted,r(o,i?n.HostInitiated:n.AppDeclinedToChange),[3,3];case 2:return a.sent(),r(t,n.AppFailedToChange),[3,3];case 3:return[2]}}))}))})),t(a)}))}function o(e,n){pn("meeting.requestAppAudioHandling",[e.isAppHandlingAudio],(function(e,t){if(e&&null!=t)throw new Error("[requestAppAudioHandling] Callback response - both parameters cannot be set");if(e)throw new Error("[requestAppAudioHandling] Callback response - SDK error ".concat(e.errorCode," ").concat(e.message));if("boolean"!=typeof t)throw new Error("[requestAppAudioHandling] Callback response - isHostAudioless must be a boolean");qe("meeting.micStateChanged")&&Ge("meeting.micStateChanged"),n(t)}))}function r(e,n){Oe(ue,U.sidePanel,U.meetingStage),pn("meeting.updateMicState",[e,n])}!function(e){e[e.HostInitiated=0]="HostInitiated",e[e.AppInitiated=1]="AppInitiated",e[e.AppDeclinedToChange=2]="AppDeclinedToChange",e[e.AppFailedToChange=3]="AppFailedToChange"}(n||(n={})),function(e){e.like="like",e.heart="heart",e.laugh="laugh",e.surprised="surprised",e.applause="applause"}(e.MeetingReactionType||(e.MeetingReactionType={})),function(e){e.Unknown="Unknown",e.Adhoc="Adhoc",e.Scheduled="Scheduled",e.Recurring="Recurring",e.Broadcast="Broadcast",e.MeetNow="MeetNow"}(e.MeetingType||(e.MeetingType={})),function(e){e.OneOnOneCall="oneOnOneCall",e.GroupCall="groupCall"}(e.CallType||(e.CallType={})),e.getIncomingClientAudioState=function(e){if(!e)throw new Error("[get incoming client audio state] Callback cannot be null");Oe(ue,U.sidePanel,U.meetingStage),pn("getIncomingClientAudioState",e)},e.toggleIncomingClientAudio=function(e){if(!e)throw new Error("[toggle incoming client audio] Callback cannot be null");Oe(ue,U.sidePanel,U.meetingStage),pn("toggleIncomingClientAudio",e)},e.getMeetingDetails=function(e){if(!e)throw new Error("[get meeting details] Callback cannot be null");Oe(ue,U.sidePanel,U.meetingStage,U.settings,U.content),pn("meeting.getMeetingDetails",e)},e.getAuthenticationTokenForAnonymousUser=function(e){if(!e)throw new Error("[get Authentication Token For AnonymousUser] Callback cannot be null");Oe(ue,U.sidePanel,U.meetingStage,U.task),pn("meeting.getAuthenticationTokenForAnonymousUser",e)},e.getLiveStreamState=function(e){if(!e)throw new Error("[get live stream state] Callback cannot be null");Oe(ue,U.sidePanel),pn("meeting.getLiveStreamState",e)},e.requestStartLiveStreaming=function(e,n,t){if(!e)throw new Error("[request start live streaming] Callback cannot be null");Oe(ue,U.sidePanel),pn("meeting.requestStartLiveStreaming",[n,t],e)},e.requestStopLiveStreaming=function(e){if(!e)throw new Error("[request stop live streaming] Callback cannot be null");Oe(ue,U.sidePanel),pn("meeting.requestStopLiveStreaming",e)},e.registerLiveStreamChangedHandler=function(e){if(!e)throw new Error("[register live stream changed handler] Handler cannot be null");Oe(ue,U.sidePanel),je("meeting.liveStreamChanged",e)},e.shareAppContentToStage=function(e,n){if(!e)throw new Error("[share app content to stage] Callback cannot be null");Oe(ue,U.sidePanel,U.meetingStage),pn("meeting.shareAppContentToStage",[n],e)},e.getAppContentStageSharingCapabilities=function(e){if(!e)throw new Error("[get app content stage sharing capabilities] Callback cannot be null");Oe(ue,U.sidePanel,U.meetingStage),pn("meeting.getAppContentStageSharingCapabilities",e)},e.stopSharingAppContentToStage=function(e){if(!e)throw new Error("[stop sharing app content to stage] Callback cannot be null");Oe(ue,U.sidePanel,U.meetingStage),pn("meeting.stopSharingAppContentToStage",e)},e.getAppContentStageSharingState=function(e){if(!e)throw new Error("[get app content stage sharing state] Callback cannot be null");Oe(ue,U.sidePanel,U.meetingStage),pn("meeting.getAppContentStageSharingState",e)},e.registerSpeakingStateChangeHandler=function(e){if(!e)throw new Error("[registerSpeakingStateChangeHandler] Handler cannot be null");Oe(ue,U.sidePanel,U.meetingStage),je("meeting.speakingStateChanged",e)},e.registerRaiseHandStateChangedHandler=function(e){if(!e)throw new Error("[registerRaiseHandStateChangedHandler] Handler cannot be null");Oe(ue,U.sidePanel,U.meetingStage),je("meeting.raiseHandStateChanged",e)},e.registerMeetingReactionReceivedHandler=function(e){if(!e)throw new Error("[registerMeetingReactionReceivedHandler] Handler cannot be null");Oe(ue,U.sidePanel,U.meetingStage),je("meeting.meetingReactionReceived",e)},function(e){e.setOptions=function(e){Oe(ue,U.sidePanel),e.contentUrl&&new URL(e.contentUrl),pn("meeting.appShareButton.setOptions",[e])}}(e.appShareButton||(e.appShareButton={})),e.requestAppAudioHandling=function(e,n){if(!n)throw new Error("[requestAppAudioHandling] Callback response cannot be null");if(!e.micMuteStateChangedCallback)throw new Error("[requestAppAudioHandling] Callback Mic mute state handler cannot be null");Oe(ue,U.sidePanel,U.meetingStage),e.isAppHandlingAudio?t(e,n):o(e,n)},e.updateMicState=function(e){r(e,n.AppInitiated)}}(Ot||(Ot={})),function(e){function n(){return!(!Oe(ue)||!ue.supports.monetization)}e.openPurchaseExperience=function(e,t){var o,r;return"function"==typeof e?(o=e,r=t):r=e,Oe(ue,U.content),Y((function(){return new Promise((function(e){if(!n())throw B;e(un("monetization.openPurchaseExperience",r))}))}),o)},e.isSupported=n}(Mt||(Mt={})),function(e){function n(){return!(!Oe(ue)||!ue.supports.calendar)}e.openCalendarItem=function(e){return new Promise((function(t){if(Oe(ue,U.content),!n())throw new Error("Not supported");if(!e.itemId||!e.itemId.trim())throw new Error("Must supply an itemId to openCalendarItem");t(cn("calendar.openCalendarItem",e))}))},e.composeMeeting=function(e){return new Promise((function(t){if(Oe(ue,U.content),!n())throw new Error("Not supported");ue.isLegacyTeams?t(cn("executeDeepLink",st(e.attendees,e.startTime,e.endTime,e.subject,e.content))):t(cn("calendar.composeMeeting",e))}))},e.isSupported=n}(Dt||(Dt={})),function(e){function n(){return!(!Oe(ue)||!ue.supports.mail)}e.openMailItem=function(e){return new Promise((function(t){if(Oe(ue,U.content),!n())throw new Error("Not supported");if(!e.itemId||!e.itemId.trim())throw new Error("Must supply an itemId to openMailItem");t(cn("mail.openMailItem",e))}))},e.composeMail=function(e){return new Promise((function(t){if(Oe(ue,U.content),!n())throw new Error("Not supported");t(cn("mail.composeMail",e))}))},e.isSupported=n,function(e){e.New="new",e.Reply="reply",e.ReplyAll="replyAll",e.Forward="forward"}(e.ComposeMailType||(e.ComposeMailType={}))}(Nt||(Nt={})),function(e){function n(e){return new Promise((function(n){if(!Me(c))throw{errorCode:M.OLD_PLATFORM};if(!It(e))throw{errorCode:M.INVALID_ARGUMENTS};if(!t())throw B;n(un("people.selectPeople",e))}))}function t(){return!(!Oe(ue)||!ue.supports.people)}e.selectPeople=function(e,t){var o,r,i;return Oe(ue,U.content,U.task,U.settings),"function"==typeof e?(r=(o=[e,t])[0],i=o[1]):i=e,X(n,r,i)},e.isSupported=t}(Lt||(Lt={})),function(e){e.showProfile=function(e){return Oe(ue,U.content),new Promise((function(n){var t=xt(e),o=t[0],r=t[1];if(!o)throw{errorCode:M.INVALID_ARGUMENTS,message:r};n(un("profile.showProfile",{modality:e.modality,persona:e.persona,triggerType:e.triggerType,targetRectangle:{x:e.targetElementBoundingRect.x,y:e.targetElementBoundingRect.y,width:e.targetElementBoundingRect.width,height:e.targetElementBoundingRect.height}}))}))},e.isSupported=function(){return!(!Oe(ue)||!ue.supports.profile)}}(Ut||(Ut={}));var _t=function(e,n,t,o){function r(e){return e instanceof t?e:new t((function(n){n(e)}))}return new(t||(t=Promise))((function(t,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){e.done?t(e.value):r(e.value).then(a,s)}c((o=o.apply(e,n||[])).next())}))},Bt=function(e,n){var t,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(e){return function(n){return c([e,n])}}function c(s){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(t=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=n.call(e,a)}catch(e){s=[6,e],o=0}finally{t=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};function zt(e,n,t){return _t(this,void 0,void 0,(function(){var o;return Bt(this,(function(r){switch(r.label){case 0:return o=Gt,[4,jt(e,t)];case 1:return[2,o.apply(void 0,[r.sent(),n,t])]}}))}))}function jt(e,n){return _t(this,void 0,void 0,(function(){var t,o,r,i,a;return Bt(this,(function(s){switch(s.label){case 0:if(Ue())throw B;t=window.chrome,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,t.webview.getTextureStream(e)];case 2:if(o=s.sent(),0===(r=o.getVideoTracks()).length)throw new Error("No video track in stream ".concat(e));return[2,r[0]];case 3:throw i=s.sent(),a="Failed to get video track from stream ".concat(e,", error: ").concat(i),n(a),new Error("Internal error: can't get video track from stream ".concat(e));case 4:return[2]}}))}))}function Gt(e,n,t){if(Ue())throw B;var o=new(0,window.MediaStreamTrackProcessor)({track:e}).readable,r=new(0,window.MediaStreamTrackGenerator)({kind:"video"}),i=r.writable;return o.pipeThrough(new TransformStream({transform:function(e,o){return _t(this,void 0,void 0,(function(){var r,i,a,s;return Bt(this,(function(c){switch(c.label){case 0:if(null===(r=e.timestamp))return[3,5];c.label=1;case 1:return c.trys.push([1,3,,4]),[4,n({videoFrame:e})];case 2:return i=c.sent(),a=new VideoFrame(i,{timestamp:r}),o.enqueue(a),e.close(),i.close(),[3,4];case 3:return s=c.sent(),e.close(),t(s),[3,4];case 4:return[3,6];case 5:t("timestamp of the original video frame is null"),c.label=6;case 6:return[2]}}))}))}})).pipeTo(i),r}function qt(e){return function(n,t){e(n,t).then((function(){pn("video.videoEffectReadiness",[!0,n])})).catch((function(e){var t=e in Kt.EffectFailureReason?e:Kt.EffectFailureReason.InitializationFailure;pn("video.videoEffectReadiness",[!1,n,t])}))}}var Kt,Zt,Jt,Qt,Xt,$t,Yt,eo,no=function(){return no=Object.assign||function(e){for(var n,t=1,o=arguments.length;t<o;t++)for(var r in n=arguments[t])Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e},no.apply(this,arguments)},to=function(e,n,t,o){function r(e){return e instanceof t?e:new t((function(n){n(e)}))}return new(t||(t=Promise))((function(t,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){e.done?t(e.value):r(e.value).then(a,s)}c((o=o.apply(e,n||[])).next())}))},oo=function(e,n){var t,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(e){return function(n){return c([e,n])}}function c(s){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(t=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=n.call(e,a)}catch(e){s=[6,e],o=0}finally{t=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},ro=function(e,n){var t={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&n.indexOf(o)<0&&(t[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)n.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(t[o[r]]=e[o[r]])}return t};function io(e,n){Ee.initialize(n).then((function(){e&&e()}))}function ao(){Te.enablePrintCapability()}function so(){Te.print()}function co(e){Re(),pn("getContext",(function(n){n.frameContext||(n.frameContext=v.frameContext),e(n)}))}function lo(e){Ee.registerOnThemeChangeHandler(e)}function uo(e){Ke("fullScreenChange",e,[])}function fo(e){Ke("appButtonClick",e,[U.content])}function po(e){Ke("appButtonHoverEnter",e,[U.content])}function go(e){Ke("appButtonHoverLeave",e,[U.content])}function mo(e){Ie.backStack.registerBackButtonHandlerHelper(e)}function ho(e){Te.registerOnLoadHandlerHelper(e)}function wo(e){Te.registerBeforeUnloadHandlerHelper(e)}function Co(e){Ke("focusEnter",e,[])}function vo(e){Ke("changeSettings",e,[U.content])}function yo(e,n){Oe(ue),Ie.tabs.getTabInstances(n).then((function(n){e(n)}))}function bo(e,n){Oe(ue),Ie.tabs.getMruTabInstances(n).then((function(n){e(n)}))}function So(e){Ie.shareDeepLink({subPageId:e.subEntityId,subPageLabel:e.subEntityLabel,subPageWebUrl:e.subEntityWebUrl})}function To(e,n){Oe(ue,U.content,U.sidePanel,U.settings,U.task,U.stage,U.meetingStage),n=n||K(),Ee.openLink(e).then((function(){n(!0)})).catch((function(e){n(!1,e.message)}))}function Eo(e){Ie.setCurrentFrame(e)}function Io(e,n,t){Ie.initializeWithFrameContext(e,n,t)}function Po(e){Ie.returnFocus(e)}function Fo(e,n){Oe(ue),n=n||K(),Ie.tabs.navigateToTab(e).then((function(){n(!0)})).catch((function(e){n(!1,e.message)}))}function ko(e,n){Oe(ue,U.content,U.sidePanel,U.settings,U.remove,U.task,U.stage,U.meetingStage),n=n||K(),Ie.navigateCrossDomain(e).then((function(){n(!0)})).catch((function(e){n(!1,e.message)}))}function Ao(e){Oe(ue),e=e||K(),Ie.backStack.navigateBack().then((function(){e(!0)})).catch((function(n){e(!1,n.message)}))}!function(e){function n(e){pn("video.videoFrameProcessed",[e])}function t(e){pn("video.notifyError",[e])}function o(){return Oe(ue)&&!!ue.supports.video&&(!!ue.supports.video.mediaStream||!!ue.supports.video.sharedFrame)}function r(e,n){var r=this;if(Oe(ue,U.sidePanel),!o()||!s())throw B;je("video.startVideoExtensibilityVideoStream",(function(n){return to(r,void 0,void 0,(function(){var o,r,i,a;return oo(this,(function(s){switch(s.label){case 0:return[4,zt(o=n.streamId,e,t)];case 1:return r=s.sent(),!Ue()&&(null===(a=null===(i=window.chrome)||void 0===i?void 0:i.webview)||void 0===a||a.registerTextureStream(o,r)),[2]}}))}))}),!1),pn("video.mediaStream.registerForVideoFrame",[n])}function i(e,r){if(Oe(ue,U.sidePanel),!o()||!l())throw B;je("video.newVideoFrame",(function(o){if(o){var r=o.timestamp;e(a(o),(function(){n(r)}),t)}}),!1),pn("video.registerForVideoFrame",[r])}function a(e){if("videoFrameBuffer"in e)return e;var n=e.data,t=ro(e,["data"]);return no(no({},t),{videoFrameBuffer:n})}function s(){var e;return Oe(ue,U.sidePanel)&&c()&&!!(null===(e=ue.supports.video)||void 0===e?void 0:e.mediaStream)}function c(){var e,n,t,o;return!Ue()&&!(!(null===(n=null===(e=window.chrome)||void 0===e?void 0:e.webview)||void 0===n?void 0:n.getTextureStream)||!(null===(o=null===(t=window.chrome)||void 0===t?void 0:t.webview)||void 0===o?void 0:o.registerTextureStream))}function l(){var e;return Oe(ue,U.sidePanel)&&!!(null===(e=ue.supports.video)||void 0===e?void 0:e.sharedFrame)}!function(e){e.NV12="NV12"}(e.VideoFrameFormat||(e.VideoFrameFormat={})),function(e){e.EffectChanged="EffectChanged",e.EffectDisabled="EffectDisabled"}(e.EffectChangeType||(e.EffectChangeType={})),function(e){e.InvalidEffectId="InvalidEffectId",e.InitializationFailure="InitializationFailure"}(e.EffectFailureReason||(e.EffectFailureReason={})),e.registerForVideoFrame=function(e){if(Oe(ue,U.sidePanel),!o())throw B;if(!e.videoFrameHandler||!e.videoBufferHandler)throw new Error("Both videoFrameHandler and videoBufferHandler must be provided");if(s())r(e.videoFrameHandler,e.config);else{if(!l())throw B;i(e.videoBufferHandler,e.config)}},e.notifySelectedVideoEffectChanged=function(e,n){if(Oe(ue,U.sidePanel),!o())throw B;pn("video.videoEffectChanged",[e,n])},e.registerForVideoEffect=function(e){if(Oe(ue,U.sidePanel),!o())throw B;je("video.effectParameterChange",qt(e),!1),pn("video.registerForVideoEffect")},e.isSupported=o}(Kt||(Kt={})),function(e){var n="search.queryChange",t="search.queryClose",o="search.queryExecute";function r(){return!(!Oe(ue)||!ue.supports.search)}e.registerHandlers=function(e,i,a){if(Oe(ue,U.content),!r())throw B;je(t,e),je(o,i),a&&je(n,a)},e.unregisterHandlers=function(){if(Oe(ue,U.content),!r())throw B;pn("search.unregister"),Ge(n),Ge(t),Ge(o)},e.isSupported=r,e.closeSearch=function(){return new Promise((function(e){if(Oe(ue,U.content),!r())throw new Error("Not supported");e(cn("search.closeSearch"))}))}}(Zt||(Zt={})),function(e){function n(n){return new Promise((function(t){if(!i())throw B;t(un(e.SharingAPIMessages.shareWebContent,n))}))}function t(e){if(!(e&&e.content&&e.content.length))throw{errorCode:M.INVALID_ARGUMENTS,message:"Shared content is missing"}}function o(e){if(e.content.some((function(e){return!e.type})))throw{errorCode:M.INVALID_ARGUMENTS,message:"Shared content type cannot be undefined"};if(e.content.some((function(n){return n.type!==e.content[0].type})))throw{errorCode:M.INVALID_ARGUMENTS,message:"Shared content must be of the same type"}}function r(e){if("URL"!==e.content[0].type)throw{errorCode:M.INVALID_ARGUMENTS,message:"Content type is unsupported"};if(e.content.some((function(e){return!e.url})))throw{errorCode:M.INVALID_ARGUMENTS,message:"URLs are required for URL content types"}}function i(){return!(!Oe(ue)||!ue.supports.sharing)}e.SharingAPIMessages={shareWebContent:"sharing.shareWebContent"},e.shareWebContent=function(e,i){try{t(e),o(e),r(e)}catch(e){return $((function(){return Promise.reject(e)}),i)}return Oe(ue,U.content,U.sidePanel,U.task,U.stage,U.meetingStage),$(n,i,e)},e.isSupported=i}(Jt||(Jt={})),function(e){function n(){return!(!Oe(ue)||!ue.supports.stageView)}e.open=function(e){return new Promise((function(t){if(Oe(ue,U.content),!n())throw B;if(!e)throw new Error("[stageView.open] Stage view params cannot be null");t(un("stageView.open",e))}))},e.isSupported=n}(Qt||(Qt={})),function(e){function n(){return!(!Oe(ue)||!ue.supports.webStorage)}e.isWebStorageClearedOnUserLogOut=function(){return Oe(ue),n()},e.isSupported=n}(Xt||(Xt={})),function(e){var n;function t(){return!(!Oe(ue)||!ue.supports.call)}!function(e){e.Unknown="unknown",e.Audio="audio",e.Video="video",e.VideoBasedScreenSharing="videoBasedScreenSharing",e.Data="data"}(n=e.CallModalities||(e.CallModalities={})),e.startCall=function(e){return new Promise((function(o){var r;if(Oe(ue,U.content,U.task),!t())throw B;if(!ue.isLegacyTeams)return pn("call.startCall",[e],o);o(un("executeDeepLink",at(e.targets,null===(r=e.requestedModalities)||void 0===r?void 0:r.includes(n.Video),e.source)))}))},e.isSupported=t}($t||($t={})),function(e){e.Messages=Ee.Messages,e.FailedReason=Ee.FailedReason,e.ExpectedFailureReason=Ee.ExpectedFailureReason,e.notifyAppLoaded=function(){Ee.notifyAppLoaded()},e.notifySuccess=function(){Ee.notifySuccess()},e.notifyFailure=function(e){Ee.notifyFailure(e)},e.notifyExpectedFailure=function(e){Ee.notifyExpectedFailure(e)}}(Yt||(Yt={})),function(e){e.setValidityState=function(e){Ie.config.setValidityState(e)},e.getSettings=function(e){Oe(ue,U.content,U.settings,U.remove,U.sidePanel),Ie.getConfig().then((function(n){e(n)}))},e.setSettings=function(e,n){Oe(ue,U.content,U.settings,U.sidePanel),n=n||K(),Ie.config.setConfig(e).then((function(){n(!0)})).catch((function(e){n(!1,e.message)}))},e.registerOnSaveHandler=function(e){Ie.config.registerOnSaveHandlerHelper(e)},e.registerOnRemoveHandler=function(e){Ie.config.registerOnRemoveHandlerHelper(e)}}(eo||(eo={}));var Ro,Oo,Mo,Do=function(e,n){var t={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&n.indexOf(o)<0&&(t[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)n.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(t[o[r]]=e[o[r]])}return t};!function(e){function n(e){return{url:e.url,size:{height:e.height?e.height:_.Small,width:e.width?e.width:_.Small},title:e.title,fallbackUrl:e.fallbackUrl}}function t(e){return{url:e.url,size:{height:e.height?e.height:_.Small,width:e.width?e.width:_.Small},title:e.title,fallbackUrl:e.fallbackUrl,completionBotId:e.completionBotId}}function o(e){return e.height=e.height?e.height:_.Small,e.width=e.width?e.width:_.Small,e}e.startTask=function(e,o){var r=o?function(e){return o(e.err,e.result)}:void 0;return void 0===e.card&&void 0===e.url||e.card?(Oe(ue,U.content,U.sidePanel,U.meetingStage),pn("tasks.startTask",[e],o)):void 0!==e.completionBotId?be.url.bot.open(t(e),r):be.url.open(n(e),r),new At},e.updateTask=function(e){(e=o(e)).width,e.height;var n=Do(e,["width","height"]);if(Object.keys(n).length)throw new Error("resize requires a TaskInfo argument containing only width and height");be.update.resize(e)},e.submitTask=function(e,n){be.url.submit(e,n)},e.getDefaultSizeIfNotProvided=o}(Ro||(Ro={})),function(e){e.guest="Guest",e.attendee="Attendee",e.presenter="Presenter",e.organizer="Organizer"}(Oo||(Oo={})),function(e){e.added="Added",e.alreadyExists="AlreadyExists",e.conflict="Conflict",e.notFound="NotFound"}(Mo||(Mo={}));var No,Lo,Uo,Ho,Vo,xo,Wo,_o=function(){function e(){}return e.prototype.getFluidTenantInfo=function(){return zo(),new Promise((function(e){e(un("interactive.getFluidTenantInfo"))}))},e.prototype.getFluidToken=function(e){return zo(),new Promise((function(n){n(un("interactive.getFluidToken",e))}))},e.prototype.getFluidContainerId=function(){return zo(),new Promise((function(e){e(un("interactive.getFluidContainerId"))}))},e.prototype.setFluidContainerId=function(e){return zo(),new Promise((function(n){n(un("interactive.setFluidContainerId",e))}))},e.prototype.getNtpTime=function(){return zo(),new Promise((function(e){e(un("interactive.getNtpTime"))}))},e.prototype.registerClientId=function(e){return zo(),new Promise((function(n){n(un("interactive.registerClientId",e))}))},e.prototype.getClientRoles=function(e){return zo(),new Promise((function(n){n(un("interactive.getClientRoles",e))}))},e.prototype.getClientInfo=function(e){return zo(),new Promise((function(n){n(un("interactive.getClientInfo",e))}))},e.create=function(){return zo(),new e},e}();function Bo(){return!(!Oe(ue,U.meetingStage,U.sidePanel)||!ue.supports.interactive)}function zo(){if(!Bo())throw new Error("LiveShareHost Not supported")}!function(e){function n(e,n){return{errorCode:e,message:n}}!function(e){e.Dropbox="DROPBOX",e.Box="BOX",e.Sharefile="SHAREFILE",e.GoogleDrive="GOOGLEDRIVE",e.Egnyte="EGNYTE",e.SharePoint="SharePoint"}(e.CloudStorageProvider||(e.CloudStorageProvider={})),function(e){e[e.Sharepoint=0]="Sharepoint",e[e.WopiIntegration=1]="WopiIntegration",e[e.Google=2]="Google",e[e.OneDrive=3]="OneDrive",e[e.Recent=4]="Recent",e[e.Aggregate=5]="Aggregate",e[e.FileSystem=6]="FileSystem",e[e.Search=7]="Search",e[e.AllFiles=8]="AllFiles",e[e.SharedWithMe=9]="SharedWithMe"}(e.CloudStorageProviderType||(e.CloudStorageProviderType={})),function(e){e.ClassMaterials="classMaterials"}(e.SpecialDocumentLibraryType||(e.SpecialDocumentLibraryType={})),function(e){e.Readonly="readonly"}(e.DocumentLibraryAccessType||(e.DocumentLibraryAccessType={})),function(e){e.Downloaded="Downloaded",e.Downloading="Downloading",e.Failed="Failed"}(e.FileDownloadStatus||(e.FileDownloadStatus={})),function(e){e.Download="DOWNLOAD",e.Upload="UPLOAD",e.Delete="DELETE"}(e.CloudStorageProviderFileAction||(e.CloudStorageProviderFileAction={})),e.getCloudStorageFolders=function(e,n){if(Oe(ue,U.content),!e||0===e.length)throw new Error("[files.getCloudStorageFolders] channelId name cannot be null or empty");if(!n)throw new Error("[files.getCloudStorageFolders] Callback cannot be null");pn("files.getCloudStorageFolders",[e],n)},e.addCloudStorageFolder=function(e,n){if(Oe(ue,U.content),!e||0===e.length)throw new Error("[files.addCloudStorageFolder] channelId name cannot be null or empty");if(!n)throw new Error("[files.addCloudStorageFolder] Callback cannot be null");pn("files.addCloudStorageFolder",[e],n)},e.deleteCloudStorageFolder=function(e,n,t){if(Oe(ue,U.content),!e)throw new Error("[files.deleteCloudStorageFolder] channelId name cannot be null or empty");if(!n)throw new Error("[files.deleteCloudStorageFolder] folderToDelete cannot be null or empty");if(!t)throw new Error("[files.deleteCloudStorageFolder] Callback cannot be null");pn("files.deleteCloudStorageFolder",[e,n],t)},e.getCloudStorageFolderContents=function(e,n,t){if(Oe(ue,U.content),!e||!n)throw new Error("[files.getCloudStorageFolderContents] folder/providerCode name cannot be null or empty");if(!t)throw new Error("[files.getCloudStorageFolderContents] Callback cannot be null");if("isSubdirectory"in e&&!e.isSubdirectory)throw new Error("[files.getCloudStorageFolderContents] provided folder is not a subDirectory");pn("files.getCloudStorageFolderContents",[e,n],t)},e.openCloudStorageFile=function(e,n,t){if(Oe(ue,U.content),!e||!n)throw new Error("[files.openCloudStorageFile] file/providerCode cannot be null or empty");if(e.isSubdirectory)throw new Error("[files.openCloudStorageFile] provided file is a subDirectory");pn("files.openCloudStorageFile",[e,n,t])},e.getExternalProviders=function(e,n){if(void 0===e&&(e=!1),Oe(ue,U.content),!n)throw new Error("[files.getExternalProviders] Callback cannot be null");pn("files.getExternalProviders",[e],n)},e.copyMoveFiles=function(e,n,t,o,r,i){if(void 0===r&&(r=!1),Oe(ue,U.content),!e||0===e.length)throw new Error("[files.copyMoveFiles] selectedFiles cannot be null or empty");if(!n)throw new Error("[files.copyMoveFiles] providerCode cannot be null or empty");if(!t)throw new Error("[files.copyMoveFiles] destinationFolder cannot be null or empty");if(!o)throw new Error("[files.copyMoveFiles] destinationProviderCode cannot be null or empty");if(!i)throw new Error("[files.copyMoveFiles] callback cannot be null");pn("files.copyMoveFiles",[e,n,t,o,r],i)},e.getFileDownloads=function(e){if(Oe(ue,U.content),!e)throw new Error("[files.getFileDownloads] Callback cannot be null");pn("files.getFileDownloads",[],e)},e.openDownloadFolder=function(e,n){if(void 0===e&&(e=void 0),Oe(ue,U.content),!n)throw new Error("[files.openDownloadFolder] Callback cannot be null");pn("files.openDownloadFolder",[e],n)},e.addCloudStorageProvider=function(e){if(Oe(ue,U.content),!e)throw n(M.INVALID_ARGUMENTS,"[files.addCloudStorageProvider] callback cannot be null");pn("files.addCloudStorageProvider",[],e)},e.removeCloudStorageProvider=function(e,t){if(Oe(ue,U.content),!t)throw n(M.INVALID_ARGUMENTS,"[files.removeCloudStorageProvider] callback cannot be null");if(!e||!e.content)throw n(M.INVALID_ARGUMENTS,"[files.removeCloudStorageProvider] 3P cloud storage provider request content is missing");pn("files.removeCloudStorageProvider",[e],t)},e.addCloudStorageProviderFile=function(e,t){if(Oe(ue,U.content),!t)throw n(M.INVALID_ARGUMENTS,"[files.addCloudStorageProviderFile] callback cannot be null");if(!e||!e.content)throw n(M.INVALID_ARGUMENTS,"[files.addCloudStorageProviderFile] 3P cloud storage provider request content is missing");pn("files.addCloudStorageProviderFile",[e],t)},e.renameCloudStorageProviderFile=function(e,t){if(Oe(ue,U.content),!t)throw n(M.INVALID_ARGUMENTS,"[files.renameCloudStorageProviderFile] callback cannot be null");if(!e||!e.content)throw n(M.INVALID_ARGUMENTS,"[files.renameCloudStorageProviderFile] 3P cloud storage provider request content is missing");pn("files.renameCloudStorageProviderFile",[e],t)},e.deleteCloudStorageProviderFile=function(e,t){if(Oe(ue,U.content),!t)throw n(M.INVALID_ARGUMENTS,"[files.deleteCloudStorageProviderFile] callback cannot be null");if(!(e&&e.content&&e.content.itemList&&e.content.itemList.length>0))throw n(M.INVALID_ARGUMENTS,"[files.deleteCloudStorageProviderFile] 3P cloud storage provider request content details are missing");pn("files.deleteCloudStorageProviderFile",[e],t)},e.downloadCloudStorageProviderFile=function(e,t){if(Oe(ue,U.content),!t)throw n(M.INVALID_ARGUMENTS,"[files.downloadCloudStorageProviderFile] callback cannot be null");if(!(e&&e.content&&e.content.itemList&&e.content.itemList.length>0))throw n(M.INVALID_ARGUMENTS,"[files.downloadCloudStorageProviderFile] 3P cloud storage provider request content details are missing");pn("files.downloadCloudStorageProviderFile",[e],t)},e.uploadCloudStorageProviderFile=function(e,t){if(Oe(ue,U.content),!t)throw n(M.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] callback cannot be null");if(!(e&&e.content&&e.content.itemList&&e.content.itemList.length>0))throw n(M.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] 3P cloud storage provider request content details are missing");if(!e.content.destinationFolder)throw n(M.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] Invalid destination folder details");pn("files.uploadCloudStorageProviderFile",[e],t)},e.registerCloudStorageProviderListChangeHandler=function(e){if(Oe(ue),!e)throw new Error("[registerCloudStorageProviderListChangeHandler] Handler cannot be null");je("files.cloudStorageProviderListChange",e)},e.registerCloudStorageProviderContentChangeHandler=function(e){if(Oe(ue),!e)throw new Error("[registerCloudStorageProviderContentChangeHandler] Handler cannot be null");je("files.cloudStorageProviderContentChange",e)}}(No||(No={})),function(e){function n(){return!(!Oe(ue)||!ue.supports.meetingRoom)}e.getPairedMeetingRoomInfo=function(){return new Promise((function(e){if(Oe(ue),!n())throw B;e(un("meetingRoom.getPairedMeetingRoomInfo"))}))},e.sendCommandToPairedMeetingRoom=function(e){return new Promise((function(t){if(!e||0==e.length)throw new Error("[meetingRoom.sendCommandToPairedMeetingRoom] Command name cannot be null or empty");if(Oe(ue),!n())throw B;t(un("meetingRoom.sendCommandToPairedMeetingRoom",e))}))},e.registerMeetingRoomCapabilitiesUpdateHandler=function(e){if(!e)throw new Error("[meetingRoom.registerMeetingRoomCapabilitiesUpdateHandler] Handler cannot be null");if(Oe(ue),!n())throw B;je("meetingRoom.meetingRoomCapabilitiesUpdate",(function(n){Oe(ue),e(n)}))},e.registerMeetingRoomStatesUpdateHandler=function(e){if(!e)throw new Error("[meetingRoom.registerMeetingRoomStatesUpdateHandler] Handler cannot be null");if(Oe(ue),!n())throw B;je("meetingRoom.meetingRoomStatesUpdate",(function(n){Oe(ue),e(n)}))},e.isSupported=n}(Lo||(Lo={})),function(e){function n(){return!(!Oe(ue)||!ue.supports.notifications)}e.showNotification=function(e){if(Oe(ue,U.content),!n())throw B;pn("notifications.showNotification",[e])},e.isSupported=n}(Uo||(Uo={})),function(e){function n(){return!(!Oe(ue)||!ue.supports.remoteCamera)}!function(e){e.Reset="Reset",e.ZoomIn="ZoomIn",e.ZoomOut="ZoomOut",e.PanLeft="PanLeft",e.PanRight="PanRight",e.TiltUp="TiltUp",e.TiltDown="TiltDown"}(e.ControlCommand||(e.ControlCommand={})),function(e){e[e.CommandResetError=0]="CommandResetError",e[e.CommandZoomInError=1]="CommandZoomInError",e[e.CommandZoomOutError=2]="CommandZoomOutError",e[e.CommandPanLeftError=3]="CommandPanLeftError",e[e.CommandPanRightError=4]="CommandPanRightError",e[e.CommandTiltUpError=5]="CommandTiltUpError",e[e.CommandTiltDownError=6]="CommandTiltDownError",e[e.SendDataError=7]="SendDataError"}(e.ErrorReason||(e.ErrorReason={})),function(e){e[e.None=0]="None",e[e.ControlDenied=1]="ControlDenied",e[e.ControlNoResponse=2]="ControlNoResponse",e[e.ControlBusy=3]="ControlBusy",e[e.AckTimeout=4]="AckTimeout",e[e.ControlTerminated=5]="ControlTerminated",e[e.ControllerTerminated=6]="ControllerTerminated",e[e.DataChannelError=7]="DataChannelError",e[e.ControllerCancelled=8]="ControllerCancelled",e[e.ControlDisabled=9]="ControlDisabled",e[e.ControlTerminatedToAllowOtherController=10]="ControlTerminatedToAllowOtherController"}(e.SessionTerminatedReason||(e.SessionTerminatedReason={})),e.getCapableParticipants=function(e){if(!e)throw new Error("[remoteCamera.getCapableParticipants] Callback cannot be null");if(Oe(ue,U.sidePanel),!n())throw B;pn("remoteCamera.getCapableParticipants",e)},e.requestControl=function(e,t){if(!e)throw new Error("[remoteCamera.requestControl] Participant cannot be null");if(!t)throw new Error("[remoteCamera.requestControl] Callback cannot be null");if(Oe(ue,U.sidePanel),!n())throw B;pn("remoteCamera.requestControl",[e],t)},e.sendControlCommand=function(e,t){if(!e)throw new Error("[remoteCamera.sendControlCommand] ControlCommand cannot be null");if(!t)throw new Error("[remoteCamera.sendControlCommand] Callback cannot be null");if(Oe(ue,U.sidePanel),!n())throw B;pn("remoteCamera.sendControlCommand",[e],t)},e.terminateSession=function(e){if(!e)throw new Error("[remoteCamera.terminateSession] Callback cannot be null");if(Oe(ue,U.sidePanel),!n())throw B;pn("remoteCamera.terminateSession",e)},e.registerOnCapableParticipantsChangeHandler=function(e){if(!e)throw new Error("[remoteCamera.registerOnCapableParticipantsChangeHandler] Handler cannot be null");if(Oe(ue,U.sidePanel),!n())throw B;je("remoteCamera.capableParticipantsChange",e)},e.registerOnErrorHandler=function(e){if(!e)throw new Error("[remoteCamera.registerOnErrorHandler] Handler cannot be null");if(Oe(ue,U.sidePanel),!n())throw B;je("remoteCamera.handlerError",e)},e.registerOnDeviceStateChangeHandler=function(e){if(!e)throw new Error("[remoteCamera.registerOnDeviceStateChangeHandler] Handler cannot be null");if(Oe(ue,U.sidePanel),!n())throw B;je("remoteCamera.deviceStateChange",e)},e.registerOnSessionStatusChangeHandler=function(e){if(!e)throw new Error("[remoteCamera.registerOnSessionStatusChangeHandler] Handler cannot be null");if(Oe(ue,U.sidePanel),!n())throw B;je("remoteCamera.sessionStatusChange",e)},e.isSupported=n}(Ho||(Ho={})),function(e){function n(){return!(!Oe(ue)||!ue.supports.appEntity)}e.selectAppEntity=function(e,t,o,r){if(Oe(ue,U.content),!n())throw B;if(!e||0==e.length)throw new Error("[appEntity.selectAppEntity] threadId name cannot be null or empty");if(!r)throw new Error("[appEntity.selectAppEntity] Callback cannot be null");pn("appEntity.selectAppEntity",[e,t,o],r)},e.isSupported=n}(Vo||(Vo={})),function(e){function n(){return!(!Oe(ue)||!ue.supports.teams)}!function(e){e[e.Regular=0]="Regular",e[e.Private=1]="Private",e[e.Shared=2]="Shared"}(e.ChannelType||(e.ChannelType={})),e.getTeamChannels=function(e,t){if(Oe(ue,U.content),!n())throw B;if(!e)throw new Error("[teams.getTeamChannels] groupId cannot be null or empty");if(!t)throw new Error("[teams.getTeamChannels] Callback cannot be null");pn("teams.getTeamChannels",[e],t)},e.refreshSiteUrl=function(e,t){if(Oe(ue),!n())throw B;if(!e)throw new Error("[teams.refreshSiteUrl] threadId cannot be null or empty");if(!t)throw new Error("[teams.refreshSiteUrl] Callback cannot be null");pn("teams.refreshSiteUrl",[e],t)},e.isSupported=n,function(e){function n(){return!(!Oe(ue)||!ue.supports.teams)&&!!ue.supports.teams.fullTrust}!function(e){function n(){return!(!Oe(ue)||!ue.supports.teams)&&(!!ue.supports.teams.fullTrust&&!!ue.supports.teams.fullTrust.joinedTeams)}e.getUserJoinedTeams=function(e){return new Promise((function(t){if(Oe(ue),!n())throw B;if((v.hostClientType===N.android||v.hostClientType===N.teamsRoomsAndroid||v.hostClientType===N.teamsPhones||v.hostClientType===N.teamsDisplays)&&!Me(a)){var o={errorCode:M.OLD_PLATFORM};throw new Error(JSON.stringify(o))}t(sn("getUserJoinedTeams",e))}))},e.isSupported=n}(e.joinedTeams||(e.joinedTeams={})),e.getConfigSetting=function(e){return new Promise((function(t){if(Oe(ue),!n())throw B;t(sn("getConfigSetting",e))}))},e.isSupported=n}(e.fullTrust||(e.fullTrust={}))}(xo||(xo={})),function(e){var n;function t(){return Oe(ue),Kt.isSupported()}function o(e){pn("video.videoFrameProcessed",[e])}function r(e,t){void 0===t&&(t=n.Warn),pn("video.notifyError",[e,t])}!function(e){e.Fatal="fatal",e.Warn="warn"}(n=e.ErrorLevel||(e.ErrorLevel={})),e.registerForVideoFrame=function(e){if(Oe(ue,U.sidePanel),!t())throw B;if(!e.videoBufferHandler)throw new Error("parameters.videoBufferHandler must be provided");je("video.newVideoFrame",(function(n){if(n){var t=n.timestamp;e.videoBufferHandler(n,(function(){o(t)}),r)}}),!1),pn("video.registerForVideoFrame",[e.config])},e.notifySelectedVideoEffectChanged=function(e,n,o){if(Oe(ue,U.sidePanel),!t())throw B;pn("video.videoEffectChanged",[e,n,o])},e.registerForVideoEffect=function(e){if(Oe(ue,U.sidePanel),!t())throw B;je("video.effectParameterChange",qt(e),!1),pn("video.registerForVideoEffect")},e.updatePersonalizedEffects=function(e){if(Oe(ue,U.sidePanel),!Kt.isSupported())throw B;pn("video.personalizedEffectsChanged",[e])},e.isSupported=t,e.notifyFatalError=function(e){if(Oe(ue),!Kt.isSupported())throw B;r(e,n.Fatal)}}(Wo||(Wo={}))})(),o})()));
//# sourceMappingURL=MicrosoftTeams.min.js.map