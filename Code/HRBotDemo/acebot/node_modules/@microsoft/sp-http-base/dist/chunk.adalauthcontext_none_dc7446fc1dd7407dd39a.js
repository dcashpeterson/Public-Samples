(window.webpackJsonp_8496636c_2300_4915_abef_20de64c98d8b_1_18_2=window.webpackJsonp_8496636c_2300_4915_abef_20de64c98d8b_1_18_2||[]).push([[2],{nUPw:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n("jtSf"),i=n("MGiw"),r=n("UWqr"),o=n("bB1B"),s=function(){function e(){}return e._handleInteractionRequiredFailures=function(t,n,s){e._doesAadErrorCodeExist(n,i.e.UNRESOLVABLE_AAD_ERROR_CODES)||i.e.RESOLVABLE_ERROR_CODES.forEach(function(e){if(n.indexOf(e)>-1){var i=t._getNavigateUrl(t.RESPONSE_TYPE.TOKEN,s)+"&prompt=select_account";r._SPEventManager.instance.raiseEvent(a.a._tokenAcquisitionEventId,new a.n(o.e,i))}})},e._isInteractionRequired=function(t,n){return!e._doesAadErrorCodeExist(t,i.e.UNRESOLVABLE_AAD_ERROR_CODES)&&i.e.RESOLVABLE_ERROR_CODES.has(n)},e._isTokenRenewalTimeout=function(e){return e===i.e.TOKEN_RENEWAL_TIMEOUT},e._isEndpointsResolutionError=function(e){return e===i.e.ENDPOINTS_RESOLUTION_ERROR},e._isSessionDoesNotExistError=function(e,t){return e.indexOf(i.e.SESSION_DOES_NOT_EXIST_ERROR)>-1||t.indexOf(i.e.SESSION_DOES_NOT_EXIST_ERROR)>-1},e._doesAadErrorCodeExist=function(e,t){for(var n=0,a=e.match(/(AADSTS)[0-9]+/g)||[];n<a.length;n++){var i=a[n];if(t.has(i))return!0}return!1},e}()},z1gO:function(e,t,n){"use strict";n.r(t),n.d(t,"AdalAuthContextManager",function(){return m});var a=n("UWqr"),i=n("/Vh9"),r=n("17wl"),o=n("ut3N"),s=n("MGiw"),c=n("nUPw"),d=function(e){function t(t,n){var a=e.call(this,t)||this;return a._errorCode=n,a}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"errorCode",{get:function(){return this._errorCode},enumerable:!1,configurable:!0}),t}(Error),l=function(){function e(e,t){this.clientId=e.config.clientId,this._aadUserId=t||"",this._patchAdalAuthContext(e),this._authContext=e,this._extraQueryParameter=e.config.extraQueryParameter}return e.prototype.getToken=function(e,t){var n=this;void 0===t&&(t=!0);var i=(t&&"object"==typeof t?t:{useCachedToken:t}).useCachedToken,r=void 0===i||i,d=new o._QosMonitor("AdalTokenProvider.GetToken"),l={alias:"false",CorrelationId:a.Guid.newGuid().toString(),isInternal:this.clientId===s.e.PRE_AUTHORIZED_APP_PRINCIPAL_ID};return this._getAccessToken(e,r,l).then(function(t){return l.isInternal&&(l.name=e),d.writeSuccess(l),t}).catch(function(t){throw c.e._handleInteractionRequiredFailures(n._authContext,t.message,e),n._monitorAndThrowForAccessTokenExpectedFailures(d,t,e,l),d.writeUnexpectedFailure(t.errorCode,t,l),t})},e.prototype._getAccessToken=function(e,t,n){var i=this._tryGetCachedAccessToken(e);return t&&i?(n.CorrelationId=a.Guid.empty.toString(),n.alias="true",Promise.resolve(i)):this._fetchAccessToken(e,n)},e.prototype._tryGetCachedAccessToken=function(e){var t;try{t=this._authContext.getCachedToken(e);var n=this._authContext._extractIdToken(t);n.oid===this._aadUserId&&n.appid===this.clientId||(t=void 0)}catch(e){}return t},e.prototype._fetchAccessToken=function(e,t){var n=this,i=new o._QosMonitor("AdalTokenProvider.AcquireAccessTokenSilent");return this._authContext.config.correlationId=t.CorrelationId,this._authContext.config.extraQueryParameter=this._extraQueryParameter,this._fetchAccessTokenSilent(e).catch(function(e){n._authContext.config.extraQueryParameter=void 0}).then(function(i){if(i)return i;var r=a.Guid.newGuid().toString();return n._authContext.config.correlationId=r,t.CorrelationId=r,n._fetchAccessTokenSilent(e)}).catch(function(a){throw n._authContext.config.extraQueryParameter=n._extraQueryParameter,n._monitorAndThrowForAccessTokenExpectedFailures(i,a,e,t),a.message.indexOf("Token renewal operation failed due to timeout")>-1&&(a.message=a.message+" - AADCorrelationId: "+t.CorrelationId+" - ClientId: "+n.clientId),i.writeUnexpectedFailure(a.errorCode,a,t),a}).then(function(e){return n._authContext.config.extraQueryParameter=n._extraQueryParameter,i.writeSuccess(t),e})},e.prototype._monitorAndThrowForAccessTokenExpectedFailures=function(e,t,n,a){if(c.e._doesAadErrorCodeExist(t.message,s.e.EXPECTED_AAD_ERRORS))throw e.writeExpectedFailure(t.errorCode,t,a),t},e.prototype._fetchAccessTokenSilent=function(e){var t=this;return new Promise(function(n,a){t._authContext.acquireToken(e,function(e,t,i){t?n(t):a(new d("Error - Type : "+i+" - Description : "+e,i))})})},e.prototype._patchAdalAuthContext=function(e){var t=this;Object.getPrototypeOf(e)._singletonInstance=void 0,e._addAdalFrame=function(n){return t._addAdalFrame(e,n)},e._loadFrame=function(n,a){return t._loadFrame(e,n,a)},e._user={},e._saveItem(e.CONSTANTS.STORAGE.LOGIN_REQUEST,window.location.href)},e.prototype._addAdalFrame=function(e,t){if(void 0!==t){e.info("Add adal frame to document:"+t);var n=document.getElementById(t),a="allow-same-origin allow-scripts allow-forms allow-pointer-lock";if(!n){if(document.createElement&&document.documentElement&&(window.opera||-1===window.navigator.userAgent.indexOf("MSIE 5.0"))){var i=document.createElement("iframe");i.setAttribute("id",t),i.setAttribute("aria-hidden","true"),i.setAttribute("sandbox",a),i.style.visibility="hidden",i.style.position="absolute",i.style.width=i.style.height=i.style.border="0",n=document.getElementsByTagName("body")[0].appendChild(i)}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeEnd",'<iframe sandbox="'+a+'" name="'+t+'" id="'+t+'" style="display:none"></iframe>');var r=window.frames;r&&r[t]&&(n=r[t])}return n}},e.prototype._loadFrame=function(e,t,n){e.info("LoadFrame: "+n),e._addAdalFrame(n).src=t},e}(),u=n("5q05"),f="Microsoft.Identity.Client.MsalUiRequiredException",p=function(){function e(t,n,a,i){var r=this;this._oboFirstPartyTokenCallback=a,this._oboThirdPartyTokenCallback=i,this._exchange1PTokenFor3P=function(t,n){return r._oboFirstPartyTokenCallback?(r._oboFirstPartyTokenRequest&&!n||(r._oboFirstPartyTokenRequest=r._oboFirstPartyTokenCallback(t,n).then(function(e){if(!e)throw new Error("_oboFirstPartyTokenCallback returned empty token");if(r._isTokenExpired(e)){if(n)throw new Error("Failed to refresh an expired token");return r._oboFirstPartyTokenCallback(t,!0)}return Promise.resolve(e)}).then(function(e){if(!e)throw new Error("_oboFirstPartyTokenCallback returned empty token");var t="".concat(r._serverRelativeUrl,"/_api/Microsoft.SharePoint.Internal")+".ClientSideComponent.Token.AcquireOBOToken?resource='".concat(r._authContext.config.clientId,"'")+"&clientId='".concat(s.e.PRE_AUTHORIZED_APP_PRINCIPAL_ID,"'"),n={headers:{"X-HTTP-Method":"GET","OData-Version":"3.0",OBOToken:e,ClientId:s.e.PRE_AUTHORIZED_APP_PRINCIPAL_ID,Resource:r._authContext.config.clientId}};return r._spHttpClient.get(t,u.e.configurations.v1,n)}).then(function(t){return t.ok?t.json():500===t.status?t.json().then(function(t){var n,a=null===(n=t["odata.error"])||void 0===n?void 0:n.code;return a&&a.indexOf(f)>-1&&o._TraceLogger.logError(e._logSource,new Error("Please update your web application info to be {teamSiteDomain} as per https://docs.microsoft.com/en-us/sharepoint/dev/spfx/deployment-spfx-teams-solutions")),Promise.reject(t["odata.error"])}):Promise.reject(t.json())}).then(function(e){return JSON.parse(e.value).AccessToken}).catch(function(e){throw r._oboFirstPartyTokenRequest=void 0,e})),r._oboFirstPartyTokenRequest):Promise.reject()},this.servicePrincipalId=t.config.clientId,this._patchAdalAuthContext(t),this._authContext=t,this._serverRelativeUrl=n.serverRelativeUrl,this._spHttpClient=n.spHttpClient,this._cachedTokens=new Map,this._getTokenQosExtraData={tokenFromCache:"false"}}return e.prototype.getToken=function(e,t){var n=this;void 0===t&&(t=!0);var i=t&&"object"==typeof t?t:{useCachedToken:t},r=i.useCachedToken,s=void 0===r||r,c=i.claims,d=new o._QosMonitor("OboTokenProvider.GetToken");return this._getTokenQosExtraData={tokenFromCache:"false"},this._getAccessToken(e,s,c).then(function(e){return d.writeSuccess(n._getTokenQosExtraData),e}).catch(function(t){throw d.writeUnexpectedFailure("TokenAcquisitionFailure",t,n._getTokenQosExtraData),a._SPKillSwitch.isActivated("cbb2a51c-1456-49ee-92ca-adde5d7e70c7")||!s||c||n._cachedTokens.delete(e),t})},e.prototype._getAccessToken=function(e,t,n){var i,r=this;return t&&!n?a._SPKillSwitch.isActivated("fe22e094-281c-4b1d-8411-608af6d95172")?(i=this._tryGetCachedAccessTokenOld(e)).then(function(t){return t&&!r._isTokenExpired(t)?Promise.resolve(t):r._fetchAccessToken(e)}):(i=this._tryGetCachedAccessToken(e))?i.then(function(t){return t&&!r._isTokenExpired(t)?(r._getTokenQosExtraData.tokenFromCache="true",Promise.resolve(t)):(r._getTokenQosExtraData.tokenFromCache="expired",r._fetchAccessToken(e))}):this._fetchAccessToken(e,n):this._fetchAccessToken(e,n)},e.prototype._tryGetCachedAccessTokenOld=function(e){return this._cachedTokens.get(e)||Promise.resolve(void 0)},e.prototype._tryGetCachedAccessToken=function(e){return this._cachedTokens.get(e)||void 0},e.prototype._fetchAccessToken=function(e,t){var n=new o._QosMonitor("OboTokenProvider.FetchAccessToken"),a={usedNewAuth:!1};return this._cachedTokens.set(e,this._fetchAccessTokenSilent(e,a,t?[t]:void 0).then(function(e){return n.writeSuccess(),e}).catch(function(e){throw e.message&&c.e._doesAadErrorCodeExist(e.message,s.e.EXPECTED_AAD_ERRORS)?n.writeExpectedFailure("TokenAcquisitionFailure",e,a):n.writeUnexpectedFailure("TokenAcquisitionFailure",e,a),e})),this._cachedTokens.get(e)},e.prototype._getOboAuthToken=function(e,t){var n=this;if(!this._oboFirstPartyTokenCallback&&!this._oboThirdPartyTokenCallback)return Promise.resolve("");var i=new o._QosMonitor(t?"OboTokenProvider.GetOboAuthTokenRetry":"OboTokenProvider.GetOboAuthToken"),r={IsClaimsPresent:!!e,IsRefreshOboAuthTokenFlow:!!t},c=this._authContext.config.clientId;return Promise.resolve(void 0),(c===s.e.PRE_AUTHORIZED_APP_PRINCIPAL_ID&&this._oboFirstPartyTokenCallback?this._oboFirstPartyTokenCallback(e,t):!this._oboThirdPartyTokenCallback||!a._SPKillSwitch.isActivated("1281dd06-6176-4d48-ad3c-9442e8294985")&&a._BrowserUtilities.isUsingSecureBroker()&&this._oboFirstPartyTokenCallback?this._exchange1PTokenFor3P(e,t):this._oboThirdPartyTokenCallback(this._authContext.config.clientId,e,t).catch(function(){return n._exchange1PTokenFor3P(e,t)})).then(function(o){if(n._isTokenExpired(o,r)){if(t)throw new Error("Failed to refresh an expired token");return n._getOboAuthToken(e,!0)}if(o||a._SPKillSwitch.isActivated("cbe07593-122d-4ed8-9a3c-ec1944b9bcfa"))return i.writeSuccess(r),o;throw new Error("Empty token returned")}).catch(function(e){return e&&e.code&&e.code.indexOf(f)>-1?i.writeExpectedFailure(void 0,e,r):i.writeUnexpectedFailure(void 0,e,r),""})},e.prototype._isTokenExpired=function(e,t){if(void 0!==e){var n=(a=e)?function(e){if(!e)return{};try{var t=atob(e.replace(/-/g,"+").replace(/_/g,"/"));return JSON.parse(t)}catch(e){return{}}}(decodeURIComponent(a).split(".")[1]):{};return t&&(t.TokenExpiration=n.exp?1e3*n.exp:-1,t.TimeCheckingTokenExpiration=Date.now()),!function(e,t){void 0===t&&(t=Date.now());var n=t/1e3;if(!e)return!1;var a=e.exp,i=e.nbf;return("number"!=typeof i||n>=i)&&("number"!=typeof a||n<a)}(n)}var a;return!1},e.prototype._fetchAccessTokenSilent=function(e,t,n){var a=this;return this._getOboAuthToken(n).then(function(i){return a._authContext.config.clientId===s.e.PRE_AUTHORIZED_ISOLATED_APP_PRINCIPAL_ID?a._fetchAccessTokenFromSecureBroker(e,i,t,n):a._fetchAccessTokenFromTenant(e,i,t,n)})},e.prototype._fetchAccessTokenFromSecureBroker=function(e,t,n,a){var i=this,r=new URL(window.location.href).searchParams.get("tenantId");return r?fetch("https://securebroker.sharepointonline.com/_api/SP.Broker.AcquireOBOToken",{method:"POST",body:JSON.stringify({resource:e,incomingToken:t,tenantId:r}),headers:{accept:"application/json","Content-Type":"application/json"}}).then(function(t){return i._handleOboResponse(t,e,n,a)}):Promise.reject("Missing tenantId")},e.prototype._fetchAccessTokenFromTenant=function(e,t,n,a){var i=this,o="".concat(this._serverRelativeUrl,"/_api/Microsoft.SharePoint.Internal")+".ClientSideComponent.Token.AcquireOBOToken?resource='".concat(e,"'")+"&clientId='".concat(this._authContext.config.clientId,"'"),s={headers:{"X-HTTP-Method":"GET","OData-Version":"3.0"}};return t&&(s.headers.OBOToken=t,n.usedNewAuth=!0),s.headers=Object(r.__assign)(Object(r.__assign)({},s.headers),{ClientId:this._authContext.config.clientId,Resource:e}),this._spHttpClient.get(o,u.e.configurations.v1,s).then(function(t){return i._handleOboResponse(t,e,n,a)})},e.prototype._handleOboResponse=function(e,t,n,a){return this._getOboResponseJson(e,t,n,a).then(function(e){return"string"==typeof e?e:JSON.parse(e.value).AccessToken})},e.prototype._getOboResponseJson=function(e,t,n,i){if(e.ok)return e.json();if(401===e.status){var r=e.headers.get("WWW-Authenticate");if(!i&&r){var o;if(""!==(o=a._SPKillSwitch.isActivated("d802e1d2-b1d5-4527-818b-d43ec3733f45")?r.split(",").map(function(e){var t=e.indexOf("=");return[e.substr(0,t),e.substr(t+1)]}).filter(function(e){return"claims"===e[0]})[0][1].replace(/"/g,""):a.ResponseUtilities.getRequiredClaims(r))||a._SPKillSwitch.isActivated("61ac311e-528b-4c64-b4bc-8efa7f083cca"))return this._fetchAccessTokenSilent(t,n,[o]);n.emptyClaimsAfter401=!0}}return e.json().then(function(e){var t,n;return Promise.reject(null===(n=null===(t=e["odata.error"])||void 0===t?void 0:t.message)||void 0===n?void 0:n.value)})},e.prototype._patchAdalAuthContext=function(e){Object.getPrototypeOf(e)._singletonInstance=void 0},e._logSource=o._LogSource.create("OBOTokenProvider"),e}(),m=function(){function e(){this._loadAdalJsModulePromise=void 0,this._authContextDictionary=new Map}return e.convertTokenParametersToConfig=function(e){var t,n=e.userPrincipalName;n&&(t="login_hint=".concat(encodeURIComponent(n)));var i=a.UrlUtilities.removeEndSlash(e.aadInstanceUrl)+"/";return{clientId:e.servicePrincipalId,redirectUri:e.redirectUri,instance:i,loadFrameTimeout:1e4,tenant:e.aadTenantId,navigateToLoginRequestUrl:!1,extraQueryParameter:t}},e.prototype.getOboTokenProvider=function(t,n,a,r){return new p(i.inject(e.convertTokenParametersToConfig(t)),n,a,r)},e.prototype.getAdalTokenProvider=function(t){if(!this._authContextDictionary.has(t.servicePrincipalId)){var n=new l(i.inject(e.convertTokenParametersToConfig(t)),t.aadUserId);this._authContextDictionary.set(t.servicePrincipalId,n)}return this._authContextDictionary.get(t.servicePrincipalId)},e}()}}]);