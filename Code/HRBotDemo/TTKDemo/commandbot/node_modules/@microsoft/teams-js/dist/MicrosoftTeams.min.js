/*! For license information please see MicrosoftTeams.min.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("microsoftTeams",[],t):"object"==typeof exports?exports.microsoftTeams=t():e.microsoftTeams=t()}("undefined"!=typeof self?self:this,(()=>(()=>{var e={446:(e,t)=>{"use strict";t.byteLength=function(e){var t=s(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,o=s(e),a=o[0],c=o[1],u=new i(l(e,a,c)),d=0,f=c>0?a-4:a;for(n=0;n<f;n+=4)t=r[e.charCodeAt(n)]<<18|r[e.charCodeAt(n+1)]<<12|r[e.charCodeAt(n+2)]<<6|r[e.charCodeAt(n+3)],u[d++]=t>>16&255,u[d++]=t>>8&255,u[d++]=255&t;2===c&&(t=r[e.charCodeAt(n)]<<2|r[e.charCodeAt(n+1)]>>4,u[d++]=255&t);1===c&&(t=r[e.charCodeAt(n)]<<10|r[e.charCodeAt(n+1)]<<4|r[e.charCodeAt(n+2)]>>2,u[d++]=t>>8&255,u[d++]=255&t);return u},t.fromByteArray=function(e){for(var t,r=e.length,i=r%3,o=[],a=16383,s=0,l=r-i;s<l;s+=a)o.push(u(e,s,s+a>l?l:s+a));1===i?(t=e[r-1],o.push(n[t>>2]+n[t<<4&63]+"==")):2===i&&(t=(e[r-2]<<8)+e[r-1],o.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"="));return o.join("")};for(var n=[],r=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0;a<64;++a)n[a]=o[a],r[o.charCodeAt(a)]=a;function s(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function l(e,t,n){return 3*(t+n)/4-n}function c(e){return n[e>>18&63]+n[e>>12&63]+n[e>>6&63]+n[63&e]}function u(e,t,n){for(var r,i=[],o=t;o<n;o+=3)r=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),i.push(c(r));return i.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},313:(e,t,n)=>{"use strict";const r=n(446),i=n(164),o="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.lW=l,t.h2=50;const a=2147483647;function s(e){if(e>a)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,l.prototype),t}function l(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return f(e)}return c(e,t,n)}function c(e,t,n){if("string"==typeof e)return p(e,t);if(ArrayBuffer.isView(e))return h(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(ie(e,ArrayBuffer)||e&&ie(e.buffer,ArrayBuffer))return m(e,t,n);if("undefined"!=typeof SharedArrayBuffer&&(ie(e,SharedArrayBuffer)||e&&ie(e.buffer,SharedArrayBuffer)))return m(e,t,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return l.from(r,t,n);const i=w(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return l.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function u(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function d(e,t,n){return u(e),e<=0?s(e):void 0!==t?"string"==typeof n?s(e).fill(t,n):s(e).fill(t):s(e)}function f(e){return u(e),s(e<0?0:0|C(e))}function p(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!l.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const n=0|v(e,t);let r=s(n);const i=r.write(e,t);return i!==n&&(r=r.slice(0,i)),r}function g(e){const t=e.length<0?0:0|C(e.length),n=s(t);for(let r=0;r<t;r+=1)n[r]=255&e[r];return n}function h(e){if(ie(e,Uint8Array)){const t=new Uint8Array(e);return m(t.buffer,t.byteOffset,t.byteLength)}return g(e)}function m(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');let r;return r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(r,l.prototype),r}function w(e){if(l.isBuffer(e)){const t=0|C(e.length),n=s(t);return 0===n.length||e.copy(n,0,0,t),n}return void 0!==e.length?"number"!=typeof e.length||oe(e.length)?s(0):g(e):"Buffer"===e.type&&Array.isArray(e.data)?g(e.data):void 0}function C(e){if(e>=a)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a.toString(16)+" bytes");return 0|e}function v(e,t){if(l.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||ie(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const n=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return Y(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return ne(e).length;default:if(i)return r?-1:Y(e).length;t=(""+t).toLowerCase(),i=!0}}function S(e,t,n){let r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return U(this,t,n);case"utf8":case"utf-8":return F(this,t,n);case"ascii":return k(this,t,n);case"latin1":case"binary":return H(this,t,n);case"base64":return T(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return V(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function y(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function _(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),oe(n=+n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=l.from(t,r)),l.isBuffer(t))return 0===t.length?-1:b(e,t,n,r,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):b(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function b(e,t,n,r,i){let o,a=1,s=e.length,l=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,s/=2,l/=2,n/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){let r=-1;for(o=n;o<s;o++)if(c(e,o)===c(t,-1===r?0:o-r)){if(-1===r&&(r=o),o-r+1===l)return r*a}else-1!==r&&(o-=o-r),r=-1}else for(n+l>s&&(n=s-l),o=n;o>=0;o--){let n=!0;for(let r=0;r<l;r++)if(c(e,o+r)!==c(t,r)){n=!1;break}if(n)return o}return-1}function E(e,t,n,r){n=Number(n)||0;const i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;const o=t.length;let a;for(r>o/2&&(r=o/2),a=0;a<r;++a){const r=parseInt(t.substr(2*a,2),16);if(oe(r))return a;e[n+a]=r}return a}function P(e,t,n,r){return re(Y(t,e.length-n),e,n,r)}function A(e,t,n,r){return re(ee(t),e,n,r)}function I(e,t,n,r){return re(ne(t),e,n,r)}function R(e,t,n,r){return re(te(t,e.length-n),e,n,r)}function T(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function F(e,t,n){n=Math.min(e.length,n);const r=[];let i=t;for(;i<n;){const t=e[i];let o=null,a=t>239?4:t>223?3:t>191?2:1;if(i+a<=n){let n,r,s,l;switch(a){case 1:t<128&&(o=t);break;case 2:n=e[i+1],128==(192&n)&&(l=(31&t)<<6|63&n,l>127&&(o=l));break;case 3:n=e[i+1],r=e[i+2],128==(192&n)&&128==(192&r)&&(l=(15&t)<<12|(63&n)<<6|63&r,l>2047&&(l<55296||l>57343)&&(o=l));break;case 4:n=e[i+1],r=e[i+2],s=e[i+3],128==(192&n)&&128==(192&r)&&128==(192&s)&&(l=(15&t)<<18|(63&n)<<12|(63&r)<<6|63&s,l>65535&&l<1114112&&(o=l))}}null===o?(o=65533,a=1):o>65535&&(o-=65536,r.push(o>>>10&1023|55296),o=56320|1023&o),r.push(o),i+=a}return O(r)}l.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),l.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}}),l.poolSize=8192,l.from=function(e,t,n){return c(e,t,n)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array),l.alloc=function(e,t,n){return d(e,t,n)},l.allocUnsafe=function(e){return f(e)},l.allocUnsafeSlow=function(e){return f(e)},l.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==l.prototype},l.compare=function(e,t){if(ie(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),ie(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let n=e.length,r=t.length;for(let i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);let n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;const r=l.allocUnsafe(t);let i=0;for(n=0;n<e.length;++n){let t=e[n];if(ie(t,Uint8Array))i+t.length>r.length?(l.isBuffer(t)||(t=l.from(t)),t.copy(r,i)):Uint8Array.prototype.set.call(r,t,i);else{if(!l.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(r,i)}i+=t.length}return r},l.byteLength=v,l.prototype._isBuffer=!0,l.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)y(this,t,t+1);return this},l.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},l.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},l.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?F(this,0,e):S.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){let e="";const n=t.h2;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">"},o&&(l.prototype[o]=l.prototype.inspect),l.prototype.compare=function(e,t,n,r,i){if(ie(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),!l.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;let o=(i>>>=0)-(r>>>=0),a=(n>>>=0)-(t>>>=0);const s=Math.min(o,a),c=this.slice(r,i),u=e.slice(t,n);for(let e=0;e<s;++e)if(c[e]!==u[e]){o=c[e],a=u[e];break}return o<a?-1:a<o?1:0},l.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},l.prototype.indexOf=function(e,t,n){return _(this,e,t,n,!0)},l.prototype.lastIndexOf=function(e,t,n){return _(this,e,t,n,!1)},l.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}const i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");let o=!1;for(;;)switch(r){case"hex":return E(this,e,t,n);case"utf8":case"utf-8":return P(this,e,t,n);case"ascii":case"latin1":case"binary":return A(this,e,t,n);case"base64":return I(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const M=4096;function O(e){const t=e.length;if(t<=M)return String.fromCharCode.apply(String,e);let n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=M));return n}function k(e,t,n){let r="";n=Math.min(e.length,n);for(let i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function H(e,t,n){let r="";n=Math.min(e.length,n);for(let i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function U(e,t,n){const r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);let i="";for(let r=t;r<n;++r)i+=ae[e[r]];return i}function V(e,t,n){const r=e.slice(t,n);let i="";for(let e=0;e<r.length-1;e+=2)i+=String.fromCharCode(r[e]+256*r[e+1]);return i}function L(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function N(e,t,n,r,i,o){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function D(e,t,n,r,i){J(t,r,i,e,n,7);let o=Number(t&BigInt(4294967295));e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o;let a=Number(t>>BigInt(32)&BigInt(4294967295));return e[n++]=a,a>>=8,e[n++]=a,a>>=8,e[n++]=a,a>>=8,e[n++]=a,n}function B(e,t,n,r,i){J(t,r,i,e,n,7);let o=Number(t&BigInt(4294967295));e[n+7]=o,o>>=8,e[n+6]=o,o>>=8,e[n+5]=o,o>>=8,e[n+4]=o;let a=Number(t>>BigInt(32)&BigInt(4294967295));return e[n+3]=a,a>>=8,e[n+2]=a,a>>=8,e[n+1]=a,a>>=8,e[n]=a,n+8}function x(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function W(e,t,n,r,o){return t=+t,n>>>=0,o||x(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function G(e,t,n,r,o){return t=+t,n>>>=0,o||x(e,0,n,8),i.write(e,t,n,r,52,8),n+8}l.prototype.slice=function(e,t){const n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);const r=this.subarray(e,t);return Object.setPrototypeOf(r,l.prototype),r},l.prototype.readUintLE=l.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||L(e,t,this.length);let r=this[e],i=1,o=0;for(;++o<t&&(i*=256);)r+=this[e+o]*i;return r},l.prototype.readUintBE=l.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||L(e,t,this.length);let r=this[e+--t],i=1;for(;t>0&&(i*=256);)r+=this[e+--t]*i;return r},l.prototype.readUint8=l.prototype.readUInt8=function(e,t){return e>>>=0,t||L(e,1,this.length),this[e]},l.prototype.readUint16LE=l.prototype.readUInt16LE=function(e,t){return e>>>=0,t||L(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUint16BE=l.prototype.readUInt16BE=function(e,t){return e>>>=0,t||L(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUint32LE=l.prototype.readUInt32LE=function(e,t){return e>>>=0,t||L(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUint32BE=l.prototype.readUInt32BE=function(e,t){return e>>>=0,t||L(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readBigUInt64LE=se((function(e){K(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||Z(e,this.length-8);const r=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,i=this[++e]+256*this[++e]+65536*this[++e]+n*2**24;return BigInt(r)+(BigInt(i)<<BigInt(32))})),l.prototype.readBigUInt64BE=se((function(e){K(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||Z(e,this.length-8);const r=t*2**24+65536*this[++e]+256*this[++e]+this[++e],i=this[++e]*2**24+65536*this[++e]+256*this[++e]+n;return(BigInt(r)<<BigInt(32))+BigInt(i)})),l.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||L(e,t,this.length);let r=this[e],i=1,o=0;for(;++o<t&&(i*=256);)r+=this[e+o]*i;return i*=128,r>=i&&(r-=Math.pow(2,8*t)),r},l.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||L(e,t,this.length);let r=t,i=1,o=this[e+--r];for(;r>0&&(i*=256);)o+=this[e+--r]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*t)),o},l.prototype.readInt8=function(e,t){return e>>>=0,t||L(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){e>>>=0,t||L(e,2,this.length);const n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(e,t){e>>>=0,t||L(e,2,this.length);const n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(e,t){return e>>>=0,t||L(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return e>>>=0,t||L(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readBigInt64LE=se((function(e){K(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||Z(e,this.length-8);const r=this[e+4]+256*this[e+5]+65536*this[e+6]+(n<<24);return(BigInt(r)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),l.prototype.readBigInt64BE=se((function(e){K(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||Z(e,this.length-8);const r=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(r)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+n)})),l.prototype.readFloatLE=function(e,t){return e>>>=0,t||L(e,4,this.length),i.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return e>>>=0,t||L(e,4,this.length),i.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return e>>>=0,t||L(e,8,this.length),i.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return e>>>=0,t||L(e,8,this.length),i.read(this,e,!1,52,8)},l.prototype.writeUintLE=l.prototype.writeUIntLE=function(e,t,n,r){if(e=+e,t>>>=0,n>>>=0,!r){N(this,e,t,n,Math.pow(2,8*n)-1,0)}let i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},l.prototype.writeUintBE=l.prototype.writeUIntBE=function(e,t,n,r){if(e=+e,t>>>=0,n>>>=0,!r){N(this,e,t,n,Math.pow(2,8*n)-1,0)}let i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},l.prototype.writeUint8=l.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||N(this,e,t,1,255,0),this[t]=255&e,t+1},l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||N(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||N(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||N(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||N(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeBigUInt64LE=se((function(e,t=0){return D(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),l.prototype.writeBigUInt64BE=se((function(e,t=0){return B(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),l.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t>>>=0,!r){const r=Math.pow(2,8*n-1);N(this,e,t,n,r-1,-r)}let i=0,o=1,a=0;for(this[t]=255&e;++i<n&&(o*=256);)e<0&&0===a&&0!==this[t+i-1]&&(a=1),this[t+i]=(e/o>>0)-a&255;return t+n},l.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t>>>=0,!r){const r=Math.pow(2,8*n-1);N(this,e,t,n,r-1,-r)}let i=n-1,o=1,a=0;for(this[t+i]=255&e;--i>=0&&(o*=256);)e<0&&0===a&&0!==this[t+i+1]&&(a=1),this[t+i]=(e/o>>0)-a&255;return t+n},l.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||N(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||N(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||N(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||N(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},l.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||N(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeBigInt64LE=se((function(e,t=0){return D(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),l.prototype.writeBigInt64BE=se((function(e,t=0){return B(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),l.prototype.writeFloatLE=function(e,t,n){return W(this,e,t,!0,n)},l.prototype.writeFloatBE=function(e,t,n){return W(this,e,t,!1,n)},l.prototype.writeDoubleLE=function(e,t,n){return G(this,e,t,!0,n)},l.prototype.writeDoubleBE=function(e,t,n){return G(this,e,t,!1,n)},l.prototype.copy=function(e,t,n,r){if(!l.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);const i=r-n;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,n,r):Uint8Array.prototype.set.call(e,this.subarray(n,r),t),i},l.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!l.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===e.length){const t=e.charCodeAt(0);("utf8"===r&&t<128||"latin1"===r)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;let i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(i=t;i<n;++i)this[i]=e;else{const o=l.isBuffer(e)?e:l.from(e,r),a=o.length;if(0===a)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<n-t;++i)this[i+t]=o[i%a]}return this};const z={};function j(e,t,n){z[e]=class extends n{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function q(e){let t="",n=e.length;const r="-"===e[0]?1:0;for(;n>=r+4;n-=3)t=`_${e.slice(n-3,n)}${t}`;return`${e.slice(0,n)}${t}`}function $(e,t,n){K(t,"offset"),void 0!==e[t]&&void 0!==e[t+n]||Z(t,e.length-(n+1))}function J(e,t,n,r,i,o){if(e>n||e<t){const r="bigint"==typeof t?"n":"";let i;throw i=o>3?0===t||t===BigInt(0)?`>= 0${r} and < 2${r} ** ${8*(o+1)}${r}`:`>= -(2${r} ** ${8*(o+1)-1}${r}) and < 2 ** ${8*(o+1)-1}${r}`:`>= ${t}${r} and <= ${n}${r}`,new z.ERR_OUT_OF_RANGE("value",i,e)}$(r,i,o)}function K(e,t){if("number"!=typeof e)throw new z.ERR_INVALID_ARG_TYPE(t,"number",e)}function Z(e,t,n){if(Math.floor(e)!==e)throw K(e,n),new z.ERR_OUT_OF_RANGE(n||"offset","an integer",e);if(t<0)throw new z.ERR_BUFFER_OUT_OF_BOUNDS;throw new z.ERR_OUT_OF_RANGE(n||"offset",`>= ${n?1:0} and <= ${t}`,e)}j("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),j("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),j("ERR_OUT_OF_RANGE",(function(e,t,n){let r=`The value of "${e}" is out of range.`,i=n;return Number.isInteger(n)&&Math.abs(n)>2**32?i=q(String(n)):"bigint"==typeof n&&(i=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(i=q(i)),i+="n"),r+=` It must be ${t}. Received ${i}`,r}),RangeError);const Q=/[^+/0-9A-Za-z-_]/g;function X(e){if((e=(e=e.split("=")[0]).trim().replace(Q,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}function Y(e,t){let n;t=t||1/0;const r=e.length;let i=null;const o=[];for(let a=0;a<r;++a){if(n=e.charCodeAt(a),n>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function ee(e){const t=[];for(let n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}function te(e,t){let n,r,i;const o=[];for(let a=0;a<e.length&&!((t-=2)<0);++a)n=e.charCodeAt(a),r=n>>8,i=n%256,o.push(i),o.push(r);return o}function ne(e){return r.toByteArray(X(e))}function re(e,t,n,r){let i;for(i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function ie(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function oe(e){return e!=e}const ae=function(){const e="0123456789abcdef",t=new Array(256);for(let n=0;n<16;++n){const r=16*n;for(let i=0;i<16;++i)t[r+i]=e[n]+e[i]}return t}();function se(e){return"undefined"==typeof BigInt?le:e}function le(){throw new Error("BigInt not supported")}},302:(e,t,n)=>{t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let r=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(r++,"%c"===e&&(i=r))})),t.splice(i,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=n(65)(t);const{formatters:r}=e.exports;r.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},65:(e,t,n)=>{e.exports=function(e){function t(e){let n,i,o,a=null;function s(...e){if(!s.enabled)return;const r=s,i=Number(new Date),o=i-(n||i);r.diff=o,r.prev=n,r.curr=i,n=i,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((n,i)=>{if("%%"===n)return"%";a++;const o=t.formatters[i];if("function"==typeof o){const t=e[a];n=o.call(r,t),e.splice(a,1),a--}return n})),t.formatArgs.call(r,e);(r.log||t.log).apply(r,e)}return s.namespace=e,s.useColors=t.useColors(),s.color=t.selectColor(e),s.extend=r,s.destroy=t.destroy,Object.defineProperty(s,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==a?a:(i!==t.namespaces&&(i=t.namespaces,o=t.enabled(e)),o),set:e=>{a=e}}),"function"==typeof t.init&&t.init(s),s}function r(e,n){const r=t(this.namespace+(void 0===n?":":n)+e);return r.log=this.log,r}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names.map(i),...t.skips.map(i).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let n;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const r=("string"==typeof e?e:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(247),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((n=>{t[n]=e[n]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t}},164:(e,t)=>{t.read=function(e,t,n,r,i){var o,a,s=8*i-r-1,l=(1<<s)-1,c=l>>1,u=-7,d=n?i-1:0,f=n?-1:1,p=e[t+d];for(d+=f,o=p&(1<<-u)-1,p>>=-u,u+=s;u>0;o=256*o+e[t+d],d+=f,u-=8);for(a=o&(1<<-u)-1,o>>=-u,u+=r;u>0;a=256*a+e[t+d],d+=f,u-=8);if(0===o)o=1-c;else{if(o===l)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,r),o-=c}return(p?-1:1)*a*Math.pow(2,o-r)},t.write=function(e,t,n,r,i,o){var a,s,l,c=8*o-i-1,u=(1<<c)-1,d=u>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,g=r?1:-1,h=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),(t+=a+d>=1?f/l:f*Math.pow(2,1-d))*l>=2&&(a++,l/=2),a+d>=u?(s=0,a=u):a+d>=1?(s=(t*l-1)*Math.pow(2,i),a+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,i),a=0));i>=8;e[n+p]=255&s,p+=g,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;e[n+p]=255&a,p+=g,a/=256,c-=8);e[n+p-g]|=128*h}},247:e=>{var t=1e3,n=60*t,r=60*n,i=24*r;function o(e){if(!((e=String(e)).length>100)){var o=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(o){var a=parseFloat(o[1]);switch((o[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*a;case"weeks":case"week":case"w":return 6048e5*a;case"days":case"day":case"d":return a*i;case"hours":case"hour":case"hrs":case"hr":case"h":return a*r;case"minutes":case"minute":case"mins":case"min":case"m":return a*n;case"seconds":case"second":case"secs":case"sec":case"s":return a*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}}}function a(e){var o=Math.abs(e);return o>=i?Math.round(e/i)+"d":o>=r?Math.round(e/r)+"h":o>=n?Math.round(e/n)+"m":o>=t?Math.round(e/t)+"s":e+"ms"}function s(e){var o=Math.abs(e);return o>=i?l(e,o,i,"day"):o>=r?l(e,o,r,"hour"):o>=n?l(e,o,n,"minute"):o>=t?l(e,o,t,"second"):e+" ms"}function l(e,t,n,r){var i=t>=1.5*n;return Math.round(e/n)+" "+r+(i?"s":"")}e.exports=function(e,t){t=t||{};var n=typeof e;if("string"===n&&e.length>0)return o(e);if("number"===n&&isFinite(e))return t.long?s(e):a(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,i){if(1&i&&(r=this(r)),8&i)return r;if("object"==typeof r&&r){if(4&i&&r.__esModule)return r;if(16&i&&"function"==typeof r.then)return r}var o=Object.create(null);n.r(o);var a={};e=e||[null,t({}),t([]),t(t)];for(var s=2&i&&r;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((e=>a[e]=()=>r[e]));return a.default=()=>r,n.d(o,a),o}})(),(()=>{n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}})(),(()=>{n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}})();var r={};return(()=>{"use strict";n.r(r),n.d(r,{ActionObjectType:()=>M,ChannelType:()=>W,ChildAppWindow:()=>jr,DialogDimension:()=>x,ErrorCode:()=>k,FileOpenPreference:()=>F,FrameContexts:()=>N,HostClientType:()=>V,HostName:()=>L,LiveShareHost:()=>Uo,NotificationTypes:()=>er,ParentAppWindow:()=>qr,SecondaryM365ContentIdName:()=>O,TaskModuleDimension:()=>G,TeamType:()=>D,UserSettingTypes:()=>nr,UserTeamRole:()=>B,ViewerActionTypes:()=>tr,app:()=>yt,appEntity:()=>pa,appInitialization:()=>Qi,appInstallDialog:()=>Cr,authentication:()=>et,barCode:()=>Ur,calendar:()=>ii,call:()=>Ki,chat:()=>Lr,clipboard:()=>Br,conversations:()=>dr,dialog:()=>at,enablePrintCapability:()=>ro,executeDeepLink:()=>So,externalAppAuthentication:()=>Yo,externalAppCardActions:()=>ta,files:()=>ra,geoLocation:()=>Wr,getAdaptiveCardSchemaVersion:()=>Gr,getContext:()=>oo,getMruTabInstances:()=>Co,getTabInstances:()=>wo,initialize:()=>no,initializeWithFrameContext:()=>_o,liveShare:()=>Ho,location:()=>Zr,logs:()=>Yn,mail:()=>ai,marketplace:()=>Qo,media:()=>yr,meeting:()=>Yr,meetingRoom:()=>oa,menus:()=>lt,messageChannels:()=>aa,monetization:()=>ni,navigateBack:()=>Io,navigateCrossDomain:()=>Ao,navigateToTab:()=>Po,notifications:()=>ca,openFilePreview:()=>cr,pages:()=>Ut,people:()=>di,print:()=>io,profile:()=>hi,registerAppButtonClickHandler:()=>lo,registerAppButtonHoverEnterHandler:()=>co,registerAppButtonHoverLeaveHandler:()=>uo,registerBackButtonHandler:()=>fo,registerBeforeUnloadHandler:()=>go,registerChangeSettingsHandler:()=>mo,registerCustomHandler:()=>sr,registerFocusEnterHandler:()=>ho,registerFullScreenHandler:()=>so,registerOnLoadHandler:()=>po,registerOnThemeChangeHandler:()=>ao,registerUserSettingsChangeHandler:()=>lr,remoteCamera:()=>da,returnFocus:()=>Eo,search:()=>Ni,secondaryBrowser:()=>Jr,sendCustomEvent:()=>ar,sendCustomMessage:()=>or,setFrameContext:()=>yo,settings:()=>To,shareDeepLink:()=>vo,sharing:()=>xi,stageView:()=>Gi,tasks:()=>Oo,teams:()=>ha,teamsCore:()=>li,thirdPartyCloudStorage:()=>eo,uploadCustomApp:()=>ir,version:()=>Oe,videoEffects:()=>Vi,videoEffectsEx:()=>Ca,visualMedia:()=>qi,webStorage:()=>$i});const e=(0,n(302).debug)("teamsJs");function t(t){return e.extend(t)}function i(e,t){return`${e}_${t}`}function o(e){return/^v\d+_[\w.]+$/.test(e)}var a,s;!function(e){e.V_1="v1",e.V_2="v2",e.V_3="v3"}(a||(a={})),function(e){e.App_GetContext="app.getContext",e.App_Initialize="app.initialize",e.App_NotifyAppLoaded="app.notifyAppLoaded",e.App_NotifyExpectedFailure="app.notifyExpectedFailure",e.App_NotifyFailure="app.notifyFailure",e.App_NotifySuccess="app.notifySuccess",e.App_OpenLink="app.openLink",e.App_RegisterOnThemeChangeHandler="app.registerOnThemeChangeHandler",e.AppInitialization_NotifyAppLoaded="appInitialization.notifyAppLoaded",e.AppInitialization_NotifyExpectedFailure="appInitialization.notifyExpectedFailure",e.AppInitialization_NotifyFailure="appInitialization.notifyFailure",e.AppInitialization_NotifySuccess="appInitialization.notifySuccess",e.AppEntity_SelectAppEntity="appEntity.selectAppEntity",e.AppInstallDialog_OpenAppInstallDialog="appInstallDialog.openAppInstallDialog",e.AppWindow_ChildAppWindow_AddEventListener="appWindow.childAppWindow.addEventListener",e.AppWindow_ChildAppWindow_PostMessage="appWindow.childAppWindow.postMessage",e.AppWindow_ParentAppWindow_AddEventListener="appWindow.parentAppWindow.addEventListener",e.AppWindow_ParentAppWindow_PostMessage="appWindow.parentAppWindow.postMessage",e.Authentication_AuthenticationWindow_RegisterInitializeHandler="authentication.authenticationWindow.registerInitializeHandler",e.Authentication_AuthenticationWindow_RegisterNavigateCrossDomainHandler="authentication.authenticationWindow.registerNavigateCrossDomainHandler",e.Authentication_Authenticate="authentication.authenticate",e.Authentication_GetAuthToken="authentication.getAuthToken",e.Authentication_GetUser="authentication.getUser",e.Authentication_NotifyFailure="authentication.notifyFailure",e.Authentication_NotifySuccess="authentication.notifySuccess",e.Authentication_RegisterAuthenticateFailureHandler="authentication.registerAuthenticateFailureHandler",e.Authentication_RegisterAuthenticateSuccessHandler="authentication.registerAuthenticateSuccessHandler",e.BarCode_HasPermission="barCode.hasPermission",e.BarCode_RequestPermission="barCode.requestPermission",e.BarCode_ScanBarCode="barCode.scanBarCode",e.Calendar_ComposeMeeting="calendar.composeMeeting",e.Calendar_OpenCalendarItem="calendar.openCalendarItem",e.Meeting_JoinMeeting="meeting.joinMeeting",e.Call_StartCall="call.startCall",e.Chat_OpenChat="chat.openChat",e.Chat_OpenGroupChat="chat.openGroupChat",e.Clipboard_Read="clipboard.read",e.Clipboard_Write="clipboard.write",e.Conversations_CloseConversation="conversations.closeConversation",e.Conversations_GetChatMember="conversations.getChatMember",e.Conversations_OpenConversation="conversations.openConversation",e.Conversations_RegisterCloseConversationHandler="conversations.registerCloseConversationHandler",e.Conversations_RegisterStartConversationHandler="conversations.registerStartConversationHandler",e.Dialog_AdaptiveCard_Bot_Open="dialog.adaptiveCard.bot.open",e.Dialog_AdaptiveCard_Open="dialog.adaptiveCard.open",e.Dialog_RegisterMessageForChildHandler="dialog.registerMessageForChildHandler",e.Dialog_Update_Resize="dialog.update.resize",e.Dialog_Url_Bot_Open="dialog.url.bot.open",e.Dialog_Url_Bot_RegisterMessageForParentHandler="dialog.url.bot.registerMessageForParentHandler",e.Dialog_Url_Open="dialog.url.open",e.Dialog_Url_RegisterMessageForParentHandler="dialog.url.registerMessageForParentHandler",e.Dialog_Url_Submit="dialog.url.submit",e.Dialog_Url_ParentCommunication_RegisterMessageForChildHandler="dialog.url.parentCommunication.registerMessageForChildHandler",e.Dialog_Url_ParentCommunication_SendMessageToParentFromDialog="dialog.url.parentCommunication.sendMessageToParentFromDialog",e.Dialog_Url_ParentCommunication_SendMessageToDialog="dialog.url.parentCommunication.sendMessageToDialog",e.ExternalAppAuthentication_AuthenticateAndResendRequest="externalAppAuthentication.authenticateAndResendRequest",e.ExternalAppAuthentication_AuthenticateWithSSO="externalAppAuthentication.authenticateWithSSO",e.ExternalAppAuthentication_AuthenticateWithSSOAndResendRequest="externalAppAuthentication.authenticateWithSSOAndResendRequest",e.ExternalAppCardActions_ProcessActionOpenUrl="externalAppCardActions.processActionOpenUrl",e.ExternalAppCardActions_ProcessActionSubmit="externalAppCardActions.processActionSubmit",e.Files_AddCloudStorageFolder="files.addCloudStorageFolder",e.Files_AddCloudStorageProvider="files.addCloudStorageProvider",e.Files_AddCloudStorageProviderFile="files.addCloudStorageProviderFile",e.Files_CopyMoveFiles="files.copyMoveFiles",e.Files_DeleteCloudStorageFolder="files.deleteCloudStorageFolder",e.Files_DeleteCloudStorageProviderFile="files.deleteCloudStorageProviderFile",e.Files_DownloadCloudStorageProviderFile="files.downloadCloudStorageProviderFile",e.Files_GetCloudStorageFolderContents="files.getCloudStorageFolderContents",e.Files_GetCloudStorageFolders="files.getCloudStorageFolders",e.Files_GetExternalProviders="files.getExternalProviders",e.Files_GetFileDownloads="files.getFileDownloads",e.Files_OpenCloudStorageFile="files.openCloudStorageFile",e.Files_OpenDownloadFolder="files.openDownloadFolder",e.Files_RegisterCloudStorageProviderContentChangeHandler="files.registerCloudStorageProviderContentChangeHandler",e.Files_RegisterCloudStorageProviderListChangeHandler="files.registerCloudStorageProviderListChangeHandler",e.Files_RemoveCloudStorageProvider="files.removeCloudStorageProvider",e.Files_RenameCloudStorageProviderFile="files.renameCloudStorageProviderFile",e.Files_UploadCloudStorageProviderFile="files.uploadCloudStorageProviderFile",e.GeoLocation_GetCurrentLocation="geoLocation.getCurrentLocation",e.GeoLocation_HasPermission="geoLocation.hasPermission",e.GeoLocation_Map_ChooseLocation="geoLocation.map.chooseLocation",e.GeoLocation_RequestPermission="geoLocation.requestPermission",e.GeoLocation_ShowLocation="geoLocation.showLocation",e.HandleBeforeUnload="handleBeforeUnload",e.Interactive_GetClientInfo="interactive.getClientInfo",e.Interactive_GetClientRoles="interactive.getClientRoles",e.Interactive_GetFluidContainerId="interactive.getFluidContainerId",e.Interactive_GetFluidTenantInfo="interactive.getFluidTenantInfo",e.Interactive_GetFluidToken="interactive.getFluidToken",e.Interactive_GetNtpTime="interactive.getNtpTime",e.Interactive_RegisterClientId="interactive.registerClientId",e.Interactive_SetFluidContainerId="interactive.setFluidContainerId",e.Location_GetLocation="location.getLocation",e.Location_ShowLocation="location.showLocation",e.Logs_Receive="log.receive",e.Logs_RegisterLogRequestHandler="log.request",e.Mail_ComposeMail="mail.composeMail",e.Mail_OpenMailItem="mail.openMailItem",e.Marketplace_AddOrUpdateCartItems="marketplace.addOrUpdateCartItems",e.Marketplace_GetCart="marketplace.getCart",e.Marketplace_RemoveCardItems="marketplace.removeCartItems",e.Marketplace_UpdateCartStatus="marketplace.updateCartStatus",e.Media_CaptureImage="media.captureImage",e.Media_Controller="media.controller",e.Media_GetMedia="media.getMedia",e.Media_HasPermission="media.hasPermission",e.Media_RegisterGetMediaRequestHandler="media.registerGetMediaRequestHandler",e.Media_RequestPermission="media.requestPermission",e.Media_ScanBarCode="media.scanBarCode",e.Media_SelectMedia="media.selectMedia",e.Media_ViewImages="media.viewImages",e.Meeting_AppShareButton_SetOptions="meeting.appShareButton.setOptions",e.Meeting_GetAppContentStageSharingCapabilities="meeting.getAppContentStageSharingCapabilities",e.Meeting_GetAppContentStageSharingState="meeting.getAppContentStageSharingState",e.Meeting_GetAuthenticationTokenForAnonymousUser="meeting.getAuthenticationTokenForAnonymousUser",e.Meeting_GetIncomingClientAudioState="meeting.getIncomingClientAudioState",e.Meeting_GetLiveStreamState="meeting.getLiveStreamState",e.Meeting_GetMeetingDetails="meeting.getMeetingDetails",e.Meeting_RegisterAudioDeviceSelectionChangedHandler="meeting.registerAudioDeviceSelectionChangedHandler",e.Meeting_RegisterLiveStreamChangedHandler="meeting.registerLiveStreamChangedHandler",e.Meeting_RegisterMeetingReactionReceivedHandler="meeting.registerMeetingReactionReceivedHandler",e.Meeting_RegisterMicStateChangeHandler="meeting.registerMicStateChangeHandler",e.Meeting_RegisterRaiseHandStateChangedHandler="meeting.registerRaiseHandStateChangedHandler",e.Meeting_RegisterSpeakingStateChangeHandler="meeting.registerSpeakingStateChangeHandler",e.Meeting_RequestAppAudioHandling="meeting.requestAppAudioHandling",e.Meeting_RequestStartLiveStreaming="meeting.requestStartLiveStreaming",e.Meeting_RequestStopLiveStreaming="meeting.requestStopLiveStreaming",e.Meeting_SetMicStateWithReason="meeting.setMicStateWithReason",e.Meeting_ShareAppContentToStage="meeting.shareAppContentToStage",e.Meeting_StopSharingAppContentToStage="meeting.stopSharingAppContentToStage",e.Meeting_ToggleIncomingClientAudio="meeting.toggleIncomingClientAudio",e.MeetingRoom_GetPairedMeetingRoomInfo="meetingRoom.getPairedMeetingRoomInfo",e.MeetingRoom_RegisterMeetingRoomCapabilitiesUpdateHandler="meetingRoom.registerMeetingRoomCapabilitiesUpdateHandler",e.MeetingRoom_RegisterMeetingRoomStatesUpdateHandler="meetingRoom.registerMeetingRoomStatesUpdateHandler",e.MeetingRoom_SendCommandToPairedMeetingRoom="meetingRoom.sendCommandToPairedMeetingRoom",e.Menus_HandleActionMenuItemPress="menus.handleActionMenuItemPress",e.Menus_HandleNavBarMenuItemPress="menus.handleNavBarMenuItemPress",e.Menus_HandleViewConfigItemPress="menus.handleViewConfigItemPress",e.Menus_RegisterActionMenuItemPressHandler="menus.registerActionMenuItemPressHandler",e.Menus_RegisterNavBarMenuItemPressHandler="menus.registerNavBarMenuItemPressHandler",e.Menus_RegisterSetModuleViewHandler="menus.registerSetModuleViewHandler",e.Menus_SetNavBarMenu="menus.setNavBarMenu",e.Menus_SetUpViews="menus.setUpViews",e.Menus_ShowActionMenu="menus.showActionMenu",e.MessageChannels_GetTelemetryPort="messageChannels.getTelemetryPort",e.Monetization_OpenPurchaseExperience="monetization.openPurchaseExperience",e.Navigation_NavigateBack="navigation.navigateBack",e.Navigation_NavigateCrossDomain="navigation.navigateCrossDomain",e.Navigation_NavigateToTab="navigation.navigateToTab",e.Navigation_ReturnFocus="navigation.returnFocus",e.Notifications_ShowNotification="notifications.showNotification",e.Pages_AppButton_OnClick="pages.appButton.onClick",e.Pages_AppButton_OnHoverEnter="pages.appButton.onHoverEnter",e.Pages_AppButton_OnHoverLeave="pages.appButton.onHoverLeave",e.Pages_BackStack_NavigateBack="pages.backStack.navigateBack",e.Pages_BackStack_RegisterBackButtonHandler="pages.backStack.registerBackButtonHandler",e.Pages_BackStack_RegisterBackButtonPressHandler="pages.backStack.registerBackButtonPressHandler",e.Pages_Config_RegisterChangeConfigHandler="pages.config.registerChangeConfigHandler",e.Pages_Config_RegisterOnRemoveHandler="pages.config.registerOnRemoveHandler",e.Pages_Config_RegisterOnSaveHandler="pages.config.registerOnSaveHandler",e.Pages_Config_RegisterSettingsRemoveHandler="pages.config.registerSettingsRemoveHandler",e.Pages_Config_RegisterSettingsSaveHandler="pages.config.registerSettingsSaveHandler",e.Pages_Config_SetConfig="pages.config.setConfig",e.Pages_Config_SetValidityState="pages.config.setValidityState",e.Pages_CurrentApp_NavigateTo="pages.currentApp.navigateTo",e.Pages_CurrentApp_NavigateToDefaultPage="pages.currentApp.navigateToDefaultPage",e.Pages_InitializeWithFrameContext="pages.initializeWithFrameContext",e.Pages_FullTrust_EnterFullscreen="pages.fullTrust.enterFullscreen",e.Pages_FullTrust_ExitFullscreen="pages.fullTrust.exitFullscreen",e.Pages_GetConfig="pages.getConfig.",e.Pages_NavigateCrossDomain="pages.navigateCrossDomain",e.Pages_NavigateToApp="pages.navigateToApp",e.Pages_RegisterFocusEnterHandler="pages.registerFocusEnterHandler",e.Pages_RegisterFullScreenHandler="pages.registerFullScreenHandler",e.Pages_RemoveEvent_NotifyFailure="pages.removeEvent.notifyFailure",e.Pages_RemoveEvent_NotifySuccess="pages.removeEvent.notifySuccess",e.Pages_ReturnFocus="pages.returnFocus",e.Pages_SaveEvent_NotifyFailure="pages.saveEvent.notifyFailure",e.Pages_SaveEvent_NotifySuccess="pages.saveEvent.notifySuccess",e.Pages_SetCurrentFrame="pages.setCurrentFrame",e.Pages_ShareDeepLink="pages.shareDeepLink",e.Pages_Tabs_GetMruTabInstances="pages.tabs.getMruTabInstances",e.Pages_Tabs_GetTabInstances="pages.tabs.getTabInstances",e.Pages_Tabs_NavigateToTab="pages.tabs.navigateToTab",e.People_SelectPeople="people.selectPeople",e.PrivateAPIs_OpenFilePreview="openFilePreview",e.PrivateAPIs_RegisterCustomHandler="registerCustomHandler",e.PrivateAPIs_RegisterUserSettingsChangeHandler="registerUserSettingsChangeHandler",e.PrivateAPIs_SendCustomMessage="sendCustomMessage",e.PrivateAPIs_UploadCustomApp="uploadCustomApp",e.Profile_ShowProfile="profile.showProfile",e.PublicAPIs_ExecuteDeepLink="executeDeepLink",e.PublicAPIs_GetContext="getContext",e.PublicAPIs_GetMruTabInstances="getMruTabInstances",e.PublicAPIs_GetTabInstances="getTabInstances",e.PublicAPIs_Initialize="initialize",e.PublicAPIs_InitializeWithFrameContext="initializeWithFrameContext",e.PublicAPIs_RegisterAppButtonClickHandler="registerAppButtonClickHandler",e.PublicAPIs_RegisterAppButtonHoverEnterHandler="registerAppButtonHoverEnterHandler",e.PublicAPIs_RegisterAppButtonHoverLeaveHandler="registerAppButtonHoverLeaveHandler",e.PublicAPIs_RegisterBackButtonHandler="registerBackButtonHandler",e.PublicAPIs_RegisterBeforeUnloadHandler="registerBeforeUnloadHandler",e.PublicAPIs_RegisterChangeSettingsHandler="registerChangeSettingsHandler",e.PublicAPIs_RegisterFocusEnterHandler="registerFocusEnterHandler",e.PublicAPIs_RegisterFullScreenHandler="registerFullScreenHandler",e.PublicAPIs_RegisterOnLoadHandler="registerOnLoadHandler",e.PublicAPIs_RegisterOnThemeChangeHandlerHelper="registerOnThemeChangeHandlerHelper",e.PublicAPIs_SetFrameContext="setFrameContext",e.PublicAPIs_ShareDeepLink="shareDeepLink",e.RegisterBeforeSuspendOrTerminateHandler="registerBeforeSuspendOrTerminateHandler",e.RegisterHandler="registerHandler",e.RegisterOnResumeHandler="registerOnResumeHandler",e.RegisterOnThemeChangeHandler="registerOnThemeChangeHandler",e.RemoteCamera_GetCapableParticipants="remoteCamera.getCapableParticipants",e.RemoteCamera_RegisterOnCapableParticipantsChangeHandler="remoteCamera.registerOnCapableParticipantsChangeHandler",e.RemoteCamera_RegisterOnDeviceStateChangeHandler="remoteCamera.registerOnDeviceStateChangeHandler",e.RemoteCamera_RegisterOnErrorHandler="remoteCamera.registerOnErrorHandler",e.RemoteCamera_RegisterOnSessionStatusChangeHandler="remoteCamera.registerOnSessionStatusChangeHandler",e.RemoteCamera_RequestControl="remoteCamera.requestControl",e.RemoteCamera_SendControlCommand="remoteCamera.sendControlCommand",e.RemoteCamera_TerminateSession="remoteCamera.terminateSession",e.Search_CloseSearch="search.closeSearch",e.Search_RegisterOnChangeHandler="search.registerOnChangeHandler",e.Search_RegisterOnClosedHandler="search.registerOnClosedHandler",e.Search_RegisterOnExecutedHandler="search.registerOnExecutedHandler",e.Search_UnregisterHandlers="search.unregisterHandlers",e.SecondaryBrowser_OpenUrl="secondaryBrowser.openUrl",e.Settings_GetSettings="settings.getSettings",e.Settings_RegisterOnRemoveHandler="settings.registerOnRemoveHandler",e.Settings_RegisterOnSaveHandler="settings.registerOnSaveHandler",e.Settings_Remove_Failure="settings.remove.failure",e.Settings_Remove_Success="settings.remove.success",e.Settings_Save_Failure="settings.save.failure",e.Settings_Save_Success="settings.save.success",e.Settings_SetSettings="settings.setSettings",e.Settings_SetValidityState="settings.setValidityState",e.Sharing_ShareWebContent="sharing.shareWebContent",e.StageView_Open="stageView.open",e.Tasks_StartTask="tasks.startTask",e.Tasks_SubmitTask="tasks.submitTask",e.Tasks_UpdateTask="tasks.updateTask",e.Teams_FullTrust_GetConfigSetting="teams.fullTrust.getConfigSetting",e.Teams_FullTrust_JoinedTeams_GetUserJoinedTeams="teams.fullTrust.joinedTeams.getUserJoinedTeams",e.Teams_GetTeamChannels="teams.getTeamChannels",e.Teams_RefreshSiteUrl="teams.refreshSiteUrl",e.TeamsAPIs_RegisterBeforeUnloadHandler="teamsAPIs_registerBeforeUnloadHandler",e.TeamsAPIs_RegisterOnLoadHandler="teamsAPIs_registerOnLoadHandler",e.ThirdPartyCloudStorage_GetDragAndDropFiles="thirdPartyCloudStorage.getDragAndDropFiles",e.VideoEffects_MediaStream_RegisterForVideoFrame="videoEffects.mediaStream.registerForVideoFrame",e.VideoEffects_NotifySelectedVideoEffectChanged="videoEffects.notifySelectedVideoEffectChanged",e.VideoEffects_NotifyError="videoEffects.notifyError",e.VideoEffects_NotifyVideoFrameProcessed="videoEffects.notifyVideoFrameProcessed",e.VideoEffects_RegisterEffectParameterChangeHandler="videoEffects.registerEffectParameterChangeHandler",e.VideoEffects_RegisterForVideoEffect="videoEffects.registerForVideoEffect",e.VideoEffects_RegisterForVideoFrame="videoEffects.registerForVideoFrame",e.VideoEffects_RegisterSetFrameProcessTimeLimitHandler="videoEffects.setFrameProcessTimeLimitHandler",e.VideoEffects_RegisterStartVideoExtensibilityVideoStreamHandler="videoEffects.startVideoExtensibilityVideoStreamHandler",e.VideoEffects_RegisterForVideoBufferHandler="videoEffects.registerForVideoBufferHandler",e.VideoEffectsEx_MediaStream_RegisterForVideoFrame="videoEffectsEX.mediaStream.registerForVideoFrame",e.VideoEffectsEx_NotifyError="videoEffectsEx.notifyError",e.VideoEffectsEx_NotifySelectedVideoEffectChanged="videoEffectsEx.notifySelectedVideoEffectChanged",e.VideoEffectsEx_NotifyVideoFrameProcessed="videoEffectsEx.notifyVideoFrameProcessed",e.VideoEffectsEx_RegisterEffectParameterChangeHandler="videoEffectsEx.registerEffectParamterChangeHandler",e.VideoEffectsEx_RegisterForVideoEffect="videoEffectsEx.registerForVideoEffect",e.VideoEffectsEx_RegisterForVideoFrame="videoEffectsEx.registerForVideoFrame",e.VideoEffectsEx_RegisterNewVideoFrameHandler="videoEffectsEx.registerNewVideoFrameHandler",e.VideoEffectsEx_RegisterSetFrameProcessTimeLimitHandler="videoEffectsEX.registerSetFrameProcessTimeLimitHandler",e.VideoEffectsEx_RegisterStartVideoExtensibilityVideoStreamHandler="videoEffectsEX.registerStartVideoExtensibilityVideoStreamHandler",e.VideoEffectsEx_UpdatePersonalizedEffects="videoEffectsEx.updatePersonalizedEffects",e.VideoEffectsUtils_EffectFailure="videoEffectsUtils.effectFailure",e.VideoEffectsUtils_ReportVideoEffectChanged="videoEffectsUtils.reportVideoEffectChanged",e.VideoEffectsUtils_TransformerWithMetadata_Constructor="videoEffectsUtils.transformerWithMetadata.constructor",e.VideoPerformanceMonitor_Constructor="videoPerformanceMonitor.performanceDataGenerated",e.VideoPerformanceMonitor_ReportFrameProcessed="videoPerformanceMonitor.reportFrameProcessed",e.VideoPerformanceMonitor_ReportTextureStreamAcquired="videoPerformanceMonitor.reportTextureStreamAcquired",e.VideoPerformanceMonitor_StartMonitorSlowFrameProcessing="videoPerformanceMonitor.startMonitorSlowFrameProcessing",e.VisualMedia_HasPermission="visualMedia.hasPermission",e.VisualMedia_Image_CaptureImages="visualMedia.image.captureImages",e.VisualMedia_Image_RetrieveImages="visualMedia.image.retrieveImages",e.VisualMedia_RequestPermission="visualMedia.requestPermission"}(s||(s={}));const l=JSON.parse('{"validOrigins":["teams.microsoft.com","teams.microsoft.us","gov.teams.microsoft.us","dod.teams.microsoft.us","int.teams.microsoft.com","outlook.office.com","outlook-sdf.office.com","outlook.office365.com","outlook-sdf.office365.com","outlook.live.com","outlook-sdf.live.com","teams.live.com","local.teams.live.com","local.teams.live.com:8080","local.teams.office.com","local.teams.office.com:8080","devspaces.skype.com","ssauth.skype.com","*.www.office.com","www.office.com","word.office.com","excel.office.com","powerpoint.office.com","www.officeppe.com","*.www.microsoft365.com","www.microsoft365.com","bing.com","edgeservices.bing.com","www.bing.com","www.staging-bing-int.com","teams.cloud.microsoft","outlook.cloud.microsoft","m365.cloud.microsoft","copilot.microsoft.com","windows.msn.com"]}');const c="2.0.1",u="2.0.3",d="1.9.0",f="1.8.0",p=n.t(l,2).validOrigins,g=new URL("https://res.cdn.office.net/teams-js/validDomains/json/validDomains.json"),h=/^https:\/\//,m="https",w="teams.microsoft.com",C="The library has not yet been initialized",v="The runtime has not yet been initialized",S="The runtime version is not supported";class y{}y.initializeCalled=!1,y.initializeCompleted=!1,y.additionalValidOrigins=[],y.initializePromise=void 0,y.isFramelessWindow=!1,y.frameContext=void 0,y.hostClientType=void 0,y.printCapabilityEnabled=!1;var _=n(313);const b={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let E;const P=new Uint8Array(16);function A(){if(!E&&(E="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!E))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return E(P)}const I=[];for(let e=0;e<256;++e)I.push((e+256).toString(16).slice(1));function R(e,t=0){return(I[e[t+0]]+I[e[t+1]]+I[e[t+2]]+I[e[t+3]]+"-"+I[e[t+4]]+I[e[t+5]]+"-"+I[e[t+6]]+I[e[t+7]]+"-"+I[e[t+8]]+I[e[t+9]]+"-"+I[e[t+10]]+I[e[t+11]]+I[e[t+12]]+I[e[t+13]]+I[e[t+14]]+I[e[t+15]]).toLowerCase()}const T=function(e,t,n){if(b.randomUUID&&!t&&!e)return b.randomUUID();const r=(e=e||{}).random||(e.rng||A)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=r[e];return t}return R(r)};var F,M,O,k,H,U,V,L,N,D,B,x;!function(e){e.Inline="inline",e.Desktop="desktop",e.Web="web"}(F||(F={})),function(e){e.M365Content="m365content"}(M||(M={})),function(e){e.DriveId="driveId",e.GroupId="groupId",e.SiteId="siteId",e.UserId="userId"}(O||(O={})),function(e){e[e.NOT_SUPPORTED_ON_PLATFORM=100]="NOT_SUPPORTED_ON_PLATFORM",e[e.INTERNAL_ERROR=500]="INTERNAL_ERROR",e[e.NOT_SUPPORTED_IN_CURRENT_CONTEXT=501]="NOT_SUPPORTED_IN_CURRENT_CONTEXT",e[e.PERMISSION_DENIED=1e3]="PERMISSION_DENIED",e[e.NETWORK_ERROR=2e3]="NETWORK_ERROR",e[e.NO_HW_SUPPORT=3e3]="NO_HW_SUPPORT",e[e.INVALID_ARGUMENTS=4e3]="INVALID_ARGUMENTS",e[e.UNAUTHORIZED_USER_OPERATION=5e3]="UNAUTHORIZED_USER_OPERATION",e[e.INSUFFICIENT_RESOURCES=6e3]="INSUFFICIENT_RESOURCES",e[e.THROTTLE=7e3]="THROTTLE",e[e.USER_ABORT=8e3]="USER_ABORT",e[e.OPERATION_TIMED_OUT=8001]="OPERATION_TIMED_OUT",e[e.OLD_PLATFORM=9e3]="OLD_PLATFORM",e[e.FILE_NOT_FOUND=404]="FILE_NOT_FOUND",e[e.SIZE_EXCEEDED=1e4]="SIZE_EXCEEDED"}(k||(k={})),function(e){e.GeoLocation="geolocation",e.Media="media"}(H||(H={})),function(e){e.TextPlain="text/plain",e.TextHtml="text/html",e.ImagePNG="image/png",e.ImageJPEG="image/jpeg"}(U||(U={})),function(e){e.desktop="desktop",e.web="web",e.android="android",e.ios="ios",e.ipados="ipados",e.macos="macos",e.rigel="rigel",e.surfaceHub="surfaceHub",e.teamsRoomsWindows="teamsRoomsWindows",e.teamsRoomsAndroid="teamsRoomsAndroid",e.teamsPhones="teamsPhones",e.teamsDisplays="teamsDisplays"}(V||(V={})),function(e){e.office="Office",e.outlook="Outlook",e.outlookWin32="OutlookWin32",e.orange="Orange",e.places="Places",e.teams="Teams",e.teamsModern="TeamsModern"}(L||(L={})),function(e){e.settings="settings",e.content="content",e.authentication="authentication",e.remove="remove",e.task="task",e.sidePanel="sidePanel",e.stage="stage",e.meetingStage="meetingStage"}(N||(N={})),function(e){e[e.Standard=0]="Standard",e[e.Edu=1]="Edu",e[e.Class=2]="Class",e[e.Plc=3]="Plc",e[e.Staff=4]="Staff"}(D||(D={})),function(e){e[e.Admin=0]="Admin",e[e.User=1]="User",e[e.Guest=2]="Guest"}(B||(B={})),function(e){e.Large="large",e.Medium="medium",e.Small="small"}(x||(x={}));var W,G=x;!function(e){e.Regular="Regular",e.Private="Private",e.Shared="Shared"}(W||(W={}));const z={errorCode:k.NOT_SUPPORTED_ON_PLATFORM},j=1,q=5,$={adaptiveCardSchemaVersion:{majorVersion:1,minorVersion:5}},J=new Error("Invalid input count: Must supply a valid image count (limit of 10)."),K=new Error("Invalid response: Received more images than the specified max limit in the response.");function Z(e){return(t,n)=>{if(!t)throw new Error(e||n)}}function Q(e,t){if("string"!=typeof e||"string"!=typeof t)return NaN;const n=e.split("."),r=t.split(".");function i(e){return/^\d+$/.test(e)}if(!n.every(i)||!r.every(i))return NaN;for(;n.length<r.length;)n.push("0");for(;r.length<n.length;)r.push("0");for(let e=0;e<n.length;++e)if(Number(n[e])!=Number(r[e]))return Number(n[e])>Number(r[e])?1:-1;return 0}function X(){return T()}function Y(e){return Object.keys(e).forEach((t=>{"object"==typeof e[t]&&Y(e[t])})),Object.freeze(e)}function ee(e,t,...n){const r=e(...n);return r.then((e=>{t&&t(void 0,e)})).catch((e=>{t&&t(e)})),r}function te(e,t,...n){const r=e(...n);return r.then((()=>{t&&t(null)})).catch((e=>{t&&t(e)})),r}function ne(e,t,...n){const r=e(...n);return r.then((e=>{t&&t(null,e)})).catch((e=>{t&&t(e,null)})),r}function re(e,t,n){return new Promise(((r,i)=>{const o=setTimeout(i,t,n);e().then((e=>{clearTimeout(o),r(e)})).catch((e=>{clearTimeout(o),i(e)}))}))}function ie(e){const t=new URL("https://teams.microsoft.com/l/entity/"+encodeURIComponent(e.appId)+"/"+encodeURIComponent(e.pageId));return e.webUrl&&t.searchParams.append("webUrl",e.webUrl),(e.channelId||e.subPageId)&&t.searchParams.append("context",JSON.stringify({channelId:e.channelId,subEntityId:e.subPageId})),t.toString()}function oe(e){return!(Q(`${e.majorVersion}.${e.minorVersion}`,`${j}.${q}`)>=0)}function ae(e){return"https:"===e.protocol}function se(e,t){return new Promise(((n,r)=>{if(e||r("MimeType cannot be null or empty."),t||r("Base64 string cannot be null or empty."),e.startsWith("image/")){const r=atob(t),i=new Uint8Array(r.length);for(let e=0;e<r.length;e++)i[e]=r.charCodeAt(e);n(new Blob([i],{type:e}))}const i=_.lW.from(t,"base64").toString();n(new Blob([i],{type:e}))}))}function le(e){return new Promise(((t,n)=>{0===e.size&&n(new Error("Blob cannot be empty."));const r=new FileReader;r.onloadend=()=>{r.result?t(r.result.toString().split(",")[1]):n(new Error("Failed to read the blob"))},r.onerror=()=>{n(r.error)},r.readAsDataURL(e)}))}function ce(){if(ue())throw new Error("window object undefined at SSR check");return window}function ue(){return"undefined"==typeof window}const de=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function fe(e){if(!de.test(e))throw new Error("App ID is not valid. Must be GUID format. App ID: "+e)}var pe=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};const ge=t("runtime"),he=4;function me(e){return e.apiVersion===he}const we={apiVersion:-1,supports:{}};function Ce(e){if(me(e))return!0;throw-1===e.apiVersion?new Error(v):new Error(S)}let ve=we;const Se={apiVersion:4,hostVersionsInfo:$,isLegacyTeams:!0,supports:{appInstallDialog:{},appEntity:{},call:{},chat:{},conversations:{},dialog:{card:{bot:{}},url:{bot:{},parentCommunication:{}},update:{}},interactive:{},logs:{},meetingRoom:{},menus:{},monetization:{},notifications:{},pages:{config:{},backStack:{},fullTrust:{}},remoteCamera:{},teams:{fullTrust:{}},teamsCore:{},video:{sharedFrame:{}}}},ye=[V.desktop,V.web,V.rigel,V.surfaceHub,V.teamsRoomsWindows,V.teamsRoomsAndroid,V.teamsPhones,V.teamsDisplays],_e=[V.android,V.ios,V.ipados],be=[...ye,..._e];function Ee(e){let t=e;if(t.apiVersion<he&&Pe.forEach((e=>{t.apiVersion===e.versionToUpgradeFrom&&(t=e.upgradeToNextVersion(t))})),me(t))return t;throw new Error("Received a runtime that could not be upgraded to the latest version")}const Pe=[{versionToUpgradeFrom:1,upgradeToNextVersion:e=>{var t;return{apiVersion:2,hostVersionsInfo:void 0,isLegacyTeams:e.isLegacyTeams,supports:Object.assign(Object.assign({},e.supports),{dialog:e.supports.dialog?{card:void 0,url:e.supports.dialog,update:null===(t=e.supports.dialog)||void 0===t?void 0:t.update}:void 0})}}},{versionToUpgradeFrom:2,upgradeToNextVersion:e=>{const t=e.supports,{appNotification:n}=t,r=pe(t,["appNotification"]);return Object.assign(Object.assign({},e),{apiVersion:3,supports:r})}},{versionToUpgradeFrom:3,upgradeToNextVersion:e=>{var t,n,r,i,o;return{apiVersion:4,hostVersionsInfo:e.hostVersionsInfo,isLegacyTeams:e.isLegacyTeams,supports:Object.assign(Object.assign({},e.supports),{dialog:e.supports.dialog?{card:null===(t=e.supports.dialog)||void 0===t?void 0:t.card,url:{bot:null===(r=null===(n=e.supports.dialog)||void 0===n?void 0:n.url)||void 0===r?void 0:r.bot,parentCommunication:(null===(i=e.supports.dialog)||void 0===i?void 0:i.url)?{}:void 0},update:null===(o=e.supports.dialog)||void 0===o?void 0:o.update}:void 0})}}}],Ae={"1.0.0":[{capability:{pages:{appButton:{},tabs:{}},stageView:{}},hostClientTypes:ye}],"1.9.0":[{capability:{location:{}},hostClientTypes:be}],"2.0.0":[{capability:{people:{}},hostClientTypes:be},{capability:{sharing:{}},hostClientTypes:[V.desktop,V.web]}],"2.0.1":[{capability:{teams:{fullTrust:{joinedTeams:{}}}},hostClientTypes:[V.android,V.desktop,V.ios,V.teamsRoomsAndroid,V.teamsPhones,V.teamsDisplays,V.web]},{capability:{webStorage:{}},hostClientTypes:[V.desktop]}],"2.0.5":[{capability:{webStorage:{}},hostClientTypes:[V.android,V.ios]}],"2.0.8":[{capability:{sharing:{}},hostClientTypes:[V.android,V.ios]}]},Ie=ge.extend("generateBackCompatRuntimeConfig");function Re(e,t){const n=Object.assign({},e);for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&("object"!=typeof t[r]||Array.isArray(t[r])?r in e||(n[r]=t[r]):n[r]=Re(e[r]||{},t[r]));return n}function Te(e,t,n){Ie("generating back compat runtime config for %s",e);let r=Object.assign({},t.supports);Ie("Supported capabilities in config before updating based on highestSupportedVersion: %o",r),Object.keys(n).forEach((t=>{Q(e,t)>=0&&n[t].forEach((e=>{void 0!==y.hostClientType&&e.hostClientTypes.includes(y.hostClientType)&&(r=Re(r,e.capability))}))}));const i={apiVersion:he,hostVersionsInfo:$,isLegacyTeams:!0,supports:r};return Ie("Runtime config after updating based on highestSupportedVersion: %o",i),i}const Fe=ge.extend("applyRuntimeConfig");function Me(e){"string"==typeof e.apiVersion&&(Fe("Trying to apply runtime with string apiVersion, processing as v1: %o",e),e=Object.assign(Object.assign({},e),{apiVersion:1})),Fe("Fast-forwarding runtime %o",e);const t=Ee(e);Fe("Applying runtime %o",t),ve=Y(t)}const Oe="2.21.0",ke=t("internal"),He=ke.extend("ensureInitializeCalled"),Ue=ke.extend("ensureInitialized");function Ve(){if(!y.initializeCalled)throw He(C),new Error(C)}function Le(e,...t){if(!y.initializeCompleted)throw Ue("%s. initializeCalled: %s",C,y.initializeCalled.toString()),new Error(C);if(t&&t.length>0){let e=!1;for(let n=0;n<t.length;n++)if(t[n]===y.frameContext){e=!0;break}if(!e)throw new Error(`This call is only allowed in following contexts: ${JSON.stringify(t)}. Current context: "${y.frameContext}".`)}return Ce(e)}function Ne(e=c){const t=Q(y.clientSupportedSDKVersion,e);return!isNaN(t)&&t>=0}function De(){return y.hostClientType==V.android||y.hostClientType==V.ios||y.hostClientType==V.ipados}function Be(e=c){if(!De()){throw{errorCode:k.NOT_SUPPORTED_ON_PLATFORM}}if(!Ne(e)){throw{errorCode:k.OLD_PLATFORM}}}function xe(e){let t=y.additionalValidOrigins.concat(e.filter((e=>"string"==typeof e&&h.test(e))));const n={};t=t.filter((e=>!n[e]&&(n[e]=!0,!0))),y.additionalValidOrigins=t}function We(e){return null==e}var Ge=function(e,t,n,r){function i(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?n(e.value):i(e.value).then(a,s)}l((r=r.apply(e,t||[])).next())}))};let ze=[];const je=t("validateOrigin");function qe(){return Ge(this,void 0,void 0,(function*(){yield Je()}))}function $e(){return 0!==ze.length}function Je(){return Ge(this,void 0,void 0,(function*(){return $e()?ze:ue()?(ze=p,p):fetch(g).then((e=>{if(!e.ok)throw new Error("Invalid Response from Fetch Call");return e.json().then((e=>{if(Ke(JSON.stringify(e)))return ze=e.validOrigins,ze;throw new Error("Valid Origins List Is Invalid")}))})).catch((e=>(je("validOrigins fetch call to CDN failed with error: %s. Defaulting to fallback list",e),ze=p,ze)))}))}function Ke(e){let t=JSON.parse(e);try{t=JSON.parse(e)}catch(e){return!1}if(!t.validOrigins)return!1;for(const e of t.validOrigins)try{new URL("https://"+e)}catch(t){return je("isValidOriginsFromCDN call failed to validate origin: %s",e),!1}return!0}function Ze(e,t){if("*."===e.substring(0,2)){const n=e.substring(1);if(t.length>n.length&&t.split(".").length===n.split(".").length&&t.substring(t.length-n.length)===n)return!0}else if(e===t)return!0;return!1}function Qe(e){return Je().then((t=>{if(!ae(e))return je("Origin %s is invalid because it is not using https protocol. Protocol being used: %s",e,e.protocol),!1;const n=e.host;if(t.some((e=>Ze(e,n))))return!0;for(const e of y.additionalValidOrigins){if(Ze("https://"===e.substring(0,8)?e.substring(8):e,n))return!0}return je("Origin %s is invalid because it is not an origin approved by this library or included in the call to app.initialize.\nOrigins approved by this library: %o\nOrigins included in app.initialize: %o",e,t,y.additionalValidOrigins),!1}))}const Xe=a.V_1,Ye=a.V_2;var et;!function(e){let t,n,r,o;function a(e,n){return new Promise(((r,i)=>{if(y.hostClientType===V.desktop||y.hostClientType===V.android||y.hostClientType===V.ios||y.hostClientType===V.ipados||y.hostClientType===V.macos||y.hostClientType===V.rigel||y.hostClientType===V.teamsRoomsWindows||y.hostClientType===V.teamsRoomsAndroid||y.hostClientType===V.teamsPhones||y.hostClientType===V.teamsDisplays||y.hostClientType===V.surfaceHub){const t=document.createElement("a");t.href=n.url,r(wn(e,"authentication.authenticate",[t.href,n.width,n.height,n.isExternal]).then((([e,t])=>{if(e)return t;throw new Error(t)})))}else t={success:r,fail:i},d(n)}))}function l(e,t){return new Promise((n=>{n(wn(e,"authentication.getAuthToken",[null==t?void 0:t.resources,null==t?void 0:t.claims,null==t?void 0:t.silent,null==t?void 0:t.tenantId]))})).then((([e,t])=>{if(e)return t;throw new Error(t)}))}function c(e){return new Promise((t=>{t(wn(e,"authentication.getUser"))})).then((([e,t])=>{if(e)return t;throw new Error(t)}))}function u(){f();try{cn.childWindow&&cn.childWindow.close()}finally{cn.childWindow=null,cn.childOrigin=null}}function d(e){u();let t=e.width||600,n=e.height||400;t=Math.min(t,cn.currentWindow.outerWidth-400),n=Math.min(n,cn.currentWindow.outerHeight-200);const r=document.createElement("a");r.href=e.url.replace("{oauthRedirectMethod}","web");let i=void 0!==cn.currentWindow.screenLeft?cn.currentWindow.screenLeft:cn.currentWindow.screenX,o=void 0!==cn.currentWindow.screenTop?cn.currentWindow.screenTop:cn.currentWindow.screenY;i+=cn.currentWindow.outerWidth/2-t/2,o+=cn.currentWindow.outerHeight/2-n/2,cn.childWindow=cn.currentWindow.open(r.href,"_blank","toolbar=no, location=yes, status=no, menubar=no, scrollbars=yes, top="+o+", left="+i+", width="+t+", height="+n),cn.childWindow?p():h("FailedToOpenWindow")}function f(){n&&(clearInterval(n),n=0),Gt("initialize"),Gt("navigateCrossDomain")}function p(){f(),n=cn.currentWindow.setInterval((()=>{if(!cn.childWindow||cn.childWindow.closed)h("CancelledByUser");else{const e=cn.childOrigin;try{cn.childOrigin="*",$n("ping")}finally{cn.childOrigin=e}}}),100),Wt(i(Xe,s.Authentication_AuthenticationWindow_RegisterInitializeHandler),"initialize",(()=>[N.authentication,y.hostClientType])),Wt(i(Xe,s.Authentication_AuthenticationWindow_RegisterNavigateCrossDomainHandler),"navigateCrossDomain",(()=>!1))}function g(e){try{t&&t.success(e)}finally{t=void 0,u()}}function h(e){try{t&&t.fail(new Error(e))}finally{t=void 0,u()}}e.initialize=function(){Wt(i(Xe,s.Authentication_RegisterAuthenticateSuccessHandler),"authentication.authenticate.success",g,!1),Wt(i(Xe,s.Authentication_RegisterAuthenticateFailureHandler),"authentication.authenticate.failure",h,!1)},e.registerAuthenticationHandlers=function(e){r=e},e.authenticate=function(e){const t=void 0!==e,n=t?e:r;if(!n)throw new Error("No parameters are provided for authentication");return Le(ve,N.content,N.sidePanel,N.settings,N.remove,N.task,N.stage,N.meetingStage),a(n.successCallback||n.failureCallback?i(Xe,s.Authentication_Authenticate):i(Ye,s.Authentication_Authenticate),n).then((e=>{try{return n&&n.successCallback?(n.successCallback(e),""):e}finally{t||(r=void 0)}})).catch((e=>{try{if(n&&n.failureCallback)return n.failureCallback(e.message),"";throw e}finally{t||(r=void 0)}}))},e.getAuthToken=function(e){return Ve(),l(e&&(e.successCallback||e.failureCallback)?i(Xe,s.Authentication_GetAuthToken):i(Ye,s.Authentication_GetAuthToken),e).then((t=>e&&e.successCallback?(e.successCallback(t),""):t)).catch((t=>{if(e&&e.failureCallback)return e.failureCallback(t.message),"";throw t}))},e.getUser=function(e){return Ve(),c(e&&(e.successCallback||e.failureCallback)?i(Xe,s.Authentication_GetUser):i(Ye,s.Authentication_GetUser)).then((t=>e&&e.successCallback?(e.successCallback(t),null):t)).catch((t=>{if(e&&e.failureCallback)return e.failureCallback(t.message),null;throw t}))},e.notifySuccess=function(e,t){Le(ve,N.authentication),yn(i(t?Xe:Ye,s.Authentication_NotifySuccess),"authentication.authenticate.success",[e]),jn(cn.parentWindow,(()=>setTimeout((()=>cn.currentWindow.close()),200)))},e.notifyFailure=function(e,t){Le(ve,N.authentication),yn(i(t?Xe:Ye,s.Authentication_NotifyFailure),"authentication.authenticate.failure",[e]),jn(cn.parentWindow,(()=>setTimeout((()=>cn.currentWindow.close()),200)))},function(e){e.Public="public",e.EUDB="eudb",e.Other="other"}(o=e.DataResidency||(e.DataResidency={}))}(et||(et={}));const tt=a.V_2;function nt(e,t){if(Le(ve,N.content,N.sidePanel,N.task,N.meetingStage),!at.update.isSupported())throw z;yn(e,"tasks.updateTask",[t])}function rt(e,t,n,r){if(Le(ve,N.content,N.sidePanel,N.meetingStage),!at.url.isSupported())throw z;r&&Wt(i(tt,s.Dialog_Url_RegisterMessageForParentHandler),"messageForParent",r);yn(e,"tasks.startTask",[at.url.getDialogInfoFromUrlDialogInfo(t)],((e,t)=>{null==n||n({err:e,result:t}),Gt("messageForParent")}))}function it(e,t,n,r){if(Le(ve,N.content,N.sidePanel,N.meetingStage),!at.url.bot.isSupported())throw z;r&&Wt(i(tt,s.Dialog_Url_Bot_RegisterMessageForParentHandler),"messageForParent",r);yn(e,"tasks.startTask",[at.url.getDialogInfoFromBotUrlDialogInfo(t)],((e,t)=>{null==n||n({err:e,result:t}),Gt("messageForParent")}))}function ot(e,t,n){if(Le(ve,N.content,N.task),!at.url.isSupported())throw z;yn(e,"tasks.completeTask",[t,n?Array.isArray(n)?n:[n]:[]])}var at;!function(e){const t=[];function n(e){y.frameContext&&(y.frameContext===N.task?t.push(e):Gt("messageForChild"))}let r,o,a;e.initialize=function(){Wt(i(tt,s.Dialog_RegisterMessageForChildHandler),"messageForChild",n,!1)},function(e){let n,r;function o(e){return{url:e.url,height:e.size?e.size.height:x.Small,width:e.size?e.size.width:x.Small,title:e.title,fallbackUrl:e.fallbackUrl}}e.open=function(e,t,n){rt(i(tt,s.Dialog_Url_Open),e,t,n)},e.submit=function(e,t){ot(i(tt,s.Dialog_Url_Submit),e,t)},function(e){function n(){var e,t;return Le(ve)&&!!(null===(t=null===(e=ve.supports.dialog)||void 0===e?void 0:e.url)||void 0===t?void 0:t.parentCommunication)}e.sendMessageToParentFromDialog=function(e){if(Le(ve,N.task),!n())throw z;yn(i(tt,s.Dialog_Url_ParentCommunication_SendMessageToParentFromDialog),"messageForParent",[e])},e.sendMessageToDialog=function(e){if(Le(ve,N.content,N.sidePanel,N.meetingStage),!n())throw z;yn(i(tt,s.Dialog_Url_ParentCommunication_SendMessageToDialog),"messageForChild",[e])},e.registerOnMessageFromParent=function(e){if(Le(ve,N.task),!n())throw z;for(Gt("messageForChild"),Wt(i(tt,s.Dialog_Url_ParentCommunication_RegisterMessageForChildHandler),"messageForChild",e),t.reverse();t.length>0;){e(t.pop())}},e.isSupported=n}(n=e.parentCommunication||(e.parentCommunication={})),e.isSupported=function(){return Le(ve)&&void 0!==(ve.supports.dialog&&ve.supports.dialog.url)},function(e){e.open=function(e,t,n){it(i(tt,s.Dialog_Url_Bot_Open),e,t,n)},e.isSupported=function(){return Le(ve)&&void 0!==(ve.supports.dialog&&ve.supports.dialog.url&&ve.supports.dialog.url.bot)}}(r=e.bot||(e.bot={})),e.getDialogInfoFromUrlDialogInfo=o,e.getDialogInfoFromBotUrlDialogInfo=function(e){const t=o(e);return t.completionBotId=e.completionBotId,t}}(r=e.url||(e.url={})),e.isSupported=function(){return!(!Le(ve)||!ve.supports.dialog)},function(e){e.resize=function(e){nt(i(tt,s.Dialog_Update_Resize),e)},e.isSupported=function(){return!(!Le(ve)||!ve.supports.dialog)&&!!ve.supports.dialog.update}}(o=e.update||(e.update={})),function(e){function t(){const e=ve.hostVersionsInfo&&ve.hostVersionsInfo.adaptiveCardSchemaVersion&&!oe(ve.hostVersionsInfo.adaptiveCardSchemaVersion);return Le(ve)&&void 0!==(e&&ve.supports.dialog&&ve.supports.dialog.card)}let n;function r(e){return{card:e.card,height:e.size?e.size.height:x.Small,width:e.size?e.size.width:x.Small,title:e.title}}function o(e){const t=r(e);return t.completionBotId=e.completionBotId,t}e.open=function(e,n){if(Le(ve,N.content,N.sidePanel,N.meetingStage),!t())throw z;const o=r(e);yn(i(tt,s.Dialog_AdaptiveCard_Open),"tasks.startTask",[o],((e,t)=>{null==n||n({err:e,result:t})}))},e.isSupported=t,function(e){function t(){const e=ve.hostVersionsInfo&&ve.hostVersionsInfo.adaptiveCardSchemaVersion&&!oe(ve.hostVersionsInfo.adaptiveCardSchemaVersion);return Le(ve)&&void 0!==(e&&ve.supports.dialog&&ve.supports.dialog.card&&ve.supports.dialog.card.bot)}e.open=function(e,n){if(Le(ve,N.content,N.sidePanel,N.meetingStage),!t())throw z;const r=o(e);yn(i(tt,s.Dialog_AdaptiveCard_Bot_Open),"tasks.startTask",[r],((e,t)=>{null==n||n({err:e,result:t})}))},e.isSupported=t}(n=e.bot||(e.bot={}))}(a=e.adaptiveCard||(e.adaptiveCard={}))}(at||(at={}));const st=a.V_2;var lt;!function(e){let t,n,r,o,a;!function(e){e[e.ifRoom=0]="ifRoom",e[e.overflowOnly=1]="overflowOnly"}(t=e.DisplayMode||(e.DisplayMode={}));function l(e){a&&a(e)||(Le(ve),yn(i(st,s.Menus_HandleViewConfigItemPress),"viewConfigItemPress",[e]))}function c(e){r&&r(e)||(Le(ve),yn(i(st,s.Menus_HandleNavBarMenuItemPress),"handleNavBarMenuItemPress",[e]))}function u(e){o&&o(e)||(Le(ve),yn(i(st,s.Menus_HandleActionMenuItemPress),"handleActionMenuItemPress",[e]))}function d(){return!(!Le(ve)||!ve.supports.menus)}e.MenuItem=class{constructor(){this.enabled=!0,this.selected=!1}},function(e){e.dropDown="dropDown",e.popOver="popOver"}(n=e.MenuListType||(e.MenuListType={})),e.initialize=function(){Wt(i(st,s.Menus_RegisterNavBarMenuItemPressHandler),"navBarMenuItemPress",c,!1),Wt(i(st,s.Menus_RegisterActionMenuItemPressHandler),"actionMenuItemPress",u,!1),Wt(i(st,s.Menus_RegisterSetModuleViewHandler),"setModuleView",l,!1)},e.setUpViews=function(e,t){if(Le(ve),!d())throw z;a=t,yn(i(st,s.Menus_SetUpViews),"setUpViews",[e])},e.setNavBarMenu=function(e,t){if(Le(ve),!d())throw z;r=t,yn(i(st,s.Menus_SetNavBarMenu),"setNavBarMenu",[e])},e.showActionMenu=function(e,t){if(Le(ve),!d())throw z;o=t,yn(i(st,s.Menus_ShowActionMenu),"showActionMenu",[e])},e.isSupported=d}(lt||(lt={}));const ct=a.V_2,ut=5e3,dt=t("app");function ft(e,t){if(ue()){return dt.extend("initialize")("window object undefined at initialization"),Promise.resolve()}return re((()=>Ct(e,t)),ut,new Error("SDK initialization timed out."))}function pt(e){yn(e,yt.Messages.AppLoaded,[Oe])}function gt(e,t){yn(e,yt.Messages.ExpectedFailure,[t.reason,t.message])}function ht(e,t){yn(e,yt.Messages.Failure,[t.reason,t.message])}function mt(e){yn(e,yt.Messages.Success,[Oe])}const wt=dt.extend("initializeHelper");function Ct(e,t){return new Promise((n=>{y.initializeCalled||(y.initializeCalled=!0,Nt(),y.initializePromise=dn(t,e).then((({context:e,clientType:t,runtimeConfig:n,clientSupportedSDKVersion:r=c})=>{y.frameContext=e,y.hostClientType=t,y.clientSupportedSDKVersion=r;try{wt("Parsing %s",n);const e=JSON.parse(n);if(wt("Checking if %o is a valid runtime object",null!=e?e:"null"),!e||!e.apiVersion)throw new Error("Received runtime config is invalid");n&&Me(e)}catch(e){if(!(e instanceof SyntaxError))throw e;try{wt("Attempting to parse %s as an SDK version",n),isNaN(Q(n,c))||(y.clientSupportedSDKVersion=n);const e=JSON.parse(r);if(wt("givenRuntimeConfig parsed to %o",null!=e?e:"null"),!e)throw new Error("givenRuntimeConfig string was successfully parsed. However, it parsed to value of null");Me(e)}catch(e){if(!(e instanceof SyntaxError))throw e;Me(Te(y.clientSupportedSDKVersion,Se,Ae))}}y.initializeCompleted=!0})),et.initialize(),lt.initialize(),Ut.config.initialize(),at.initialize()),Array.isArray(t)&&xe(t),void 0!==y.initializePromise?n(y.initializePromise):wt("GlobalVars.initializePromise is unexpectedly undefined")}))}function vt(e,t){!We(t)&&Ve(),qt(e,t)}function St(e,t){return new Promise((n=>{Le(ve,N.content,N.sidePanel,N.settings,N.task,N.stage,N.meetingStage),n(gn(e,"executeDeepLink",t))}))}var yt;function _t(e){var t;return{actionInfo:e.actionInfo,app:{locale:e.locale,sessionId:e.appSessionId?e.appSessionId:"",theme:e.theme?e.theme:"default",iconPositionVertical:e.appIconPosition,osLocaleInfo:e.osLocaleInfo,parentMessageId:e.parentMessageId,userClickTime:e.userClickTime,userFileOpenPreference:e.userFileOpenPreference,host:{name:e.hostName?e.hostName:L.teams,clientType:e.hostClientType?e.hostClientType:V.web,sessionId:e.sessionId?e.sessionId:"",ringId:e.ringId},appLaunchId:e.appLaunchId},page:{id:e.entityId,frameContext:e.frameContext?e.frameContext:y.frameContext,subPageId:e.subEntityId,isFullScreen:e.isFullScreen,isMultiWindow:e.isMultiWindow,sourceOrigin:e.sourceOrigin},user:{id:null!==(t=e.userObjectId)&&void 0!==t?t:"",displayName:e.userDisplayName,isCallingAllowed:e.isCallingAllowed,isPSTNCallingAllowed:e.isPSTNCallingAllowed,licenseType:e.userLicenseType,loginHint:e.loginHint,userPrincipalName:e.userPrincipalName,tenant:e.tid?{id:e.tid,teamsSku:e.tenantSKU}:void 0},channel:e.channelId?{id:e.channelId,displayName:e.channelName,relativeUrl:e.channelRelativeUrl,membershipType:e.channelType,defaultOneNoteSectionId:e.defaultOneNoteSectionId,ownerGroupId:e.hostTeamGroupId,ownerTenantId:e.hostTeamTenantId}:void 0,chat:e.chatId?{id:e.chatId}:void 0,meeting:e.meetingId?{id:e.meetingId}:void 0,sharepoint:e.sharepoint,team:e.teamId?{internalId:e.teamId,displayName:e.teamName,type:e.teamType,groupId:e.groupId,templateId:e.teamTemplateId,isArchived:e.isTeamArchived,userRole:e.userTeamRole}:void 0,sharePointSite:e.teamSiteUrl||e.teamSiteDomain||e.teamSitePath||e.mySitePath||e.mySiteDomain?{teamSiteUrl:e.teamSiteUrl,teamSiteDomain:e.teamSiteDomain,teamSitePath:e.teamSitePath,teamSiteId:e.teamSiteId,mySitePath:e.mySitePath,mySiteDomain:e.mySiteDomain}:void 0}}!function(e){const n=t("app");let r,o,a;e.Messages={AppLoaded:"appInitialization.appLoaded",Success:"appInitialization.success",Failure:"appInitialization.failure",ExpectedFailure:"appInitialization.expectedFailure"},function(e){e.AuthFailed="AuthFailed",e.Timeout="Timeout",e.Other="Other"}(r=e.FailedReason||(e.FailedReason={})),function(e){e.PermissionError="PermissionError",e.NotFound="NotFound",e.Throttling="Throttling",e.Offline="Offline",e.Other="Other"}(o=e.ExpectedFailureReason||(e.ExpectedFailureReason={})),e.isInitialized=function(){return y.initializeCompleted},e.getFrameContext=function(){return y.frameContext},function(){if(ue())return;const e=document.getElementsByTagName("script"),t=e&&e[e.length-1]&&e[e.length-1].src,r="Today, teamsjs can only be used from a single script or you may see undefined behavior. This log line is used to help detect cases where teamsjs is loaded multiple times -- it is always written. The presence of the log itself does not indicate a multi-load situation, but multiples of these log lines will. If you would like to use teamjs from more than one script at the same time, please open an issue at https://github.com/OfficeDev/microsoft-teams-library-js/issues";t&&0!==t.length?n("teamsjs is being used from %s. %s",t,r):n("teamsjs is being used from a script tag embedded directly in your html. %s",r)}(),e.initialize=function(e){return qe(),ft(i(ct,s.App_Initialize),e)},e._initialize=function(e){cn.currentWindow=e},e._uninitialize=function(){y.initializeCalled&&(Dt(),y.initializeCalled=!1,y.initializeCompleted=!1,y.initializePromise=void 0,y.additionalValidOrigins=[],y.frameContext=void 0,y.hostClientType=void 0,y.isFramelessWindow=!1,fn())},e.getContext=function(){return new Promise((e=>{Ve(),e(pn(i(ct,s.App_GetContext),"getContext"))})).then((e=>_t(e)))},e.notifyAppLoaded=function(){Ve(),pt(i(ct,s.App_NotifyAppLoaded))},e.notifySuccess=function(){Ve(),mt(i(ct,s.App_NotifySuccess))},e.notifyFailure=function(e){Ve(),ht(i(ct,s.App_NotifyFailure),e)},e.notifyExpectedFailure=function(e){Ve(),gt(i(ct,s.App_NotifyExpectedFailure),e)},e.registerOnThemeChangeHandler=function(e){vt(i(ct,s.App_RegisterOnThemeChangeHandler),e)},e.openLink=function(e){return St(i(ct,s.App_OpenLink),e)},function(e){e.registerBeforeSuspendOrTerminateHandler=function(e){if(!e)throw new Error("[app.lifecycle.registerBeforeSuspendOrTerminateHandler] Handler cannot be null");Le(ve),Xt(e)},e.registerOnResumeHandler=function(e){if(!e)throw new Error("[app.lifecycle.registerOnResumeHandler] Handler cannot be null");Le(ve),Yt(e)}}(a=e.lifecycle||(e.lifecycle={}))}(yt||(yt={}));const bt=a.V_2;function Et(e,t){return new Promise((n=>{if(Le(ve,N.content,N.sidePanel,N.settings,N.remove,N.task,N.stage,N.meetingStage),!Ut.isSupported())throw z;n(hn(e,"navigateCrossDomain","Cross-origin navigation is only supported for URLs matching the pattern registered in the manifest.",t))}))}function Pt(e){return new Promise((t=>{if(Le(ve),!Ut.backStack.isSupported())throw z;t(hn(e,"navigateBack","Back navigation is not supported in the current client or context."))}))}function At(e,t){return new Promise((n=>{if(Le(ve),!Ut.tabs.isSupported())throw z;n(hn(e,"navigateToTab","Invalid internalTabInstanceId and/or channelId were/was provided",t))}))}function It(e,t){if(Le(ve),!Ut.isSupported())throw z;yn(e,"returnFocus",[t])}function Rt(e,t){return new Promise((n=>{if(Le(ve),!Ut.tabs.isSupported())throw z;n(pn(e,"getTabInstances",t))}))}function Tt(e,t){return new Promise((n=>{if(Le(ve),!Ut.tabs.isSupported())throw z;n(pn(e,"getMruTabInstances",t))}))}function Ft(e,t){if(Le(ve,N.content,N.sidePanel,N.meetingStage),!Ut.isSupported())throw z;yn(e,"shareDeepLink",[t.subPageId,t.subPageLabel,t.subPageWebUrl])}function Mt(e,t){if(Le(ve,N.content),!Ut.isSupported())throw z;yn(e,"setFrameContext",[t])}function Ot(e,t){if(Le(ve,N.settings,N.remove),!Ut.config.isSupported())throw z;yn(e,"settings.setValidityState",[t])}function kt(e){return new Promise((t=>{if(Le(ve,N.content,N.settings,N.remove,N.sidePanel),!Ut.isSupported())throw z;t(pn(e,"settings.getSettings"))}))}function Ht(e,t){return new Promise((n=>{if(Le(ve,N.content,N.settings,N.sidePanel),!Ut.config.isSupported())throw z;n(gn(e,"settings.setSettings",t))}))}var Ut;!function(e){function t(e){Mt(i(bt,s.Pages_SetCurrentFrame),e)}function n(){return!(!Le(ve)||!ve.supports.pages)}let r,o,a,l,c,u;e.returnFocus=function(e){It(i(bt,s.Pages_ReturnFocus),e)},e.registerFocusEnterHandler=function(e){jt(i(bt,s.Pages_RegisterFocusEnterHandler),"focusEnter",e,[],(()=>{if(!n())throw z}))},e.setCurrentFrame=t,e.initializeWithFrameContext=function(e,n,r){qe(),ft(i(bt,s.Pages_InitializeWithFrameContext),r).then((()=>n&&n())),t(e)},e.getConfig=function(){return kt(i(bt,s.Pages_GetConfig))},e.navigateCrossDomain=function(e){return Et(i(bt,s.Pages_NavigateCrossDomain),e)},e.navigateToApp=function(e){return new Promise((t=>{if(Le(ve,N.content,N.sidePanel,N.settings,N.task,N.stage,N.meetingStage),!n())throw z;const r=i(bt,s.Pages_NavigateCrossDomain);ve.isLegacyTeams?t(gn(r,"executeDeepLink",ie(e))):t(gn(r,"pages.navigateToApp",e))}))},e.shareDeepLink=function(e){return Ft(i(bt,s.Pages_ShareDeepLink),e)},e.registerFullScreenHandler=function(e){jt(i(bt,s.Pages_RegisterFullScreenHandler),"fullScreenChange",e,[],(()=>{if(!We(e)&&!n())throw z}))},e.isSupported=n,function(e){e.navigateToTab=function(e){return At(i(bt,s.Pages_Tabs_NavigateToTab),e)},e.getTabInstances=function(e){return Rt(i(bt,s.Pages_Tabs_GetTabInstances),e)},e.getMruTabInstances=function(e){return Tt(i(bt,s.Pages_Tabs_GetMruTabInstances),e)},e.isSupported=function(){return!(!Le(ve)||!ve.supports.pages)&&!!ve.supports.pages.tabs}}(r=e.tabs||(e.tabs={})),function(e){let t,n;function r(e,n,r){!We(n)&&Le(ve,N.settings),r&&r(),t=n,!We(n)&&yn(e,"registerHandler",["save"])}function o(e,t,r){!We(t)&&Le(ve,N.remove,N.settings),r&&r(),n=t,!We(t)&&yn(e,"registerHandler",["remove"])}function a(e){const n=new l(e);t?t(n):cn.childWindow?$n("settings.save",[e]):n.notifySuccess()}e.initialize=function(){Wt(i(bt,s.Pages_Config_RegisterSettingsSaveHandler),"settings.save",a,!1),Wt(i(bt,s.Pages_Config_RegisterSettingsRemoveHandler),"settings.remove",c,!1)},e.setValidityState=function(e){return Ot(i(bt,s.Pages_Config_SetValidityState),e)},e.setConfig=function(e){return Ht(i(bt,s.Pages_Config_SetConfig),e)},e.registerOnSaveHandler=function(e){r(i(bt,s.Pages_Config_RegisterOnSaveHandler),e,(()=>{if(!We(e)&&!d())throw z}))},e.registerOnSaveHandlerHelper=r,e.registerOnRemoveHandler=function(e){o(i(bt,s.Pages_Config_RegisterOnRemoveHandler),e,(()=>{if(!We(e)&&!d())throw z}))},e.registerOnRemoveHandlerHelper=o,e.registerChangeConfigHandler=function(e){jt(i(bt,s.Pages_Config_RegisterChangeConfigHandler),"changeSettings",e,[N.content],(()=>{if(!d())throw z}))};class l{constructor(e){this.notified=!1,this.result=e||{}}notifySuccess(){this.ensureNotNotified(),yn(i(bt,s.Pages_SaveEvent_NotifySuccess),"settings.save.success"),this.notified=!0}notifyFailure(e){this.ensureNotNotified(),yn(i(bt,s.Pages_SaveEvent_NotifyFailure),"settings.save.failure",[e]),this.notified=!0}ensureNotNotified(){if(this.notified)throw new Error("The SaveEvent may only notify success or failure once.")}}function c(){const e=new u;n?n(e):cn.childWindow?$n("settings.remove",[]):e.notifySuccess()}class u{constructor(){this.notified=!1}notifySuccess(){this.ensureNotNotified(),yn(i(bt,s.Pages_RemoveEvent_NotifySuccess),"settings.remove.success"),this.notified=!0}notifyFailure(e){this.ensureNotNotified(),yn(i(bt,s.Pages_RemoveEvent_NotifyFailure),"settings.remove.failure",[e]),this.notified=!0}ensureNotNotified(){if(this.notified)throw new Error("The removeEventType may only notify success or failure once.")}}function d(){return!(!Le(ve)||!ve.supports.pages)&&!!ve.supports.pages.config}e.isSupported=d}(o=e.config||(e.config={})),function(e){let t;function n(){return Pt(i(bt,s.Pages_BackStack_NavigateBack))}function r(e,n,r){!We(n)&&Le(ve),r&&r(),t=n,!We(n)&&yn(e,"registerHandler",["backButton"])}function o(){t&&t()||(cn.childWindow?$n("backButtonPress",[]):n())}function a(){return!(!Le(ve)||!ve.supports.pages)&&!!ve.supports.pages.backStack}e._initialize=function(){Wt(i(bt,s.Pages_BackStack_RegisterBackButtonPressHandler),"backButtonPress",o,!1)},e.navigateBack=n,e.registerBackButtonHandler=function(e){r(i(bt,s.Pages_BackStack_RegisterBackButtonHandler),e,(()=>{if(!We(e)&&!a())throw z}))},e.registerBackButtonHandlerHelper=r,e.isSupported=a}(a=e.backStack||(e.backStack={})),function(e){function t(){return!(!Le(ve)||!ve.supports.pages)&&!!ve.supports.pages.fullTrust}e.enterFullscreen=function(){if(Le(ve,N.content),!t())throw z;yn(i(bt,s.Pages_FullTrust_EnterFullscreen),"enterFullscreen",[])},e.exitFullscreen=function(){if(Le(ve,N.content),!t())throw z;yn(i(bt,s.Pages_FullTrust_ExitFullscreen),"exitFullscreen",[])},e.isSupported=t}(l=e.fullTrust||(e.fullTrust={})),function(e){function t(){return!(!Le(ve)||!ve.supports.pages)&&!!ve.supports.pages.appButton}e.onClick=function(e){jt(i(bt,s.Pages_AppButton_OnClick),"appButtonClick",e,[N.content],(()=>{if(!t())throw z}))},e.onHoverEnter=function(e){jt(i(bt,s.Pages_AppButton_OnHoverEnter),"appButtonHoverEnter",e,[N.content],(()=>{if(!t())throw z}))},e.onHoverLeave=function(e){jt(i(bt,s.Pages_AppButton_OnHoverLeave),"appButtonHoverLeave",e,[N.content],(()=>{if(!t())throw z}))},e.isSupported=t}(c=e.appButton||(e.appButton={})),function(e){function t(){return!(!Le(ve)||!ve.supports.pages)&&!!ve.supports.pages.currentApp}e.navigateTo=function(e){return new Promise((n=>{if(Le(ve,N.content,N.sidePanel,N.settings,N.task,N.stage,N.meetingStage),!t())throw z;n(mn(i(bt,s.Pages_CurrentApp_NavigateTo),"pages.currentApp.navigateTo",e))}))},e.navigateToDefaultPage=function(){return new Promise((e=>{if(Le(ve,N.content,N.sidePanel,N.settings,N.task,N.stage,N.meetingStage),!t())throw z;e(mn(i(bt,s.Pages_CurrentApp_NavigateToDefaultPage),"pages.currentApp.navigateToDefaultPage"))}))},e.isSupported=t}(u=e.currentApp||(e.currentApp={}))}(Ut||(Ut={}));const Vt=t("handlers");class Lt{static initializeHandlers(){Lt.handlers.themeChange=$t,Lt.handlers.load=Kt,Lt.handlers.beforeUnload=Qt,Ut.backStack._initialize()}static uninitializeHandlers(){Lt.handlers={},Lt.themeChangeHandler=null,Lt.loadHandler=null,Lt.beforeUnloadHandler=null,Lt.beforeSuspendOrTerminateHandler=null,Lt.resumeHandler=null}}function Nt(){Lt.initializeHandlers()}function Dt(){Lt.uninitializeHandlers()}Lt.handlers={},Lt.themeChangeHandler=null,Lt.loadHandler=null,Lt.beforeUnloadHandler=null,Lt.beforeSuspendOrTerminateHandler=null,Lt.resumeHandler=null;const Bt=Vt.extend("callHandler");function xt(e,t){const n=Lt.handlers[e];if(n){Bt("Invoking the registered handler for message %s with arguments %o",e,t);return[!0,n.apply(this,t)]}return cn.childWindow?($n(e,t),[!1,void 0]):(Bt("Handler for action message %s not found.",e),[!1,void 0])}function Wt(e,t,n,r=!0,i=[]){n?(Lt.handlers[t]=n,r&&yn(e,"registerHandler",[t,...i])):delete Lt.handlers[t]}function Gt(e){delete Lt.handlers[e]}function zt(e){return null!=Lt.handlers[e]}function jt(e,t,n,r,i){n&&Le(ve,...r),i&&i(),Wt(e,t,n)}function qt(e,t){Lt.themeChangeHandler=t,!We(t)&&yn(e,"registerHandler",["themeChange"])}function $t(e){Lt.themeChangeHandler&&Lt.themeChangeHandler(e),cn.childWindow&&$n("themeChange",[e])}function Jt(e,t){Lt.loadHandler=t,!We(t)&&yn(e,"registerHandler",["load"])}function Kt(e){Lt.resumeHandler?Lt.resumeHandler(e):Lt.loadHandler&&Lt.loadHandler(e),cn.childWindow&&$n("load",[e])}function Zt(e,t){Lt.beforeUnloadHandler=t,!We(t)&&yn(e,"registerHandler",["beforeUnload"])}function Qt(){const e=()=>{yn(i(a.V_2,s.HandleBeforeUnload),"readyToUnload",[])};Lt.beforeSuspendOrTerminateHandler?(Lt.beforeSuspendOrTerminateHandler(),cn.childWindow?$n("beforeUnload"):e()):Lt.beforeUnloadHandler&&Lt.beforeUnloadHandler(e)||(cn.childWindow?$n("beforeUnload"):e())}function Xt(e){Lt.beforeSuspendOrTerminateHandler=e,!We(e)&&yn(i(a.V_2,s.RegisterBeforeSuspendOrTerminateHandler),"registerHandler",["beforeUnload"])}function Yt(e){Lt.resumeHandler=e,!We(e)&&yn(i(a.V_2,s.RegisterOnResumeHandler),"registerHandler",["load"])}const en=t("nestedAppAuth"),tn=en.extend("tryPolyfillWithNestedAppAuthBridge");var nn;function rn(e,t,n){var r;const i=tn;if(y.isFramelessWindow)return void i("Cannot polyfill nestedAppAuthBridge as current window is frameless");if(!t)return void i("Cannot polyfill nestedAppAuthBridge as current window does not exist");const o=(()=>{try{return JSON.parse(e)}catch(e){return null}})();if(!o||!(null===(r=o.supports)||void 0===r?void 0:r.nestedAppAuth))return void i("Cannot polyfill nestedAppAuthBridge as current hub does not support nested app auth");const a=t;if(a.nestedAppAuthBridge)return void i("nestedAppAuthBridge already exists on current window, skipping polyfill");const s=an(a,n);s&&(a.nestedAppAuthBridge=s)}!function(e){e.Request="NestedAppAuthRequest",e.Response="NestedAppAuthResponse"}(nn||(nn={}));const on=en.extend("createNestedAppAuthBridge");function an(e,t){const n=on;if(!e)return n("nestedAppAuthBridge cannot be created as current window does not exist"),null;const{onMessage:r,sendPostMessage:i}=t,o=e=>t=>r(t,e);return{addEventListener:(t,r)=>{"message"===t?e.addEventListener(t,o(r)):n(`Event ${t} is not supported by nestedAppAuthBridge`)},postMessage:e=>{const t=(()=>{try{return JSON.parse(e)}catch(e){return null}})();t&&"object"==typeof t&&t.messageType===nn.Request?i(e):n("Unrecognized data format received by app, message being ignored. Message: %o",e)},removeEventListener:(t,n)=>{e.removeEventListener(t,o(n))}}}var sn=function(e,t,n,r){function i(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?n(e.value):i(e.value).then(a,s)}l((r=r.apply(e,t||[])).next())}))};const ln=t("communication");class cn{}class un{}function dn(e,t){if(un.messageListener=e=>sn(this,void 0,void 0,(function*(){return yield Tn(e)})),cn.currentWindow=cn.currentWindow||ce(),cn.parentWindow=cn.currentWindow.parent!==cn.currentWindow.self?cn.currentWindow.parent:cn.currentWindow.opener,cn.topWindow=cn.currentWindow.top,(cn.parentWindow||e)&&cn.currentWindow.addEventListener("message",un.messageListener,!1),!cn.parentWindow){const e=cn.currentWindow;if(!e.nativeInterface)return Promise.reject(new Error("Initialization Failed. No Parent window found."));y.isFramelessWindow=!0,e.onNativeMessage=Vn}try{return cn.parentOrigin="*",wn(t,"initialize",[Oe,he]).then((([e,t,n,r])=>(rn(r,cn.currentWindow,{onMessage:Mn,sendPostMessage:bn}),{context:e,clientType:t,runtimeConfig:n,clientSupportedSDKVersion:r})))}finally{cn.parentOrigin=null}}function fn(){cn.currentWindow&&cn.currentWindow.removeEventListener("message",un.messageListener,!1),cn.currentWindow=null,cn.parentWindow=null,cn.parentOrigin=null,cn.childWindow=null,cn.childOrigin=null,un.parentMessageQueue=[],un.childMessageQueue=[],un.nextMessageId=0,un.callbacks={},un.promiseCallbacks={},un.portCallbacks={}}function pn(e,t,...n){return wn(e,t,n).then((([e])=>e))}function gn(e,t,...n){return wn(e,t,n).then((([e,t])=>{if(!e)throw new Error(t)}))}function hn(e,t,n,...r){return wn(e,t,r).then((([e,t])=>{if(!e)throw new Error(t||n)}))}function mn(e,t,...n){return wn(e,t,n).then((([e,t])=>{if(e)throw e;return t}))}function wn(e,t,n=void 0){if(!o(e))throw Error(`apiVersionTag: ${e} passed in doesn't follow the pattern starting with 'v' followed by digits, then underscore with words, please check.`);return new Promise((r=>{r(Sn(In(e,t,n).id))}))}function Cn(e,t,n=void 0){if(!o(e))throw Error(`apiVersionTag: ${e} passed in doesn't follow the pattern starting with 'v' followed by digits, then underscore with words, please check.`);return vn(In(e,t,n).id)}function vn(e){return new Promise(((t,n)=>{un.portCallbacks[e]=(e,r)=>{e instanceof MessagePort?t(e):n(r&&r.length>0?r[0]:new Error("Host responded without port or error details."))}}))}function Sn(e){return new Promise((t=>{un.promiseCallbacks[e]=t}))}function yn(e,t,n,r){let i;if(n instanceof Function?r=n:n instanceof Array&&(i=n),!o(e))throw Error(`apiVersionTag: ${e} passed in doesn't follow the pattern starting with 'v' followed by digits, then underscore with words, please check.`);const a=In(e,t,i);r&&(un.callbacks[a.id]=r)}un.parentMessageQueue=[],un.childMessageQueue=[],un.topMessageQueue=[],un.nextMessageId=0,un.callbacks={},un.promiseCallbacks={},un.portCallbacks={};const _n=ln.extend("sendNestedAuthRequestToTopWindow");function bn(e){const t=_n,n=cn.topWindow,r=Kn(e);return t("Message %i information: %o",r.id,{actionName:r.func}),Pn(n,r)}const En=ln.extend("sendRequestToTargetWindowHelper");function Pn(e,t){const n=En,r=Wn(e);if(y.isFramelessWindow)cn.currentWindow&&cn.currentWindow.nativeInterface&&(n(`Sending message %i to ${r} via framelessPostMessage interface`,t.id),cn.currentWindow.nativeInterface.framelessPostMessage(JSON.stringify(t)));else{const i=xn(e);e&&i?(n(`Sending message %i to ${r} via postMessage`,t.id),e.postMessage(t,i)):(n(`Adding message %i to ${r} message queue`,t.id),Bn(e).push(t))}return t}const An=ln.extend("sendMessageToParentHelper");function In(e,t,n){const r=An,i=cn.parentWindow,o=Jn(e,t,n);return r("Message %i information: %o",o.id,{actionName:t,args:n}),Pn(i,o)}const Rn=ln.extend("processMessage");function Tn(e){return sn(this,void 0,void 0,(function*(){if(!e||!e.data||"object"!=typeof e.data)return void Rn("Unrecognized message format received by app, message being ignored. Message: %o",e);const t=e.source||e.originalEvent&&e.originalEvent.source,n=e.origin||e.originalEvent&&e.originalEvent.origin;return kn(t,n).then((r=>{r?(Hn(t,n),t===cn.parentWindow?Vn(e):t===cn.childWindow&&Nn(e)):Rn("Message being ignored by app because it is either coming from the current window or a different window with an invalid origin")}))}))}const Fn=ln.extend("processAuthBridgeMessage");function Mn(e,t){var n,r;const i=Fn;if(!e||!e.data||"object"!=typeof e.data)return void i("Unrecognized message format received by app, message being ignored. Message: %o",e);const{args:o}=e.data,[,a]=null!=o?o:[],s=(()=>{try{return JSON.parse(a)}catch(e){return null}})();if(!s||"object"!=typeof s||s.messageType!==nn.Response)return void i("Unrecognized data format received by app, message being ignored. Message: %o",e);const l=e.source||(null===(n=null==e?void 0:e.originalEvent)||void 0===n?void 0:n.source),c=e.origin||(null===(r=null==e?void 0:e.originalEvent)||void 0===r?void 0:r.origin);l?kn(l,c)?(cn.topWindow&&!cn.topWindow.closed&&l!==cn.topWindow||(cn.topWindow=l,cn.topOrigin=c),cn.topWindow&&cn.topWindow.closed&&(cn.topWindow=null,cn.topOrigin=null),zn(cn.topWindow),t(a)):i("Message being ignored by app because it is either coming from the current window or a different window with an invalid origin"):i("Message being ignored by app because it is coming for a target that is null")}const On=ln.extend("shouldProcessMessage");function kn(e,t){return sn(this,void 0,void 0,(function*(){if(cn.currentWindow&&e===cn.currentWindow)return On("Should not process message because it is coming from the current window"),!1;if(cn.currentWindow&&cn.currentWindow.location&&t&&t===cn.currentWindow.location.origin)return!0;{const e=yield Qe(new URL(t));return e||On("Message has an invalid origin of %s",t),e}}))}function Hn(e,t){y.isFramelessWindow||cn.parentWindow&&!cn.parentWindow.closed&&e!==cn.parentWindow?cn.childWindow&&!cn.childWindow.closed&&e!==cn.childWindow||(cn.childWindow=e,cn.childOrigin=t):(cn.parentWindow=e,cn.parentOrigin=t),cn.parentWindow&&cn.parentWindow.closed&&(cn.parentWindow=null,cn.parentOrigin=null),cn.childWindow&&cn.childWindow.closed&&(cn.childWindow=null,cn.childOrigin=null),zn(cn.parentWindow),zn(cn.childWindow)}const Un=ln.extend("handleParentMessage");function Vn(e){const t=Un;if("id"in e.data&&"number"==typeof e.data.id){const n=e.data,r=un.callbacks[n.id];t("Received a response from parent for message %i",n.id),r&&(t("Invoking the registered callback for message %i with arguments %o",n.id,n.args),r.apply(null,[...n.args,n.isPartialResponse]),Ln(e)||(t("Removing registered callback for message %i",n.id),delete un.callbacks[n.id]));const i=un.promiseCallbacks[n.id];i&&(t("Invoking the registered promise callback for message %i with arguments %o",n.id,n.args),i(n.args),t("Removing registered promise callback for message %i",n.id),delete un.promiseCallbacks[n.id]);const o=un.portCallbacks[n.id];if(o){let r;t("Invoking the registered port callback for message %i with arguments %o",n.id,n.args),e.ports&&e.ports[0]instanceof MessagePort&&(r=e.ports[0]),o(r,n.args),t("Removing registered port callback for message %i",n.id),delete un.portCallbacks[n.id]}}else if("func"in e.data&&"string"==typeof e.data.func){const n=e.data;t("Received an action message %s from parent",n.func),xt(n.func,n.args)}else t("Received an unknown message: %O",e)}function Ln(e){return!0===e.data.isPartialResponse}function Nn(e){if("id"in e.data&&"func"in e.data){const t=e.data,[n,r]=xt(t.func,t.args);n&&void 0!==r?qn(t.id,Array.isArray(r)?r:[r]):yn(i(a.V_2,s.Tasks_StartTask),t.func,t.args,((...e)=>{if(cn.childWindow){const n=e.pop();qn(t.id,e,n)}}))}}function Dn(){return cn.topWindow!==cn.parentWindow}function Bn(e){return e===cn.topWindow&&Dn()?un.topMessageQueue:e===cn.parentWindow?un.parentMessageQueue:e===cn.childWindow?un.childMessageQueue:[]}function xn(e){return e===cn.topWindow&&Dn()?cn.topOrigin:e===cn.parentWindow?cn.parentOrigin:e===cn.childWindow?cn.childOrigin:null}function Wn(e){return e===cn.topWindow&&Dn()?"top":e===cn.parentWindow?"parent":e===cn.childWindow?"child":null}const Gn=ln.extend("flushMessageQueue");function zn(e){const t=xn(e),n=Bn(e),r=Wn(e);for(;e&&t&&n.length>0;){const i=n.shift();Gn("Flushing message %i from "+r+" message queue via postMessage.",null==i?void 0:i.id),e.postMessage(i,t)}}function jn(e,t){let n;n=cn.currentWindow.setInterval((()=>{0===Bn(e).length&&(clearInterval(n),t())}),100)}function qn(e,t,n){const r=cn.childWindow,i=Zn(e,t,n),o=xn(r);r&&o&&r.postMessage(i,o)}function $n(e,t){const n=cn.childWindow,r=Qn(e,t),i=xn(n);n&&i?n.postMessage(r,i):Bn(n).push(r)}function Jn(e,t,n){return{id:un.nextMessageId++,func:t,timestamp:Date.now(),args:n||[],apiVersionTag:e}}function Kn(e){return{id:un.nextMessageId++,func:"nestedAppAuth.execute",timestamp:Date.now(),args:[],data:e}}function Zn(e,t,n){return{id:e,args:t||[],isPartialResponse:n}}function Qn(e,t){return{func:e,args:t||[]}}const Xn=a.V_1;var Yn,er,tr,nr;!function(e){function t(){return!(!Le(ve)||!ve.supports.logs)}e.registerGetLogHandler=function(e){if(!We(e)&&Le(ve),!We(e)&&!t())throw z;e?Wt(i(Xn,s.Logs_RegisterLogRequestHandler),"log.request",(()=>{const t=e();yn(i(Xn,s.Logs_Receive),"log.receive",[t])})):Gt("log.request")},e.isSupported=t}(Yn||(Yn={})),function(e){e.fileDownloadStart="fileDownloadStart",e.fileDownloadComplete="fileDownloadComplete"}(er||(er={})),function(e){e.view="view",e.edit="edit",e.editNew="editNew"}(tr||(tr={})),function(e){e.fileOpenPreference="fileOpenPreference",e.theme="theme"}(nr||(nr={}));const rr=a.V_1;function ir(e,t){Le(ve),yn(i(rr,s.PrivateAPIs_UploadCustomApp),"uploadCustomApp",[e],t||Z())}function or(e,t,n){Le(ve),yn(i(rr,s.PrivateAPIs_SendCustomMessage),e,t,n)}function ar(e,t){if(Le(ve),!cn.childWindow)throw new Error("The child window has not yet been initialized or is not present");$n(e,t)}function sr(e,t){Le(ve),Wt(i(rr,s.PrivateAPIs_RegisterCustomHandler),e,((...e)=>t.apply(this,e)))}function lr(e,t){Le(ve),Wt(i(rr,s.PrivateAPIs_RegisterUserSettingsChangeHandler),"userSettingsChange",t,!0,[e])}function cr(e){Le(ve,N.content,N.task);const t=[e.entityId,e.title,e.description,e.type,e.objectUrl,e.downloadUrl,e.webPreviewUrl,e.webEditUrl,e.baseUrl,e.editFile,e.subEntityId,e.viewerAction,e.fileOpenPreference,e.conversationId,e.sizeInBytes];yn(i(rr,s.PrivateAPIs_OpenFilePreview),"openFilePreview",t)}const ur=a.V_1;var dr;!function(e){function t(){return!(!Le(ve)||!ve.supports.conversations)}e.openConversation=function(e){return new Promise((n=>{if(Le(ve,N.content),!t())throw z;const r=gn(i(ur,s.Conversations_OpenConversation),"conversations.openConversation",{title:e.title,subEntityId:e.subEntityId,conversationId:e.conversationId,channelId:e.channelId,entityId:e.entityId});e.onStartConversation&&Wt(i(ur,s.Conversations_RegisterStartConversationHandler),"startConversation",((t,n,r,i)=>{var o;return null===(o=e.onStartConversation)||void 0===o?void 0:o.call(e,{subEntityId:t,conversationId:n,channelId:r,entityId:i})})),e.onCloseConversation&&Wt(i(ur,s.Conversations_RegisterCloseConversationHandler),"closeConversation",((t,n,r,i)=>{var o;return null===(o=e.onCloseConversation)||void 0===o?void 0:o.call(e,{subEntityId:t,conversationId:n,channelId:r,entityId:i})})),n(r)}))},e.closeConversation=function(){if(Le(ve,N.content),!t())throw z;yn(i(ur,s.Conversations_CloseConversation),"conversations.closeConversation"),Gt("startConversation"),Gt("closeConversation")},e.getChatMembers=function(){return new Promise((e=>{if(Le(ve),!t())throw z;e(pn(i(ur,s.Conversations_GetChatMember),"getChatMembers"))}))},e.isSupported=t}(dr||(dr={}));const fr="users";function pr(e,t,n){if(0===e.length)throw new Error("Must have at least one user when creating a chat deep link");const r=`${fr}=`+e.map((e=>encodeURIComponent(e))).join(","),i=void 0===t?"":`&topicName=${encodeURIComponent(t)}`,o=void 0===n?"":`&message=${encodeURIComponent(n)}`;return`${m}://${w}/l/chat/0/0?${r}${i}${o}`}function gr(e,t,n){if(0===e.length)throw new Error("Must have at least one target when creating a call deep link");const r=`${fr}=`+e.map((e=>encodeURIComponent(e))).join(","),i=void 0===t?"":`&withVideo=${encodeURIComponent(t)}`,o=void 0===n?"":`&source=${encodeURIComponent(n)}`;return`${m}://${w}/l/call/0/0?${r}${i}${o}`}function hr(e,t,n,r,i){const o=void 0===e?"":"attendees="+e.map((e=>encodeURIComponent(e))).join(","),a=void 0===t?"":`&startTime=${encodeURIComponent(t)}`,s=void 0===n?"":`&endTime=${encodeURIComponent(n)}`,l=void 0===r?"":`&subject=${encodeURIComponent(r)}`,c=void 0===i?"":`&content=${encodeURIComponent(i)}`;return`${m}://${w}/l/meeting/new?${o}${a}${s}${l}${c}`}function mr(e){if(!e)throw new Error("App ID must be set when creating an app install dialog deep link");return`${m}://${w}/l/app/${encodeURIComponent(e)}`}const wr=a.V_1;var Cr;!function(e){function t(){return!(!Le(ve)||!ve.supports.appInstallDialog)}e.openAppInstallDialog=function(e){return new Promise((n=>{if(Le(ve,N.content,N.sidePanel,N.settings,N.task,N.stage,N.meetingStage),!t())throw new Error("Not supported");const r=i(wr,s.AppInstallDialog_OpenAppInstallDialog);ve.isLegacyTeams?n(gn(r,"executeDeepLink",mr(e.appId))):(yn(r,"appInstallDialog.openAppInstallDialog",[e]),n())}))},e.isSupported=t}(Cr||(Cr={}));const vr=a.V_1,Sr=t("media");var yr;function _r(e,t){if(null==e||null==t||e.length<=0)return null;let n=null,r=1;return e.sort(((e,t)=>e.sequence>t.sequence?1:-1)),e.forEach((e=>{e.sequence==r&&(n=n?new Blob([n,e.file],{type:t}):new Blob([e.file],{type:t}),r++)})),n}function br(e,t){if(null==e||null==t)return null;const n=atob(e.chunk),r=new Array(n.length);for(let e=0;e<n.length;e++)r[e]=n.charCodeAt(e);const i=new Uint8Array(r),o=new Blob([i],{type:t});return{sequence:e.chunkSequence,file:o}}function Er(e){Rr(e)?Be("2.0.2"):Tr(e)?Be(u):Ir(e)&&Be("2.0.4")}function Pr(e){return!(e.mediaType!=yr.MediaType.Video||!e.videoProps||!e.videoProps.videoController)}function Ar(e){return!(null==e||e.maxMediaCount>10)}function Ir(e){var t;return!((null==e?void 0:e.mediaType)!=yr.MediaType.Image||!(null===(t=null==e?void 0:e.imageProps)||void 0===t?void 0:t.imageOutputFormats))}function Rr(e){return!(!e||e.mediaType!=yr.MediaType.VideoAndImage&&!e.videoAndImageProps)}function Tr(e){return!(!e||e.mediaType!=yr.MediaType.Video||!e.videoProps||e.videoProps.isFullScreenMode)}function Fr(e,t,n){return null!=e&&null!=t&&t==yr.FileFormat.ID&&null!=n}function Mr(e){return!(null==e||e.length<=0||e.length>10)}function Or(e){return!e||!(null===e.timeOutIntervalInSec||null!=e.timeOutIntervalInSec&&e.timeOutIntervalInSec<=0||null!=e.timeOutIntervalInSec&&e.timeOutIntervalInSec>60)}function kr(e){if(e){if(e.title&&"string"!=typeof e.title)return!1;if(e.setSelected&&"object"!=typeof e.setSelected)return!1;if(e.openOrgWideSearchInChatOrChannel&&"boolean"!=typeof e.openOrgWideSearchInChatOrChannel)return!1;if(e.singleSelect&&"boolean"!=typeof e.singleSelect)return!1}return!0}!function(e){let t,n,r,o,a,l,c;!function(e){e.Base64="base64",e.ID="id"}(t=e.FileFormat||(e.FileFormat={}));class d{}function p(){return!(!Le(ve)||!ve.supports.permissions)}e.File=d,e.captureImage=function(e){if(!e)throw new Error("[captureImage] Callback cannot be null");if(Le(ve,N.content,N.task),y.isFramelessWindow)if(Ne("1.7.0"))yn(i(vr,s.Media_CaptureImage),"captureImage",e);else{e({errorCode:k.OLD_PLATFORM},[])}else{e({errorCode:k.NOT_SUPPORTED_ON_PLATFORM},[])}},e.hasPermission=function(){if(Le(ve,N.content,N.task),!p())throw z;const e=H.Media;return new Promise((t=>{t(mn(i(vr,s.Media_HasPermission),"permissions.has",e))}))},e.requestPermission=function(){if(Le(ve,N.content,N.task),!p())throw z;const e=H.Media;return new Promise((t=>{t(mn(i(vr,s.Media_RequestPermission),"permissions.request",e))}))};class g extends d{constructor(e){super(),e&&(this.content=e.content,this.format=e.format,this.mimeType=e.mimeType,this.name=e.name,this.preview=e.preview,this.size=e.size)}getMedia(e){if(!e)throw new Error("[get Media] Callback cannot be null");if(Le(ve,N.content,N.task),Ne(f))if(Fr(this.mimeType,this.format,this.content))Ne("2.0.0")?this.getMediaViaCallback(e):this.getMediaViaHandler(e);else{e({errorCode:k.INVALID_ARGUMENTS},new Blob)}else{e({errorCode:k.OLD_PLATFORM},new Blob)}}getMediaViaCallback(e){const t={mediaMimeType:this.mimeType,assembleAttachment:[]},n=[this.content];yn(i(vr,s.Media_GetMedia),"getMedia",n,(function(n){if(e)if(n&&n.error)e(n.error,new Blob);else if(n&&n.mediaChunk)if(n.mediaChunk.chunkSequence<=0){const r=_r(t.assembleAttachment,t.mediaMimeType);e(n.error,null!=r?r:new Blob)}else{const e=br(n.mediaChunk,t.mediaMimeType);e?t.assembleAttachment.push(e):Sr(`Received a null assemble attachment for when decoding chunk sequence ${n.mediaChunk.chunkSequence}; not including the chunk in the assembled file.`)}else e({errorCode:k.INTERNAL_ERROR,message:"data received is null"},new Blob)}))}getMediaViaHandler(e){const t=X(),n={mediaMimeType:this.mimeType,assembleAttachment:[]},r=[t,this.content];this.content&&!We(e)&&yn(i(vr,s.Media_GetMedia),"getMedia",r),Wt(i(vr,s.Media_RegisterGetMediaRequestHandler),"getMedia"+t,(function(r){if(e){const i=JSON.parse(r);if(i.error)e(i.error,new Blob),Gt("getMedia"+t);else if(i.mediaChunk)if(i.mediaChunk.chunkSequence<=0){const r=_r(n.assembleAttachment,n.mediaMimeType);e(i.error,null!=r?r:new Blob),Gt("getMedia"+t)}else{const e=br(i.mediaChunk,n.mediaMimeType);e&&n.assembleAttachment.push(e)}else e({errorCode:k.INTERNAL_ERROR,message:"data received is null"},new Blob),Gt("getMedia"+t)}}))}}e.Media=g;class h{constructor(e){this.controllerCallback=e}notifyEventToHost(e,t){Le(ve,N.content,N.task);try{Be(u)}catch(e){return void(t&&t(e))}const n={mediaType:this.getMediaType(),mediaControllerEvent:e};yn(i(vr,s.Media_Controller),"media.controller",[n],(e=>{t&&t(e)}))}stop(e){this.notifyEventToHost(n.StopRecording,e)}}e.VideoController=class extends h{getMediaType(){return a.Video}notifyEventToApp(e){if(this.controllerCallback)switch(e){case n.StartRecording:if(this.controllerCallback.onRecordingStarted){this.controllerCallback.onRecordingStarted();break}}}},function(e){e[e.StartRecording=1]="StartRecording",e[e.StopRecording=2]="StopRecording"}(n=e.MediaControllerEvent||(e.MediaControllerEvent={})),function(e){e[e.Photo=1]="Photo",e[e.Document=2]="Document",e[e.Whiteboard=3]="Whiteboard",e[e.BusinessCard=4]="BusinessCard"}(r=e.CameraStartMode||(e.CameraStartMode={})),function(e){e[e.Camera=1]="Camera",e[e.Gallery=2]="Gallery"}(o=e.Source||(e.Source={})),function(e){e[e.Image=1]="Image",e[e.Video=2]="Video",e[e.VideoAndImage=3]="VideoAndImage",e[e.Audio=4]="Audio"}(a=e.MediaType||(e.MediaType={})),function(e){e[e.ID=1]="ID",e[e.URL=2]="URL"}(l=e.ImageUriType||(e.ImageUriType={})),function(e){e[e.IMAGE=1]="IMAGE",e[e.PDF=2]="PDF"}(c=e.ImageOutputFormats||(e.ImageOutputFormats={})),e.selectMedia=function(e,t){if(!t)throw new Error("[select Media] Callback cannot be null");if(Le(ve,N.content,N.task),!Ne(f)){const e={errorCode:k.OLD_PLATFORM};return void t(e,[])}try{Er(e)}catch(e){return void t(e,[])}if(!Ar(e)){const e={errorCode:k.INVALID_ARGUMENTS};return void t(e,[])}const n=[e];yn(i(vr,s.Media_SelectMedia),"selectMedia",n,((n,r,i)=>{var o,a;if(i)return void(Pr(e)&&(null===(a=null===(o=null==e?void 0:e.videoProps)||void 0===o?void 0:o.videoController)||void 0===a||a.notifyEventToApp(i)));if(!r)return void t(n,[]);const s=[];for(const e of r)s.push(new g(e));t(n,s)}))},e.viewImages=function(e,t){if(!t)throw new Error("[view images] Callback cannot be null");if(Le(ve,N.content,N.task),!Ne(f)){return void t({errorCode:k.OLD_PLATFORM})}if(!Mr(e)){return void t({errorCode:k.INVALID_ARGUMENTS})}const n=[e];yn(i(vr,s.Media_ViewImages),"viewImages",n,t)},e.scanBarCode=function(e,t){if(!e)throw new Error("[media.scanBarCode] Callback cannot be null");if(Le(ve,N.content,N.task),y.hostClientType!==V.desktop&&y.hostClientType!==V.web&&y.hostClientType!==V.rigel&&y.hostClientType!==V.teamsRoomsWindows&&y.hostClientType!==V.teamsRoomsAndroid&&y.hostClientType!==V.teamsPhones&&y.hostClientType!==V.teamsDisplays)if(Ne("1.9.0"))if(Or(t))yn(i(vr,s.Media_ScanBarCode),"media.scanBarCode",[t],e);else{e({errorCode:k.INVALID_ARGUMENTS},"")}else{e({errorCode:k.OLD_PLATFORM},"")}else{e({errorCode:k.NOT_SUPPORTED_ON_PLATFORM},"")}}}(yr||(yr={}));const Hr=a.V_2;var Ur;!function(e){function t(){return!!(Le(ve)&&ve.supports.barCode&&ve.supports.permissions)}e.scanBarCode=function(e){return new Promise((n=>{if(Le(ve,N.content,N.task),!t())throw z;if(!Or(e))throw{errorCode:k.INVALID_ARGUMENTS};n(mn(i(Hr,s.BarCode_ScanBarCode),"media.scanBarCode",e))}))},e.hasPermission=function(){if(Le(ve,N.content,N.task),!t())throw z;const e=H.Media;return new Promise((t=>{t(mn(i(Hr,s.BarCode_HasPermission),"permissions.has",e))}))},e.requestPermission=function(){if(Le(ve,N.content,N.task),!t())throw z;const e=H.Media;return new Promise((t=>{t(mn(i(Hr,s.BarCode_RequestPermission),"permissions.request",e))}))},e.isSupported=t}(Ur||(Ur={}));const Vr=a.V_2;var Lr;!function(e){function t(e,t){return new Promise((r=>{if(Le(ve,N.content,N.task),!n())throw z;if(ve.isLegacyTeams)r(gn(e,"executeDeepLink",pr([t.user],void 0,t.message)));else{r(gn(e,"chat.openChat",{members:[t.user],message:t.message}))}}))}function n(){return!(!Le(ve)||!ve.supports.chat)}e.openChat=function(e){return t(i(Vr,s.Chat_OpenChat),e)},e.openGroupChat=function(e){const r=i(Vr,s.Chat_OpenGroupChat);return new Promise((i=>{if(e.users.length<1)throw Error("OpenGroupChat Failed: No users specified");if(1===e.users.length){const n={user:e.users[0],message:e.message};i(t(r,n))}else{if(Le(ve,N.content,N.task),!n())throw z;if(ve.isLegacyTeams)i(gn(r,"executeDeepLink",pr(e.users,e.topic,e.message)));else{i(gn(r,"chat.openChat",{members:e.users,message:e.message,topic:e.topic}))}}}))},e.isSupported=n}(Lr||(Lr={}));var Nr=function(e,t,n,r){function i(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?n(e.value):i(e.value).then(a,s)}l((r=r.apply(e,t||[])).next())}))};const Dr=a.V_2;var Br;!function(e){function t(){return!!(Le(ve)&&navigator&&navigator.clipboard&&ve.supports.clipboard)}e.write=function(e){return Nr(this,void 0,void 0,(function*(){if(Le(ve,N.content,N.meetingStage,N.task,N.settings,N.stage,N.sidePanel),!t())throw z;if(!e.type||!Object.values(U).includes(e.type))throw new Error(`Blob type ${e.type} is not supported. Supported blob types are ${Object.values(U)}`);const n=yield le(e),r={mimeType:e.type,content:n};return mn(i(Dr,s.Clipboard_Write),"clipboard.writeToClipboard",r)}))},e.read=function(){return Nr(this,void 0,void 0,(function*(){Le(ve,N.content,N.meetingStage,N.task,N.settings,N.stage,N.sidePanel);const e=i(Dr,s.Clipboard_Read);if(!t())throw z;if(De()||y.hostClientType===V.macos){const t=JSON.parse(yield mn(e,"clipboard.readFromClipboard"));return se(t.mimeType,t.content)}return mn(e,"clipboard.readFromClipboard")}))},e.isSupported=t}(Br||(Br={}));const xr=a.V_2;var Wr;function Gr(){return ve.hostVersionsInfo?ve.hostVersionsInfo.adaptiveCardSchemaVersion:void 0}!function(e){function t(){return!!(Le(ve)&&ve.supports.geoLocation&&ve.supports.permissions)}let n;e.getCurrentLocation=function(){if(Le(ve,N.content,N.task),!t())throw z;return mn(i(xr,s.GeoLocation_GetCurrentLocation),"location.getLocation",{allowChooseLocation:!1,showMap:!1})},e.hasPermission=function(){if(Le(ve,N.content,N.task),!t())throw z;const e=H.GeoLocation;return new Promise((t=>{t(mn(i(xr,s.GeoLocation_HasPermission),"permissions.has",e))}))},e.requestPermission=function(){if(Le(ve,N.content,N.task),!t())throw z;const e=H.GeoLocation;return new Promise((t=>{t(mn(i(xr,s.GeoLocation_RequestPermission),"permissions.request",e))}))},e.isSupported=t,function(e){function t(){return!!(Le(ve)&&ve.supports.geoLocation&&ve.supports.geoLocation.map&&ve.supports.permissions)}e.chooseLocation=function(){if(Le(ve,N.content,N.task),!t())throw z;return mn(i(xr,s.GeoLocation_Map_ChooseLocation),"location.getLocation",{allowChooseLocation:!0,showMap:!0})},e.showLocation=function(e){if(Le(ve,N.content,N.task),!t())throw z;if(!e)throw{errorCode:k.INVALID_ARGUMENTS};return mn(i(xr,s.GeoLocation_ShowLocation),"location.showLocation",e)},e.isSupported=t}(n=e.map||(e.map={}))}(Wr||(Wr={}));const zr=a.V_1;class jr{postMessage(e,t){Le(ve),yn(i(zr,s.AppWindow_ChildAppWindow_PostMessage),"messageForChild",[e],t||Z())}addEventListener(e,t){Le(ve),"message"===e&&Wt(i(zr,s.AppWindow_ChildAppWindow_AddEventListener),"messageForParent",t)}}class qr{static get Instance(){return this._instance||(this._instance=new this)}postMessage(e,t){Le(ve,N.task),yn(i(zr,s.AppWindow_ParentAppWindow_PostMessage),"messageForParent",[e],t||Z())}addEventListener(e,t){Le(ve,N.task),"message"===e&&Wt(i(zr,s.AppWindow_ParentAppWindow_AddEventListener),"messageForChild",t)}}const $r=a.V_2;var Jr;!function(e){function t(){return!(!Le(ve)||!ve.supports.secondaryBrowser)}e.open=function(e){if(Le(ve,N.content),!t())throw z;if(!e||!ae(e))throw{errorCode:k.INVALID_ARGUMENTS,message:"Invalid Url: Only https URL is allowed"};return mn(i($r,s.SecondaryBrowser_OpenUrl),"secondaryBrowser.open",e.toString())},e.isSupported=t}(Jr||(Jr={}));const Kr=a.V_1;var Zr;!function(e){function t(){return!(!Le(ve)||!ve.supports.location)}e.getLocation=function(e,n){if(!n)throw new Error("[location.getLocation] Callback cannot be null");if(Le(ve,N.content,N.task),!Ne(d))throw{errorCode:k.OLD_PLATFORM};if(!e)throw{errorCode:k.INVALID_ARGUMENTS};if(!t())throw z;yn(i(Kr,s.Location_GetLocation),"location.getLocation",[e],n)},e.showLocation=function(e,n){if(!n)throw new Error("[location.showLocation] Callback cannot be null");if(Le(ve,N.content,N.task),!Ne(d))throw{errorCode:k.OLD_PLATFORM};if(!e)throw{errorCode:k.INVALID_ARGUMENTS};if(!t())throw z;yn(i(Kr,s.Location_ShowLocation),"location.showLocation",[e],n)},e.isSupported=t}(Zr||(Zr={}));var Qr=function(e,t,n,r){function i(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?n(e.value):i(e.value).then(a,s)}l((r=r.apply(e,t||[])).next())}))};const Xr=a.V_1;var Yr;!function(e){let t,n,r,o,l,c,u;function d(e,n){yn(i(Xr,s.Meeting_RequestAppAudioHandling),"meeting.requestAppAudioHandling",[e.isAppHandlingAudio],((r,o)=>{if(r&&null!=o)throw new Error("[requestAppAudioHandling] Callback response - both parameters cannot be set");if(r)throw new Error(`[requestAppAudioHandling] Callback response - SDK error ${r.errorCode} ${r.message}`);if("boolean"!=typeof o)throw new Error("[requestAppAudioHandling] Callback response - isHostAudioless must be a boolean");Wt(i(Xr,s.Meeting_RegisterMicStateChangeHandler),"meeting.micStateChanged",(n=>Qr(this,void 0,void 0,(function*(){try{const r=yield e.micMuteStateChangedCallback(n);p(r,r.isMicMuted===n.isMicMuted?t.HostInitiated:t.AppDeclinedToChange)}catch(e){p(n,t.AppFailedToChange)}}))));Wt(i(Xr,s.Meeting_RegisterAudioDeviceSelectionChangedHandler),"meeting.audioDeviceSelectionChanged",(t=>{var n;null===(n=e.audioDeviceSelectionChangedCallback)||void 0===n||n.call(e,t)})),n(o)}))}function f(e,t){yn(i(Xr,s.Meeting_RequestAppAudioHandling),"meeting.requestAppAudioHandling",[e.isAppHandlingAudio],((e,n)=>{if(e&&null!=n)throw new Error("[requestAppAudioHandling] Callback response - both parameters cannot be set");if(e)throw new Error(`[requestAppAudioHandling] Callback response - SDK error ${e.errorCode} ${e.message}`);if("boolean"!=typeof n)throw new Error("[requestAppAudioHandling] Callback response - isHostAudioless must be a boolean");zt("meeting.micStateChanged")&&Gt("meeting.micStateChanged"),zt("meeting.audioDeviceSelectionChanged")&&Gt("meeting.audioDeviceSelectionChanged"),t(n)}))}function p(e,t){Le(ve,N.sidePanel,N.meetingStage),yn(i(Xr,s.Meeting_SetMicStateWithReason),"meeting.updateMicState",[e,t])}!function(e){e[e.HostInitiated=0]="HostInitiated",e[e.AppInitiated=1]="AppInitiated",e[e.AppDeclinedToChange=2]="AppDeclinedToChange",e[e.AppFailedToChange=3]="AppFailedToChange"}(t||(t={})),function(e){e.like="like",e.heart="heart",e.laugh="laugh",e.surprised="surprised",e.applause="applause"}(n=e.MeetingReactionType||(e.MeetingReactionType={})),function(e){e.Unknown="Unknown",e.Adhoc="Adhoc",e.Scheduled="Scheduled",e.Recurring="Recurring",e.Broadcast="Broadcast",e.MeetNow="MeetNow"}(r=e.MeetingType||(e.MeetingType={})),function(e){e.OneOnOneCall="oneOnOneCall",e.GroupCall="groupCall"}(o=e.CallType||(e.CallType={})),function(e){e.Collaborative="Collaborative",e.ScreenShare="ScreenShare"}(l=e.SharingProtocol||(e.SharingProtocol={})),e.getIncomingClientAudioState=function(e){if(!e)throw new Error("[get incoming client audio state] Callback cannot be null");Le(ve,N.sidePanel,N.meetingStage),yn(i(Xr,s.Meeting_GetIncomingClientAudioState),"getIncomingClientAudioState",e)},e.toggleIncomingClientAudio=function(e){if(!e)throw new Error("[toggle incoming client audio] Callback cannot be null");Le(ve,N.sidePanel,N.meetingStage),yn(i(Xr,s.Meeting_ToggleIncomingClientAudio),"toggleIncomingClientAudio",e)},e.getMeetingDetails=function(e){if(!e)throw new Error("[get meeting details] Callback cannot be null");Le(ve,N.sidePanel,N.meetingStage,N.settings,N.content),yn(i(Xr,s.Meeting_GetMeetingDetails),"meeting.getMeetingDetails",e)},e.getAuthenticationTokenForAnonymousUser=function(e){if(!e)throw new Error("[get Authentication Token For AnonymousUser] Callback cannot be null");Le(ve,N.sidePanel,N.meetingStage,N.task),yn(i(Xr,s.Meeting_GetAuthenticationTokenForAnonymousUser),"meeting.getAuthenticationTokenForAnonymousUser",e)},e.getLiveStreamState=function(e){if(!e)throw new Error("[get live stream state] Callback cannot be null");Le(ve,N.sidePanel),yn(i(Xr,s.Meeting_GetLiveStreamState),"meeting.getLiveStreamState",e)},e.requestStartLiveStreaming=function(e,t,n){if(!e)throw new Error("[request start live streaming] Callback cannot be null");Le(ve,N.sidePanel),yn(i(Xr,s.Meeting_RequestStartLiveStreaming),"meeting.requestStartLiveStreaming",[t,n],e)},e.requestStopLiveStreaming=function(e){if(!e)throw new Error("[request stop live streaming] Callback cannot be null");Le(ve,N.sidePanel),yn(i(Xr,s.Meeting_RequestStopLiveStreaming),"meeting.requestStopLiveStreaming",e)},e.registerLiveStreamChangedHandler=function(e){if(!e)throw new Error("[register live stream changed handler] Handler cannot be null");Le(ve,N.sidePanel),Wt(i(Xr,s.Meeting_RegisterLiveStreamChangedHandler),"meeting.liveStreamChanged",e)},e.shareAppContentToStage=function(e,t,n={sharingProtocol:l.Collaborative}){if(!e)throw new Error("[share app content to stage] Callback cannot be null");Le(ve,N.sidePanel,N.meetingStage),yn(i(Xr,s.Meeting_ShareAppContentToStage),"meeting.shareAppContentToStage",[t,n],e)},e.getAppContentStageSharingCapabilities=function(e){if(!e)throw new Error("[get app content stage sharing capabilities] Callback cannot be null");Le(ve,N.sidePanel,N.meetingStage),yn(i(Xr,s.Meeting_GetAppContentStageSharingCapabilities),"meeting.getAppContentStageSharingCapabilities",e)},e.stopSharingAppContentToStage=function(e){if(!e)throw new Error("[stop sharing app content to stage] Callback cannot be null");Le(ve,N.sidePanel,N.meetingStage),yn(i(Xr,s.Meeting_StopSharingAppContentToStage),"meeting.stopSharingAppContentToStage",e)},e.getAppContentStageSharingState=function(e){if(!e)throw new Error("[get app content stage sharing state] Callback cannot be null");Le(ve,N.sidePanel,N.meetingStage),yn(i(Xr,s.Meeting_GetAppContentStageSharingState),"meeting.getAppContentStageSharingState",e)},e.registerSpeakingStateChangeHandler=function(e){if(!e)throw new Error("[registerSpeakingStateChangeHandler] Handler cannot be null");Le(ve,N.sidePanel,N.meetingStage),Wt(i(Xr,s.Meeting_RegisterSpeakingStateChangeHandler),"meeting.speakingStateChanged",e)},e.registerRaiseHandStateChangedHandler=function(e){if(!e)throw new Error("[registerRaiseHandStateChangedHandler] Handler cannot be null");Le(ve,N.sidePanel,N.meetingStage),Wt(i(Xr,s.Meeting_RegisterRaiseHandStateChangedHandler),"meeting.raiseHandStateChanged",e)},e.registerMeetingReactionReceivedHandler=function(e){if(!e)throw new Error("[registerMeetingReactionReceivedHandler] Handler cannot be null");Le(ve,N.sidePanel,N.meetingStage),Wt(i(Xr,s.Meeting_RegisterMeetingReactionReceivedHandler),"meeting.meetingReactionReceived",e)},e.joinMeeting=function(e){if(void 0===(null==e?void 0:e.joinWebUrl)||null===(null==e?void 0:e.joinWebUrl))return Promise.reject(new Error("Invalid joinMeetingParams"));Le(ve);const t={joinWebUrl:e.joinWebUrl.href,source:e.source||c.Other};return mn(i(a.V_2,s.Meeting_JoinMeeting),"meeting.joinMeeting",t)},function(e){e.M365CalendarGridContextMenu="m365_calendar_grid_context_menu",e.M365CalendarGridPeek="m365_calendar_grid_peek",e.M365CalendarGridEventCardJoinButton="m365_calendar_grid_event_card_join_button",e.M365CalendarFormRibbonJoinButton="m365_calendar_form_ribbon_join_button",e.M365CalendarFormJoinTeamsMeetingButton="m365_calendar_form_join_teams_meeting_button",e.Other="other"}(c=e.EventActionSource||(e.EventActionSource={})),function(e){e.setOptions=function(e){Le(ve,N.sidePanel),e.contentUrl&&new URL(e.contentUrl),yn(i(Xr,s.Meeting_AppShareButton_SetOptions),"meeting.appShareButton.setOptions",[e])}}(u=e.appShareButton||(e.appShareButton={})),e.requestAppAudioHandling=function(e,t){if(!t)throw new Error("[requestAppAudioHandling] Callback response cannot be null");if(!e.micMuteStateChangedCallback)throw new Error("[requestAppAudioHandling] Callback Mic mute state handler cannot be null");Le(ve,N.sidePanel,N.meetingStage),e.isAppHandlingAudio?d(e,t):f(e,t)},e.updateMicState=function(e){p(e,t.AppInitiated)}}(Yr||(Yr={}));const ei=a.V_1,ti=a.V_2;var ni;!function(e){function t(){return!(!Le(ve)||!ve.supports.monetization)}e.openPurchaseExperience=function(e,n){let r,o,a="";return"function"==typeof e?(r=e,o=n,a=i(ei,s.Monetization_OpenPurchaseExperience)):(o=e,a=i(ti,s.Monetization_OpenPurchaseExperience)),Le(ve,N.content),ne((()=>new Promise((e=>{if(!t())throw z;e(mn(a,"monetization.openPurchaseExperience",o))}))),r)},e.isSupported=t}(ni||(ni={}));const ri=a.V_2;var ii;!function(e){function t(){return!(!Le(ve)||!ve.supports.calendar)}e.openCalendarItem=function(e){return new Promise((n=>{if(Le(ve,N.content),!t())throw new Error("Not supported");if(!e.itemId||!e.itemId.trim())throw new Error("Must supply an itemId to openCalendarItem");n(gn(i(ri,s.Calendar_OpenCalendarItem),"calendar.openCalendarItem",e))}))},e.composeMeeting=function(e){return new Promise((n=>{if(Le(ve,N.content),!t())throw new Error("Not supported");const r=i(ri,s.Calendar_ComposeMeeting);ve.isLegacyTeams?n(gn(r,"executeDeepLink",hr(e.attendees,e.startTime,e.endTime,e.subject,e.content))):n(gn(r,"calendar.composeMeeting",e))}))},e.isSupported=t}(ii||(ii={}));const oi=a.V_2;var ai;!function(e){function t(){return!(!Le(ve)||!ve.supports.mail)}let n;e.openMailItem=function(e){return new Promise((n=>{if(Le(ve,N.content),!t())throw new Error("Not supported");if(!e.itemId||!e.itemId.trim())throw new Error("Must supply an itemId to openMailItem");n(gn(i(oi,s.Mail_OpenMailItem),"mail.openMailItem",e))}))},e.composeMail=function(e){return new Promise((n=>{if(Le(ve,N.content),!t())throw new Error("Not supported");n(gn(i(oi,s.Mail_ComposeMail),"mail.composeMail",e))}))},e.isSupported=t,function(e){e.New="new",e.Reply="reply",e.ReplyAll="replyAll",e.Forward="forward"}(n=e.ComposeMailType||(e.ComposeMailType={}))}(ai||(ai={}));const si=a.V_2;var li;!function(e){function t(){ce().print()}function n(e,t,n){!We(t)&&Le(ve),!We(t)&&n&&n(),Jt(e,t)}function r(e,t,n){!We(t)&&Le(ve),!We(t)&&n&&n(),Zt(e,t)}function o(){return!(!Le(ve)||!ve.supports.teamsCore)}e.enablePrintCapability=function(){if(!y.printCapabilityEnabled){if(Le(ve),!o())throw z;y.printCapabilityEnabled=!0,document.addEventListener("keydown",(e=>{(e.ctrlKey||e.metaKey)&&80===e.keyCode&&(t(),e.cancelBubble=!0,e.preventDefault(),e.stopImmediatePropagation())}))}},e.print=t,e.registerOnLoadHandler=function(e){n(i(si,s.TeamsAPIs_RegisterOnLoadHandler),e,(()=>{if(!We(e)&&!o())throw z}))},e.registerOnLoadHandlerHelper=n,e.registerBeforeUnloadHandler=function(e){r(i(si,s.TeamsAPIs_RegisterBeforeUnloadHandler),e,(()=>{if(!We(e)&&!o())throw z}))},e.registerBeforeUnloadHandlerHelper=r,e.isSupported=o}(li||(li={}));const ci=a.V_1,ui=a.V_2;var di;function fi(e){return e?e.modality&&"string"!=typeof e.modality?[!1,"modality must be a string"]:e.targetElementBoundingRect&&"object"==typeof e.targetElementBoundingRect?e.triggerType&&"string"==typeof e.triggerType?pi(e.persona):[!1,"triggerType must be a valid string"]:[!1,"targetElementBoundingRect must be a DOMRect"]:[!1,"A request object is required"]}function pi(e){return e?e.displayName&&"string"!=typeof e.displayName?[!1,"displayName must be a string"]:e.identifiers&&"object"==typeof e.identifiers?e.identifiers.AadObjectId||e.identifiers.Smtp||e.identifiers.Upn?e.identifiers.AadObjectId&&"string"!=typeof e.identifiers.AadObjectId?[!1,"AadObjectId identifier must be a string"]:e.identifiers.Smtp&&"string"!=typeof e.identifiers.Smtp?[!1,"Smtp identifier must be a string"]:e.identifiers.Upn&&"string"!=typeof e.identifiers.Upn?[!1,"Upn identifier must be a string"]:[!0,void 0]:[!1,"at least one valid identifier must be provided"]:[!1,"persona identifiers object must be provided"]:[!1,"persona object must be provided"]}!function(e){function t(e,t){return new Promise((r=>{if(!Ne("2.0.0"))throw{errorCode:k.OLD_PLATFORM};if(!kr(t))throw{errorCode:k.INVALID_ARGUMENTS};if(!n())throw z;r(mn(e,"people.selectPeople",t))}))}function n(){return!(!Le(ve)||!ve.supports.people)}e.selectPeople=function(e,n){let r,o;Le(ve,N.content,N.task,N.settings);let a="";return"function"==typeof e?([r,o]=[e,n],a=i(ci,s.People_SelectPeople)):(o=e,a=i(ui,s.People_SelectPeople)),ee(t,r,a,o)},e.isSupported=n}(di||(di={}));const gi=a.V_2;var hi;!function(e){e.showProfile=function(e){return Le(ve,N.content),new Promise((t=>{const[n,r]=fi(e);if(!n)throw{errorCode:k.INVALID_ARGUMENTS,message:r};const o={modality:e.modality,persona:e.persona,triggerType:e.triggerType,targetRectangle:{x:e.targetElementBoundingRect.x,y:e.targetElementBoundingRect.y,width:e.targetElementBoundingRect.width,height:e.targetElementBoundingRect.height}};t(mn(i(gi,s.Profile_ShowProfile),"profile.showProfile",o))}))},e.isSupported=function(){return!(!Le(ve)||!ve.supports.profile)}}(hi||(hi={}));var mi=function(e,t,n,r){function i(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?n(e.value):i(e.value).then(a,s)}l((r=r.apply(e,t||[])).next())}))};const wi=a.V_2;function Ci(e,t,n,r){var i,o;return mi(this,void 0,void 0,(function*(){const a=yi();!ue()&&(null===(o=null===(i=window.chrome)||void 0===i?void 0:i.webview)||void 0===o||o.registerTextureStream(e,a)),_i(yield Si(e,n,r),new Ei(n,t),a.writable)}))}function vi(e,t,n,r){var i,o;return mi(this,void 0,void 0,(function*(){const a=yi();!ue()&&(null===(o=null===(i=window.chrome)||void 0===i?void 0:i.webview)||void 0===o||o.registerTextureStream(e,a)),_i(yield Si(e,n,r),new Ii(n,t),a.writable)}))}function Si(e,t,n){return mi(this,void 0,void 0,(function*(){if(ue())throw z;const r=ce().chrome;try{null==n||n.reportGettingTextureStream(e);const t=(yield r.webview.getTextureStream(e)).getVideoTracks();if(0===t.length)throw new Error(`No video track in stream ${e}`);return null==n||n.reportTextureStreamAcquired(),t[0]}catch(n){throw t(`Failed to get video track from stream ${e}, error: ${n}`),new Error(`Internal error: can't get video track from stream ${e}`)}}))}function yi(){if(ue())throw z;const e=window.MediaStreamTrackGenerator;if(!e)throw z;return new e({kind:"video"})}function _i(e,t,n){new(0,ce().MediaStreamTrackProcessor)({track:e}).readable.pipeThrough(new TransformStream(t)).pipeTo(n)}var bi;!function(e){e.TimestampIsNull="timestamp of the original video frame is null",e.UnsupportedVideoFramePixelFormat="Unsupported video frame pixel format"}(bi||(bi={}));class Ei{constructor(e,t){this.notifyError=e,this.videoFrameHandler=t,this.transform=(e,t)=>mi(this,void 0,void 0,(function*(){const n=e.timestamp;if(null!==n)try{const r=yield this.videoFrameHandler({videoFrame:e}),i=new VideoFrame(r,{timestamp:n});t.enqueue(i),e.close(),r.close()}catch(t){e.close(),this.notifyError(t)}else this.notifyError(bi.TimestampIsNull)}))}}class Pi{constructor(e,t){if(this.headerBuffer=e,this.notifyError=t,this.ONE_TEXTURE_INPUT_ID=1869900081,this.INVALID_HEADER_ERROR="Invalid video frame header",this.UNSUPPORTED_LAYOUT_ERROR="Unsupported texture layout",this.headerDataView=new Uint32Array(e),this.headerDataView.length<8)throw this.notifyError(this.INVALID_HEADER_ERROR),new Error(this.INVALID_HEADER_ERROR);if(this.headerDataView[0]!==this.ONE_TEXTURE_INPUT_ID)throw this.notifyError(this.UNSUPPORTED_LAYOUT_ERROR),new Error(this.UNSUPPORTED_LAYOUT_ERROR)}get oneTextureLayoutId(){return this.headerDataView[0]}get version(){return this.headerDataView[1]}get frameRowOffset(){return this.headerDataView[2]}get frameFormat(){return this.headerDataView[3]}get frameWidth(){return this.headerDataView[4]}get frameHeight(){return this.headerDataView[5]}get multiStreamHeaderRowOffset(){return this.headerDataView[6]}get multiStreamCount(){return this.headerDataView[7]}}class Ai{constructor(e,t){this.metadataMap=new Map,this.AUDIO_INFERENCE_RESULT_STREAM_ID=828664161;const n=new Uint32Array(e);for(let r=0,i=0;r<t;r++){const t=n[i++],r=n[i++],o=n[i++],a=new Uint8Array(e,r,o);this.metadataMap.set(t,a)}}get audioInferenceResult(){return this.metadataMap.get(this.AUDIO_INFERENCE_RESULT_STREAM_ID)}}class Ii{constructor(e,t){this.notifyError=e,this.videoFrameHandler=t,this.shouldDiscardAudioInferenceResult=!1,this.transform=(e,t)=>mi(this,void 0,void 0,(function*(){const n=e.timestamp;if(null!==n)try{const{videoFrame:r,metadata:{audioInferenceResult:i}={}}=yield this.extractVideoFrameAndMetadata(e),o=yield this.videoFrameHandler({videoFrame:r,audioInferenceResult:i}),a=new VideoFrame(o,{timestamp:n});t.enqueue(a),r.close(),e.close(),o.close()}catch(t){e.close(),this.notifyError(t)}else this.notifyError(bi.TimestampIsNull)})),this.extractVideoFrameAndMetadata=e=>mi(this,void 0,void 0,(function*(){if(ue())throw z;if("NV12"!==e.format)throw this.notifyError(bi.UnsupportedVideoFramePixelFormat),new Error(bi.UnsupportedVideoFramePixelFormat);const t={x:0,y:0,width:e.codedWidth,height:2},n=new ArrayBuffer(t.width*t.height*3/2);yield e.copyTo(n,{rect:t});const r=new Pi(n,this.notifyError),i={x:0,y:r.multiStreamHeaderRowOffset,width:e.codedWidth,height:e.codedHeight-r.multiStreamHeaderRowOffset},o=new ArrayBuffer(i.width*i.height*3/2);yield e.copyTo(o,{rect:i});const a=new Ai(o,r.multiStreamCount);return{videoFrame:new VideoFrame(e,{timestamp:e.timestamp,visibleRect:{x:0,y:r.frameRowOffset,width:r.frameWidth,height:r.frameHeight}}),metadata:{audioInferenceResult:this.shouldDiscardAudioInferenceResult?void 0:a.audioInferenceResult}}})),Wt(i(wi,s.VideoEffectsUtils_TransformerWithMetadata_Constructor),"video.mediaStream.audioInferenceDiscardStatusChange",(({discardAudioInferenceResult:e})=>{this.shouldDiscardAudioInferenceResult=e}))}}function Ri(e,t){return(n,r)=>{null==t||t.reportApplyingVideoEffect(n||"",r),e(n,r).then((()=>{null==t||t.reportVideoEffectChanged(n||"",r),yn(i(wi,s.VideoEffectsUtils_ReportVideoEffectChanged),"video.videoEffectReadiness",[!0,n,void 0,r])})).catch((e=>{const t=e in Vi.EffectFailureReason?e:Vi.EffectFailureReason.InitializationFailure;yn(i(wi,s.VideoEffectsUtils_EffectFailure),"video.videoEffectReadiness",[!1,n,t,r])}))}}class Ti{static setTimeout(e,t){const n=performance.now(),r=X();return Ti.setTimeoutCallbacks[r]={callback:e,timeoutInMs:t,startedAtInMs:n},r}static clearTimeout(e){delete Ti.setTimeoutCallbacks[e]}static setInterval(e,t){Ti.setTimeout((function n(){e(),Ti.setTimeout(n,t)}),t)}static tick(){const e=performance.now(),t=[];for(const n in Ti.setTimeoutCallbacks){const r=Ti.setTimeoutCallbacks[n];e-r.startedAtInMs>=r.timeoutInMs&&t.push(n)}for(const e of t){Ti.setTimeoutCallbacks[e].callback(),delete Ti.setTimeoutCallbacks[e]}}}Ti.setTimeoutCallbacks={};class Fi{constructor(e,t){this.reportStatisticsResult=t,this.sampleCount=0,this.distributionBins=new Uint32Array(e)}processStarts(e,t,n,r){Ti.tick(),this.suitableForThisSession(e,t,n,r)||this.reportAndResetSession(this.getStatistics(),e,r,t,n),this.start()}processEnds(){const e=performance.now()-this.frameProcessingStartedAt,t=Math.floor(Math.max(0,Math.min(this.distributionBins.length-1,e)));this.distributionBins[t]+=1,this.sampleCount+=1}getStatistics(){return this.currentSession?{effectId:this.currentSession.effectId,effectParam:this.currentSession.effectParam,frameHeight:this.currentSession.frameHeight,frameWidth:this.currentSession.frameWidth,duration:performance.now()-this.currentSession.startedAtInMs,sampleCount:this.sampleCount,distributionBins:this.distributionBins.slice()}:null}start(){this.frameProcessingStartedAt=performance.now()}suitableForThisSession(e,t,n,r){return this.currentSession&&this.currentSession.effectId===e&&this.currentSession.effectParam===r&&this.currentSession.frameWidth===t&&this.currentSession.frameHeight===n}reportAndResetSession(e,t,n,r,i){e&&this.reportStatisticsResult(e),this.resetCurrentSession(this.getNextTimeout(t,this.currentSession),t,n,r,i),this.timeoutId&&Ti.clearTimeout(this.timeoutId),this.timeoutId=Ti.setTimeout((()=>this.reportAndResetSession(this.getStatistics(),t,n,r,i)).bind(this),this.currentSession.timeoutInMs)}resetCurrentSession(e,t,n,r,i){this.currentSession={startedAtInMs:performance.now(),timeoutInMs:e,effectId:t,effectParam:n,frameWidth:r,frameHeight:i},this.sampleCount=0,this.distributionBins.fill(0)}getNextTimeout(e,t){return t&&t.effectId===e?Math.min(Fi.maxSessionTimeoutInMs,2*t.timeoutInMs):Fi.initialSessionTimeoutInMs}}Fi.initialSessionTimeoutInMs=1e3,Fi.maxSessionTimeoutInMs=3e4;const Mi=a.V_2;class Oi{constructor(e){this.reportPerformanceEvent=e,this.isFirstFrameProcessed=!1,this.frameProcessTimeLimit=100,this.frameProcessingStartedAt=0,this.frameProcessingTimeCost=0,this.processedFrameCount=0,this.performanceStatistics=new Fi(Oi.distributionBinSize,(e=>this.reportPerformanceEvent(i(Mi,s.VideoPerformanceMonitor_Constructor),"video.performance.performanceDataGenerated",[e])))}startMonitorSlowFrameProcessing(){Ti.setInterval((()=>{if(0===this.processedFrameCount)return;const e=this.frameProcessingTimeCost/this.processedFrameCount;e>this.frameProcessTimeLimit&&this.reportPerformanceEvent(i(Mi,s.VideoPerformanceMonitor_StartMonitorSlowFrameProcessing),"video.performance.frameProcessingSlow",[e]),this.frameProcessingTimeCost=0,this.processedFrameCount=0}),Oi.calculateFPSInterval)}setFrameProcessTimeLimit(e){this.frameProcessTimeLimit=e}reportApplyingVideoEffect(e,t){var n,r;(null===(n=this.applyingEffect)||void 0===n?void 0:n.effectId)===e&&(null===(r=this.applyingEffect)||void 0===r?void 0:r.effectParam)===t||(this.applyingEffect={effectId:e,effectParam:t},this.appliedEffect=void 0)}reportVideoEffectChanged(e,t){void 0===this.applyingEffect||this.applyingEffect.effectId!==e&&this.applyingEffect.effectParam!==t||(this.appliedEffect={effectId:e,effectParam:t},this.applyingEffect=void 0,this.isFirstFrameProcessed=!1)}reportStartFrameProcessing(e,t){Ti.tick(),this.appliedEffect&&(this.frameProcessingStartedAt=performance.now(),this.performanceStatistics.processStarts(this.appliedEffect.effectId,e,t,this.appliedEffect.effectParam))}reportFrameProcessed(){var e;this.appliedEffect&&(this.processedFrameCount++,this.frameProcessingTimeCost+=performance.now()-this.frameProcessingStartedAt,this.performanceStatistics.processEnds(),this.isFirstFrameProcessed||(this.isFirstFrameProcessed=!0,this.reportPerformanceEvent(i(Mi,s.VideoPerformanceMonitor_ReportFrameProcessed),"video.performance.firstFrameProcessed",[Date.now(),this.appliedEffect.effectId,null===(e=this.appliedEffect)||void 0===e?void 0:e.effectParam])))}reportGettingTextureStream(e){this.gettingTextureStreamStartedAt=performance.now(),this.currentStreamId=e}reportTextureStreamAcquired(){if(void 0!==this.gettingTextureStreamStartedAt){const e=performance.now()-this.gettingTextureStreamStartedAt;this.reportPerformanceEvent(i(Mi,s.VideoPerformanceMonitor_ReportTextureStreamAcquired),"video.performance.textureStreamAcquired",[this.currentStreamId,e])}}}Oi.distributionBinSize=1e3,Oi.calculateFPSInterval=1e3;var ki=function(e,t,n,r){function i(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?n(e.value):i(e.value).then(a,s)}l((r=r.apply(e,t||[])).next())}))},Hi=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};const Ui=a.V_2;var Vi;!function(e){const t=ue()?void 0:new Oi(yn);let n,r,o;function a(e){yn(i(Ui,s.VideoEffects_NotifyVideoFrameProcessed),"video.videoFrameProcessed",[e])}function l(e){yn(i(Ui,s.VideoEffects_NotifyError),"video.notifyError",[e])}function c(){return Le(ve)&&!!ve.supports.video&&(!!ve.supports.video.mediaStream||!!ve.supports.video.sharedFrame)}function u(e,n){if(Le(ve,N.sidePanel),!c()||!g())throw z;Wt(i(Ui,s.VideoEffects_RegisterStartVideoExtensibilityVideoStreamHandler),"video.startVideoExtensibilityVideoStream",(n=>ki(this,void 0,void 0,(function*(){const{streamId:r}=n,i=d(e,t);yield Ci(r,i,l,t)}))),!1),yn(i(Ui,s.VideoEffects_MediaStream_RegisterForVideoFrame),"video.mediaStream.registerForVideoFrame",[n])}function d(e,t){return n=>ki(this,void 0,void 0,(function*(){const r=n.videoFrame;null==t||t.reportStartFrameProcessing(r.codedWidth,r.codedHeight);const i=yield e(n);return null==t||t.reportFrameProcessed(),i}))}function f(e,n){if(Le(ve,N.sidePanel),!c()||!m())throw z;Wt(i(Ui,s.VideoEffects_RegisterForVideoBufferHandler),"video.newVideoFrame",(n=>{if(n){const r=n.timestamp;null==t||t.reportStartFrameProcessing(n.width,n.height),e(p(n),(()=>{null==t||t.reportFrameProcessed(),a(r)}),l)}}),!1),yn(i(Ui,s.VideoEffects_RegisterForVideoFrame),"video.registerForVideoFrame",[n])}function p(e){if("videoFrameBuffer"in e)return e;{const{data:t}=e,n=Hi(e,["data"]);return Object.assign(Object.assign({},n),{videoFrameBuffer:t})}}function g(){var e;return Le(ve,N.sidePanel)&&h()&&!!(null===(e=ve.supports.video)||void 0===e?void 0:e.mediaStream)}function h(){var e,t,n,r;return!(!(null===(t=null===(e=ce().chrome)||void 0===e?void 0:e.webview)||void 0===t?void 0:t.getTextureStream)||!(null===(r=null===(n=ce().chrome)||void 0===n?void 0:n.webview)||void 0===r?void 0:r.registerTextureStream))}function m(){var e;return Le(ve,N.sidePanel)&&!!(null===(e=ve.supports.video)||void 0===e?void 0:e.sharedFrame)}!function(e){e.NV12="NV12"}(n=e.VideoFrameFormat||(e.VideoFrameFormat={})),function(e){e.EffectChanged="EffectChanged",e.EffectDisabled="EffectDisabled"}(r=e.EffectChangeType||(e.EffectChangeType={})),function(e){e.InvalidEffectId="InvalidEffectId",e.InitializationFailure="InitializationFailure"}(o=e.EffectFailureReason||(e.EffectFailureReason={})),e.registerForVideoFrame=function(e){if(Le(ve,N.sidePanel),!c())throw z;if(!e.videoFrameHandler||!e.videoBufferHandler)throw new Error("Both videoFrameHandler and videoBufferHandler must be provided");if(Wt(i(Ui,s.VideoEffects_RegisterSetFrameProcessTimeLimitHandler),"video.setFrameProcessTimeLimit",(e=>null==t?void 0:t.setFrameProcessTimeLimit(e.timeLimit)),!1),g())u(e.videoFrameHandler,e.config);else{if(!m())throw z;f(e.videoBufferHandler,e.config)}null==t||t.startMonitorSlowFrameProcessing()},e.notifySelectedVideoEffectChanged=function(e,t){if(Le(ve,N.sidePanel),!c())throw z;yn(i(Ui,s.VideoEffects_NotifySelectedVideoEffectChanged),"video.videoEffectChanged",[e,t])},e.registerForVideoEffect=function(e){if(Le(ve,N.sidePanel),!c())throw z;Wt(i(Ui,s.VideoEffects_RegisterEffectParameterChangeHandler),"video.effectParameterChange",Ri(e,t),!1),yn(i(Ui,s.VideoEffects_RegisterForVideoEffect),"video.registerForVideoEffect")},e.isSupported=c}(Vi||(Vi={}));const Li=a.V_2;var Ni;!function(e){const t="search.queryChange",n="search.queryClose",r="search.queryExecute";function o(){return!(!Le(ve)||!ve.supports.search)}e.registerHandlers=function(e,a,l){if(Le(ve,N.content),!o())throw z;Wt(i(Li,s.Search_RegisterOnClosedHandler),n,e),Wt(i(Li,s.Search_RegisterOnExecutedHandler),r,a),l&&Wt(i(Li,s.Search_RegisterOnChangeHandler),t,l)},e.unregisterHandlers=function(){if(Le(ve,N.content),!o())throw z;yn(i(Li,s.Search_UnregisterHandlers),"search.unregister"),Gt(t),Gt(n),Gt(r)},e.isSupported=o,e.closeSearch=function(){return new Promise((e=>{if(Le(ve,N.content),!o())throw new Error("Not supported");e(gn(i(Li,s.Search_CloseSearch),"search.closeSearch"))}))}}(Ni||(Ni={}));const Di=a.V_1,Bi=a.V_2;var xi;!function(e){function t(t,n){return new Promise((r=>{if(!a())throw z;r(mn(t,e.SharingAPIMessages.shareWebContent,n))}))}function n(e){if(!(e&&e.content&&e.content.length)){throw{errorCode:k.INVALID_ARGUMENTS,message:"Shared content is missing"}}}function r(e){let t;if(e.content.some((e=>!e.type)))throw t={errorCode:k.INVALID_ARGUMENTS,message:"Shared content type cannot be undefined"},t;if(e.content.some((t=>t.type!==e.content[0].type)))throw t={errorCode:k.INVALID_ARGUMENTS,message:"Shared content must be of the same type"},t}function o(e){let t;if("URL"!==e.content[0].type)throw t={errorCode:k.INVALID_ARGUMENTS,message:"Content type is unsupported"},t;if(e.content.some((e=>!e.url)))throw t={errorCode:k.INVALID_ARGUMENTS,message:"URLs are required for URL content types"},t}function a(){return!(!Le(ve)||!ve.supports.sharing)}e.SharingAPIMessages={shareWebContent:"sharing.shareWebContent"},e.shareWebContent=function(e,a){try{n(e),r(e),o(e)}catch(e){return te((()=>Promise.reject(e)),a)}return Le(ve,N.content,N.sidePanel,N.task,N.stage,N.meetingStage),te(t,a,i(a?Di:Bi,s.Sharing_ShareWebContent),e)},e.isSupported=a}(xi||(xi={}));const Wi=a.V_2;var Gi;!function(e){let t;function n(){return!(!Le(ve)||!ve.supports.stageView)}!function(e){e.modal="modal",e.popout="popout",e.popoutWithChat="popoutWithChat"}(t=e.StageViewOpenMode||(e.StageViewOpenMode={})),e.open=function(e){return new Promise((t=>{if(Le(ve,N.content),!n())throw z;if(!e)throw new Error("[stageView.open] Stage view params cannot be null");t(mn(i(Wi,s.StageView_Open),"stageView.open",e))}))},e.isSupported=n}(Gi||(Gi={}));var zi=function(e,t,n,r){function i(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?n(e.value):i(e.value).then(a,s)}l((r=r.apply(e,t||[])).next())}))};const ji=a.V_2;var qi,$i;!function(e){let t,n,r;!function(e){e[e.FrontOrRear=1]="FrontOrRear",e[e.FrontOnly=2]="FrontOnly",e[e.RearOnly=3]="RearOnly"}(t=e.CameraRestriction||(e.CameraRestriction={})),function(e){e[e.Camera=1]="Camera",e[e.Gallery=2]="Gallery"}(n=e.Source||(e.Source={})),e.hasPermission=function(){if(Le(ve,N.content,N.task),!r.isSupported())throw z;const e=H.Media;return mn(i(ji,s.VisualMedia_HasPermission),"permissions.has",e)},e.requestPermission=function(){if(Le(ve,N.content,N.task),!r.isSupported())throw z;const e=H.Media;return mn(i(ji,s.VisualMedia_RequestPermission),"permissions.request",e)},function(e){function t(){return!!(Le(ve)&&ve.supports.visualMedia&&ve.supports.visualMedia.image&&ve.supports.permissions)}function n(){if(!t())throw z}function r(e){if(!e||e.maxVisualMediaCount>10||e.maxVisualMediaCount<1)throw J}function o(e,t){if(t.length>e)throw K}e.captureImages=function(e){return zi(this,void 0,void 0,(function*(){Le(ve,N.content,N.task),n(),r(e);const t=yield mn(i(ji,s.VisualMedia_Image_CaptureImages),"visualMedia.image.captureImages",e);return o(e.maxVisualMediaCount,t),t}))},e.retrieveImages=function(e){return zi(this,void 0,void 0,(function*(){Le(ve,N.content,N.task),n(),r(e);const t=yield mn(i(ji,s.VisualMedia_Image_RetrieveImages),"visualMedia.image.retrieveImages",e);return o(e.maxVisualMediaCount,t),t}))},e.isSupported=t}(r=e.image||(e.image={}))}(qi||(qi={})),function(e){function t(){return!(!Le(ve)||!ve.supports.webStorage)}e.isWebStorageClearedOnUserLogOut=function(){return Le(ve),t()},e.isSupported=t}($i||($i={}));const Ji=a.V_2;var Ki;!function(e){let t;function n(){return!(!Le(ve)||!ve.supports.call)}!function(e){e.Unknown="unknown",e.Audio="audio",e.Video="video",e.VideoBasedScreenSharing="videoBasedScreenSharing",e.Data="data"}(t=e.CallModalities||(e.CallModalities={})),e.startCall=function(e){const r=i(Ji,s.Call_StartCall);return new Promise((i=>{var o;if(Le(ve,N.content,N.task),!n())throw z;if(!ve.isLegacyTeams)return yn(r,"call.startCall",[e],i);i(pn(r,"executeDeepLink",gr(e.targets,null===(o=e.requestedModalities)||void 0===o?void 0:o.includes(t.Video),e.source)).then((e=>{if(!e)throw new Error("The call was not properly started");return e})))}))},e.isSupported=n}(Ki||(Ki={}));const Zi=a.V_1;var Qi;!function(e){e.Messages=yt.Messages,e.FailedReason=yt.FailedReason,e.ExpectedFailureReason=yt.ExpectedFailureReason,e.notifyAppLoaded=function(){pt(i(Zi,s.AppInitialization_NotifyAppLoaded))},e.notifySuccess=function(){mt(i(Zi,s.AppInitialization_NotifySuccess))},e.notifyFailure=function(e){ht(i(Zi,s.AppInitialization_NotifyFailure),e)},e.notifyExpectedFailure=function(e){gt(i(Zi,s.AppInitialization_NotifyExpectedFailure),e)}}(Qi||(Qi={}));const Xi=t("thirdPartyCloudStorage"),Yi=a.V_2;var eo;!function(e){class t{constructor(e,t){this.fileType=e,this.assembleAttachment=t}}let n=[],r=null,o=!0,a=null;function l(e){if(a)if(e&&e.error)a([],e.error),a=null;else if(e&&e.fileChunk)try{o||0!==e.fileChunk.chunkSequence||(Xi("Last chunk is not received or 'endOfFile' value for previous chunk was not set to true"),o=!0,a([],{errorCode:k.INTERNAL_ERROR,message:"error occurred while receiving data"}),n=[],a=null);const i=br(e.fileChunk,e.fileType);if(i?(r||(r=new t(e.fileType,[])),r.assembleAttachment.push(i)):(Xi(`Received a null assemble attachment for when decoding chunk sequence ${e.fileChunk.chunkSequence}; not including the chunk in the assembled file.`),a?a([],{errorCode:k.INTERNAL_ERROR,message:"error occurred while receiving data"}):a=null,n=[],a=null,o=!0),o=e.fileChunk.endOfFile,e.fileChunk.endOfFile&&r){const t=_r(r.assembleAttachment,r.fileType);if(t){const r=new File([t],e.fileName,{type:t.type});n.push(r)}e.isLastFile&&a&&(a(n,e.error),n=[],a=null,o=!0),r=null}}catch(e){a&&(a([],{errorCode:k.INTERNAL_ERROR,message:e}),n=[],a=null,o=!0)}else a([],{errorCode:k.INTERNAL_ERROR,message:"data received is null"}),n=[],a=null,o=!0}function c(){return!(!Le(ve)||!ve.supports.thirdPartyCloudStorage)}e.getDragAndDropFiles=function(e,t){if(!t)throw new Error("[getDragAndDropFiles] Callback cannot be null");if(e&&""!==e){if(Le(ve,N.content,N.task),!c())throw z;if(a)throw a=null,new Error("getDragAndDropFiles cannot be called twice");a=t,o=!0,yn(i(Yi,s.ThirdPartyCloudStorage_GetDragAndDropFiles),"thirdPartyCloudStorage.getDragAndDropFiles",[e],l)}else{t([],{errorCode:k.INVALID_ARGUMENTS})}},e.isSupported=c}(eo||(eo={}));const to=a.V_1;function no(e,t){ft(i(to,s.PublicAPIs_Initialize),t).then((()=>{e&&e()}))}function ro(){li.enablePrintCapability()}function io(){li.print()}function oo(e){Ve(),yn(i(to,s.PublicAPIs_GetContext),"getContext",(t=>{t.frameContext||(t.frameContext=y.frameContext),e(t)}))}function ao(e){vt(i(to,s.PublicAPIs_RegisterOnThemeChangeHandlerHelper),e)}function so(e){jt(i(to,s.PublicAPIs_RegisterFullScreenHandler),"fullScreenChange",e,[])}function lo(e){jt(i(to,s.PublicAPIs_RegisterAppButtonClickHandler),"appButtonClick",e,[N.content])}function co(e){jt(i(to,s.PublicAPIs_RegisterAppButtonHoverEnterHandler),"appButtonHoverEnter",e,[N.content])}function uo(e){jt(i(to,s.PublicAPIs_RegisterAppButtonHoverLeaveHandler),"appButtonHoverLeave",e,[N.content])}function fo(e){Ut.backStack.registerBackButtonHandlerHelper(i(to,s.PublicAPIs_RegisterBackButtonHandler),e)}function po(e){li.registerOnLoadHandlerHelper(i(to,s.PublicAPIs_RegisterOnLoadHandler),e)}function go(e){li.registerBeforeUnloadHandlerHelper(i(to,s.PublicAPIs_RegisterBeforeUnloadHandler),e)}function ho(e){jt(i(to,s.PublicAPIs_RegisterFocusEnterHandler),"focusEnter",e,[])}function mo(e){jt(i(to,s.PublicAPIs_RegisterChangeSettingsHandler),"changeSettings",e,[N.content])}function wo(e,t){Le(ve),Rt(i(to,s.PublicAPIs_GetTabInstances),t).then((t=>{e(t)}))}function Co(e,t){Le(ve),Tt(i(to,s.PublicAPIs_GetMruTabInstances),t).then((t=>{e(t)}))}function vo(e){Ft(i(to,s.PublicAPIs_ShareDeepLink),{subPageId:e.subEntityId,subPageLabel:e.subEntityLabel,subPageWebUrl:e.subEntityWebUrl})}function So(e,t){Le(ve,N.content,N.sidePanel,N.settings,N.task,N.stage,N.meetingStage);const n=null!=t?t:Z();St(i(to,s.PublicAPIs_ExecuteDeepLink),e).then((()=>{n(!0)})).catch((e=>{n(!1,e.message)}))}function yo(e){Mt(i(to,s.PublicAPIs_SetFrameContext),e)}function _o(e,t,n){ft(i(to,s.PublicAPIs_InitializeWithFrameContext),n).then((()=>t&&t())),Mt(i(to,s.PublicAPIs_SetFrameContext),e)}const bo=a.V_1;function Eo(e){It(i(bo,s.Navigation_ReturnFocus),e)}function Po(e,t){Le(ve);const n=null!=t?t:Z();At(i(bo,s.Navigation_NavigateToTab),e).then((()=>{n(!0)})).catch((e=>{n(!1,e.message)}))}function Ao(e,t){Le(ve,N.content,N.sidePanel,N.settings,N.remove,N.task,N.stage,N.meetingStage);const n=null!=t?t:Z();Et(i(bo,s.Navigation_NavigateCrossDomain),e).then((()=>{n(!0)})).catch((e=>{n(!1,e.message)}))}function Io(e){Le(ve);const t=null!=e?e:Z();Pt(i(bo,s.Navigation_NavigateBack)).then((()=>{t(!0)})).catch((e=>{t(!1,e.message)}))}const Ro=a.V_1;var To;!function(e){e.setValidityState=function(e){Ot(i(Ro,s.Settings_SetValidityState),e)},e.getSettings=function(e){Le(ve,N.content,N.settings,N.remove,N.sidePanel),kt(i(Ro,s.Settings_GetSettings)).then((t=>{e(t)}))},e.setSettings=function(e,t){Le(ve,N.content,N.settings,N.sidePanel);const n=null!=t?t:Z();Ht(i(Ro,s.Settings_SetSettings),e).then((()=>{n(!0)})).catch((e=>{n(!1,e.message)}))},e.registerOnSaveHandler=function(e){Ut.config.registerOnSaveHandlerHelper(i(Ro,s.Settings_RegisterOnSaveHandler),e)},e.registerOnRemoveHandler=function(e){Ut.config.registerOnRemoveHandlerHelper(i(Ro,s.Settings_RegisterOnRemoveHandler),e)}}(To||(To={}));var Fo=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};const Mo=a.V_1;var Oo;!function(e){function t(e){if(void 0===e.url)throw new Error("url property of taskInfo object can't be undefined");return{url:e.url,size:{height:e.height?e.height:G.Small,width:e.width?e.width:G.Small},title:e.title,fallbackUrl:e.fallbackUrl}}function n(e){if(void 0===e.url||void 0===e.completionBotId)throw new Error(`Both url ${e.url} and completionBotId ${e.completionBotId} are required for bot url dialog. At least one is undefined.`);return{url:e.url,size:{height:e.height?e.height:G.Small,width:e.width?e.width:G.Small},title:e.title,fallbackUrl:e.fallbackUrl,completionBotId:e.completionBotId}}function r(e){return e.height=e.height?e.height:G.Small,e.width=e.width?e.width:G.Small,e}e.startTask=function(e,r){const o=i(Mo,s.Tasks_StartTask),a=r?e=>{var t,n;return r(null!==(t=e.err)&&void 0!==t?t:"",null!==(n=e.result)&&void 0!==n?n:"")}:void 0;return void 0===e.card&&void 0===e.url||e.card?(Le(ve,N.content,N.sidePanel,N.meetingStage),yn(o,"tasks.startTask",[e],r)):void 0!==e.completionBotId?it(o,n(e),a):rt(o,t(e),a),new jr},e.updateTask=function(e){e=r(e);const{width:t,height:n}=e,o=Fo(e,["width","height"]);if(Object.keys(o).length)throw new Error("resize requires a TaskInfo argument containing only width and height");nt(i(Mo,s.Tasks_UpdateTask),e)},e.submitTask=function(e,t){ot(i(Mo,s.Tasks_SubmitTask),e,t)},e.getDefaultSizeIfNotProvided=r}(Oo||(Oo={}));const ko=a.V_2;var Ho;!function(e){let t,n;!function(e){e.guest="Guest",e.attendee="Attendee",e.presenter="Presenter",e.organizer="Organizer"}(t=e.UserMeetingRole||(e.UserMeetingRole={})),function(e){e.added="Added",e.alreadyExists="AlreadyExists",e.conflict="Conflict",e.notFound="NotFound"}(n=e.ContainerState||(e.ContainerState={})),e.isSupported=function(){return!(!Le(ve,N.meetingStage,N.sidePanel)||!ve.supports.interactive)}}(Ho||(Ho={}));class Uo{getFluidTenantInfo(){return Vo(),new Promise((e=>{e(mn(i(ko,s.Interactive_GetFluidTenantInfo),"interactive.getFluidTenantInfo"))}))}getFluidToken(e){return Vo(),new Promise((t=>{t(mn(i(ko,s.Interactive_GetFluidToken),"interactive.getFluidToken",e))}))}getFluidContainerId(){return Vo(),new Promise((e=>{e(mn(i(ko,s.Interactive_GetFluidContainerId),"interactive.getFluidContainerId"))}))}setFluidContainerId(e){return Vo(),new Promise((t=>{t(mn(i(ko,s.Interactive_SetFluidContainerId),"interactive.setFluidContainerId",e))}))}getNtpTime(){return Vo(),new Promise((e=>{e(mn(i(ko,s.Interactive_GetNtpTime),"interactive.getNtpTime"))}))}registerClientId(e){return Vo(),new Promise((t=>{t(mn(i(ko,s.Interactive_RegisterClientId),"interactive.registerClientId",e))}))}getClientRoles(e){return Vo(),new Promise((t=>{t(mn(i(ko,s.Interactive_GetClientRoles),"interactive.getClientRoles",e))}))}getClientInfo(e){return Vo(),new Promise((t=>{t(mn(i(ko,s.Interactive_GetClientInfo),"interactive.getClientInfo",e))}))}static create(){return Vo(),new Uo}}function Vo(){if(!Ho.isSupported())throw new Error("LiveShareHost Not supported")}const Lo=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;const No=function(e){return"string"==typeof e&&Lo.test(e)};var Do=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function Bo(e){try{return e.cartItems=xo(e.cartItems),e}catch(e){throw new Error("Error deserializing cart")}}function xo(e){return e.map((e=>{if(e.imageURL){const t=new URL(e.imageURL);e.imageURL=t}return e.accessories&&(e.accessories=xo(e.accessories)),e}))}const Wo=e=>{try{return e.map((e=>{const{imageURL:t,accessories:n}=e,r=Do(e,["imageURL","accessories"]),i=Object.assign({},r);return t&&(i.imageURL=t.href),n&&(i.accessories=Wo(n)),i}))}catch(e){throw new Error("Error serializing cart items")}};function Go(e){if(!Array.isArray(e)||0===e.length)throw new Error("cartItems must be a non-empty array");for(const t of e)jo(t),zo(t.accessories)}function zo(e){if(null!=e){if(!Array.isArray(e)||0===e.length)throw new Error("CartItem.accessories must be a non-empty array");for(const t of e){if(t.accessories)throw new Error("Item in CartItem.accessories cannot have accessories");jo(t)}}}function jo(e){if(!e.id)throw new Error("cartItem.id must not be empty");if(!e.name)throw new Error("cartItem.name must not be empty");$o(e.price),Jo(e.quantity)}function qo(e){if(null!=e){if(!e)throw new Error("id must not be empty");if(!1===No(e))throw new Error("id must be a valid UUID")}}function $o(e){if("number"!=typeof e||e<0)throw new Error(`price ${e} must be a number not less than 0`);if(parseFloat(e.toFixed(3))!==e)throw new Error(`price ${e} must have at most 3 decimal places`)}function Jo(e){if("number"!=typeof e||e<=0||parseInt(e.toString())!==e)throw new Error(`quantity ${e} must be an integer greater than 0`)}function Ko(e){if(!Object.values(Qo.CartStatus).includes(e))throw new Error(`cartStatus ${e} is not valid`)}const Zo=a.V_2;var Qo;!function(e){let t,n;function r(){return!(!Le(ve)||!ve.supports.marketplace)}e.cartVersion={majorVersion:1,minorVersion:1},function(e){e.TACAdminUser="TACAdminUser",e.TeamsAdminUser="TeamsAdminUser",e.TeamsEndUser="TeamsEndUser"}(t=e.Intent||(e.Intent={})),function(e){e.Open="Open",e.Processing="Processing",e.Processed="Processed",e.Closed="Closed",e.Error="Error"}(n=e.CartStatus||(e.CartStatus={})),e.getCart=function(){if(Le(ve,N.content,N.task),!r())throw z;return mn(i(Zo,s.Marketplace_GetCart),"marketplace.getCart",e.cartVersion).then(Bo)},e.addOrUpdateCartItems=function(t){if(Le(ve,N.content,N.task),!r())throw z;if(!t)throw new Error("addOrUpdateCartItemsParams must be provided");return qo(null==t?void 0:t.cartId),Go(null==t?void 0:t.cartItems),mn(i(Zo,s.Marketplace_AddOrUpdateCartItems),"marketplace.addOrUpdateCartItems",Object.assign(Object.assign({},t),{cartItems:Wo(t.cartItems),cartVersion:e.cartVersion})).then(Bo)},e.removeCartItems=function(t){if(Le(ve,N.content,N.task),!r())throw z;if(!t)throw new Error("removeCartItemsParams must be provided");if(qo(null==t?void 0:t.cartId),!Array.isArray(null==t?void 0:t.cartItemIds)||0===(null==t?void 0:t.cartItemIds.length))throw new Error("cartItemIds must be a non-empty array");return mn(i(Zo,s.Marketplace_RemoveCardItems),"marketplace.removeCartItems",Object.assign(Object.assign({},t),{cartVersion:e.cartVersion})).then(Bo)},e.updateCartStatus=function(t){if(Le(ve,N.content,N.task),!r())throw z;if(!t)throw new Error("updateCartStatusParams must be provided");return qo(null==t?void 0:t.cartId),Ko(null==t?void 0:t.cartStatus),mn(i(Zo,s.Marketplace_UpdateCartStatus),"marketplace.updateCartStatus",Object.assign(Object.assign({},t),{cartVersion:e.cartVersion})).then(Bo)},e.isSupported=r}(Qo||(Qo={}));const Xo=a.V_2;var Yo;!function(e){const t="Action.Execute";let n,r,o;function a(e){if(e.requestType===n.ActionExecuteInvokeRequest){const n=e;if(n.type!==t){throw{errorCode:o.INTERNAL_ERROR,message:`Invalid action type ${n.type}. Action type must be "${t}"`}}}else if(e.requestType===n.QueryMessageExtensionRequest){if(e.commandId.length>64)throw new Error("originalRequestInfo.commandId exceeds the maximum size of 64 characters");if(e.parameters.length>5)throw new Error("originalRequestInfo.parameters exceeds the maximum size of 5");for(const t of e.parameters){if(t.name.length>64)throw new Error("originalRequestInfo.parameters.name exceeds the maximum size of 64 characters");if(t.value.length>512)throw new Error("originalRequestInfo.parameters.value exceeds the maximum size of 512 characters")}}}function l(){return!(!Le(ve)||!ve.supports.externalAppAuthentication)}!function(e){e.ActionExecuteInvokeRequest="ActionExecuteInvokeRequest",e.QueryMessageExtensionRequest="QueryMessageExtensionRequest"}(n=e.OriginalRequestType||(e.OriginalRequestType={})),function(e){e.ActionExecuteInvokeResponse="ActionExecuteInvokeResponse",e.QueryMessageExtensionResponse="QueryMessageExtensionResponse"}(r=e.InvokeResponseType||(e.InvokeResponseType={})),function(e){e.INTERNAL_ERROR="INTERNAL_ERROR"}(o=e.InvokeErrorCode||(e.InvokeErrorCode={})),e.authenticateAndResendRequest=function(e,t,n){if(Le(ve,N.content),!l())throw z;return fe(e),a(n),wn(i(Xo,s.ExternalAppAuthentication_AuthenticateAndResendRequest),"externalAppAuthentication.authenticateAndResendRequest",[e,n,t.url.href,t.width,t.height,t.isExternal]).then((([e,t])=>{if(e&&null!=t.responseType)return t;throw t}))},e.authenticateWithSSO=function(e,t){if(Le(ve,N.content),!l())throw z;return fe(e),wn(i(Xo,s.ExternalAppAuthentication_AuthenticateWithSSO),"externalAppAuthentication.authenticateWithSSO",[e,t.claims,t.silent]).then((([e,t])=>{if(!e)throw t}))},e.authenticateWithSSOAndResendRequest=function(e,t,n){if(Le(ve,N.content),!l())throw z;return fe(e),a(n),wn(i(Xo,s.ExternalAppAuthentication_AuthenticateWithSSOAndResendRequest),"externalAppAuthentication.authenticateWithSSOAndResendRequest",[e,n,t.claims,t.silent]).then((([e,t])=>{if(e&&null!=t.responseType)return t;throw t}))},e.isSupported=l}(Yo||(Yo={}));const ea=a.V_2;var ta;!function(e){let t,n,r;function o(){return!(!Le(ve)||!ve.supports.externalAppCardActions)}!function(e){e.DeepLinkDialog="DeepLinkDialog",e.DeepLinkOther="DeepLinkOther",e.DeepLinkStageView="DeepLinkStageView",e.GenericUrl="GenericUrl"}(t=e.ActionOpenUrlType||(e.ActionOpenUrlType={})),function(e){e.INTERNAL_ERROR="INTERNAL_ERROR",e.INVALID_LINK="INVALID_LINK",e.NOT_SUPPORTED="NOT_SUPPORTED"}(n=e.ActionOpenUrlErrorCode||(e.ActionOpenUrlErrorCode={})),function(e){e.INTERNAL_ERROR="INTERNAL_ERROR"}(r=e.ActionSubmitErrorCode||(e.ActionSubmitErrorCode={})),e.processActionSubmit=function(e,t){if(Le(ve,N.content),!o())throw z;return fe(e),wn(i(ea,s.ExternalAppCardActions_ProcessActionSubmit),"externalAppCardActions.processActionSubmit",[e,t]).then((([e,t])=>{if(!e)throw t}))},e.processActionOpenUrl=function(e,t){if(Le(ve,N.content),!o())throw z;return fe(e),wn(i(ea,s.ExternalAppCardActions_ProcessActionOpenUrl),"externalAppCardActions.processActionOpenUrl",[e,t.href]).then((([e,t])=>{if(e)throw e;return t}))},e.isSupported=o}(ta||(ta={}));const na=a.V_1;var ra;!function(e){let t,n,r,o,a,l;function c(e,t){return{errorCode:e,message:t}}!function(e){e.Dropbox="DROPBOX",e.Box="BOX",e.Sharefile="SHAREFILE",e.GoogleDrive="GOOGLEDRIVE",e.Egnyte="EGNYTE",e.SharePoint="SharePoint"}(t=e.CloudStorageProvider||(e.CloudStorageProvider={})),function(e){e[e.Sharepoint=0]="Sharepoint",e[e.WopiIntegration=1]="WopiIntegration",e[e.Google=2]="Google",e[e.OneDrive=3]="OneDrive",e[e.Recent=4]="Recent",e[e.Aggregate=5]="Aggregate",e[e.FileSystem=6]="FileSystem",e[e.Search=7]="Search",e[e.AllFiles=8]="AllFiles",e[e.SharedWithMe=9]="SharedWithMe"}(n=e.CloudStorageProviderType||(e.CloudStorageProviderType={})),function(e){e.ClassMaterials="classMaterials"}(r=e.SpecialDocumentLibraryType||(e.SpecialDocumentLibraryType={})),function(e){e.Readonly="readonly"}(o=e.DocumentLibraryAccessType||(e.DocumentLibraryAccessType={})),function(e){e.Downloaded="Downloaded",e.Downloading="Downloading",e.Failed="Failed"}(a=e.FileDownloadStatus||(e.FileDownloadStatus={})),function(e){e.Download="DOWNLOAD",e.Upload="UPLOAD",e.Delete="DELETE"}(l=e.CloudStorageProviderFileAction||(e.CloudStorageProviderFileAction={})),e.getCloudStorageFolders=function(e,t){if(Le(ve,N.content),!e||0===e.length)throw new Error("[files.getCloudStorageFolders] channelId name cannot be null or empty");if(!t)throw new Error("[files.getCloudStorageFolders] Callback cannot be null");yn(i(na,s.Files_GetCloudStorageFolders),"files.getCloudStorageFolders",[e],t)},e.addCloudStorageFolder=function(e,t){if(Le(ve,N.content),!e||0===e.length)throw new Error("[files.addCloudStorageFolder] channelId name cannot be null or empty");if(!t)throw new Error("[files.addCloudStorageFolder] Callback cannot be null");yn(i(na,s.Files_AddCloudStorageFolder),"files.addCloudStorageFolder",[e],t)},e.deleteCloudStorageFolder=function(e,t,n){if(Le(ve,N.content),!e)throw new Error("[files.deleteCloudStorageFolder] channelId name cannot be null or empty");if(!t)throw new Error("[files.deleteCloudStorageFolder] folderToDelete cannot be null or empty");if(!n)throw new Error("[files.deleteCloudStorageFolder] Callback cannot be null");yn(i(na,s.Files_DeleteCloudStorageFolder),"files.deleteCloudStorageFolder",[e,t],n)},e.getCloudStorageFolderContents=function(e,t,n){if(Le(ve,N.content),!e||!t)throw new Error("[files.getCloudStorageFolderContents] folder/providerCode name cannot be null or empty");if(!n)throw new Error("[files.getCloudStorageFolderContents] Callback cannot be null");if("isSubdirectory"in e&&!e.isSubdirectory)throw new Error("[files.getCloudStorageFolderContents] provided folder is not a subDirectory");yn(i(na,s.Files_GetCloudStorageFolderContents),"files.getCloudStorageFolderContents",[e,t],n)},e.openCloudStorageFile=function(e,t,n){if(Le(ve,N.content),!e||!t)throw new Error("[files.openCloudStorageFile] file/providerCode cannot be null or empty");if(e.isSubdirectory)throw new Error("[files.openCloudStorageFile] provided file is a subDirectory");yn(i(na,s.Files_OpenCloudStorageFile),"files.openCloudStorageFile",[e,t,n])},e.getExternalProviders=function(e=!1,t){if(Le(ve,N.content),!t)throw new Error("[files.getExternalProviders] Callback cannot be null");yn(i(na,s.Files_GetExternalProviders),"files.getExternalProviders",[e],t)},e.copyMoveFiles=function(e,t,n,r,o=!1,a){if(Le(ve,N.content),!e||0===e.length)throw new Error("[files.copyMoveFiles] selectedFiles cannot be null or empty");if(!t)throw new Error("[files.copyMoveFiles] providerCode cannot be null or empty");if(!n)throw new Error("[files.copyMoveFiles] destinationFolder cannot be null or empty");if(!r)throw new Error("[files.copyMoveFiles] destinationProviderCode cannot be null or empty");if(!a)throw new Error("[files.copyMoveFiles] callback cannot be null");yn(i(na,s.Files_CopyMoveFiles),"files.copyMoveFiles",[e,t,n,r,o],a)},e.getFileDownloads=function(e){if(Le(ve,N.content),!e)throw new Error("[files.getFileDownloads] Callback cannot be null");yn(i(na,s.Files_GetFileDownloads),"files.getFileDownloads",[],e)},e.openDownloadFolder=function(e=void 0,t){if(Le(ve,N.content),!t)throw new Error("[files.openDownloadFolder] Callback cannot be null");yn(i(na,s.Files_OpenDownloadFolder),"files.openDownloadFolder",[e],t)},e.addCloudStorageProvider=function(e){if(Le(ve,N.content),!e)throw c(k.INVALID_ARGUMENTS,"[files.addCloudStorageProvider] callback cannot be null");yn(i(na,s.Files_AddCloudStorageProvider),"files.addCloudStorageProvider",[],e)},e.removeCloudStorageProvider=function(e,t){if(Le(ve,N.content),!t)throw c(k.INVALID_ARGUMENTS,"[files.removeCloudStorageProvider] callback cannot be null");if(!e||!e.content)throw c(k.INVALID_ARGUMENTS,"[files.removeCloudStorageProvider] 3P cloud storage provider request content is missing");yn(i(na,s.Files_RemoveCloudStorageProvider),"files.removeCloudStorageProvider",[e],t)},e.addCloudStorageProviderFile=function(e,t){if(Le(ve,N.content),!t)throw c(k.INVALID_ARGUMENTS,"[files.addCloudStorageProviderFile] callback cannot be null");if(!e||!e.content)throw c(k.INVALID_ARGUMENTS,"[files.addCloudStorageProviderFile] 3P cloud storage provider request content is missing");yn(i(na,s.Files_AddCloudStorageProviderFile),"files.addCloudStorageProviderFile",[e],t)},e.renameCloudStorageProviderFile=function(e,t){if(Le(ve,N.content),!t)throw c(k.INVALID_ARGUMENTS,"[files.renameCloudStorageProviderFile] callback cannot be null");if(!e||!e.content)throw c(k.INVALID_ARGUMENTS,"[files.renameCloudStorageProviderFile] 3P cloud storage provider request content is missing");yn(i(na,s.Files_RenameCloudStorageProviderFile),"files.renameCloudStorageProviderFile",[e],t)},e.deleteCloudStorageProviderFile=function(e,t){if(Le(ve,N.content),!t)throw c(k.INVALID_ARGUMENTS,"[files.deleteCloudStorageProviderFile] callback cannot be null");if(!(e&&e.content&&e.content.itemList&&e.content.itemList.length>0))throw c(k.INVALID_ARGUMENTS,"[files.deleteCloudStorageProviderFile] 3P cloud storage provider request content details are missing");yn(i(na,s.Files_DeleteCloudStorageProviderFile),"files.deleteCloudStorageProviderFile",[e],t)},e.downloadCloudStorageProviderFile=function(e,t){if(Le(ve,N.content),!t)throw c(k.INVALID_ARGUMENTS,"[files.downloadCloudStorageProviderFile] callback cannot be null");if(!(e&&e.content&&e.content.itemList&&e.content.itemList.length>0))throw c(k.INVALID_ARGUMENTS,"[files.downloadCloudStorageProviderFile] 3P cloud storage provider request content details are missing");yn(i(na,s.Files_DownloadCloudStorageProviderFile),"files.downloadCloudStorageProviderFile",[e],t)},e.uploadCloudStorageProviderFile=function(e,t){if(Le(ve,N.content),!t)throw c(k.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] callback cannot be null");if(!(e&&e.content&&e.content.itemList&&e.content.itemList.length>0))throw c(k.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] 3P cloud storage provider request content details are missing");if(!e.content.destinationFolder)throw c(k.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] Invalid destination folder details");yn(i(na,s.Files_UploadCloudStorageProviderFile),"files.uploadCloudStorageProviderFile",[e],t)},e.registerCloudStorageProviderListChangeHandler=function(e){if(Le(ve),!e)throw new Error("[registerCloudStorageProviderListChangeHandler] Handler cannot be null");Wt(i(na,s.Files_RegisterCloudStorageProviderListChangeHandler),"files.cloudStorageProviderListChange",e)},e.registerCloudStorageProviderContentChangeHandler=function(e){if(Le(ve),!e)throw new Error("[registerCloudStorageProviderContentChangeHandler] Handler cannot be null");Wt(i(na,s.Files_RegisterCloudStorageProviderContentChangeHandler),"files.cloudStorageProviderContentChange",e)}}(ra||(ra={}));const ia=a.V_1;var oa;!function(e){function t(){return!(!Le(ve)||!ve.supports.meetingRoom)}e.getPairedMeetingRoomInfo=function(){return new Promise((e=>{if(Le(ve),!t())throw z;e(mn(i(ia,s.MeetingRoom_GetPairedMeetingRoomInfo),"meetingRoom.getPairedMeetingRoomInfo"))}))},e.sendCommandToPairedMeetingRoom=function(e){return new Promise((n=>{if(!e||0==e.length)throw new Error("[meetingRoom.sendCommandToPairedMeetingRoom] Command name cannot be null or empty");if(Le(ve),!t())throw z;n(mn(i(ia,s.MeetingRoom_SendCommandToPairedMeetingRoom),"meetingRoom.sendCommandToPairedMeetingRoom",e))}))},e.registerMeetingRoomCapabilitiesUpdateHandler=function(e){if(!e)throw new Error("[meetingRoom.registerMeetingRoomCapabilitiesUpdateHandler] Handler cannot be null");if(Le(ve),!t())throw z;Wt(i(ia,s.MeetingRoom_RegisterMeetingRoomCapabilitiesUpdateHandler),"meetingRoom.meetingRoomCapabilitiesUpdate",(t=>{Le(ve),e(t)}))},e.registerMeetingRoomStatesUpdateHandler=function(e){if(!e)throw new Error("[meetingRoom.registerMeetingRoomStatesUpdateHandler] Handler cannot be null");if(Le(ve),!t())throw z;Wt(i(ia,s.MeetingRoom_RegisterMeetingRoomStatesUpdateHandler),"meetingRoom.meetingRoomStatesUpdate",(t=>{Le(ve),e(t)}))},e.isSupported=t}(oa||(oa={}));var aa,sa=function(e,t,n,r){function i(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?n(e.value):i(e.value).then(a,s)}l((r=r.apply(e,t||[])).next())}))};!function(e){let n;const r=a.V_1,o=t("messageChannels");function l(){return!(!Le(ve)||!ve.supports.messageChannels)}e.getTelemetryPort=function(){return sa(this,void 0,void 0,(function*(){if(n)return o("Returning telemetry port from cache"),n;if(!l())throw z;return n=yield Cn(i(r,s.MessageChannels_GetTelemetryPort),"messageChannels.getTelemetryPort"),n}))},e.isSupported=l,e._clearTelemetryPort=function(){n=void 0}}(aa||(aa={}));const la=a.V_1;var ca;!function(e){function t(){return!(!Le(ve)||!ve.supports.notifications)}e.showNotification=function(e){if(Le(ve,N.content),!t())throw z;yn(i(la,s.Notifications_ShowNotification),"notifications.showNotification",[e])},e.isSupported=t}(ca||(ca={}));const ua=a.V_1;var da;!function(e){let t,n,r;function o(){return!(!Le(ve)||!ve.supports.remoteCamera)}!function(e){e.Reset="Reset",e.ZoomIn="ZoomIn",e.ZoomOut="ZoomOut",e.PanLeft="PanLeft",e.PanRight="PanRight",e.TiltUp="TiltUp",e.TiltDown="TiltDown"}(t=e.ControlCommand||(e.ControlCommand={})),function(e){e[e.CommandResetError=0]="CommandResetError",e[e.CommandZoomInError=1]="CommandZoomInError",e[e.CommandZoomOutError=2]="CommandZoomOutError",e[e.CommandPanLeftError=3]="CommandPanLeftError",e[e.CommandPanRightError=4]="CommandPanRightError",e[e.CommandTiltUpError=5]="CommandTiltUpError",e[e.CommandTiltDownError=6]="CommandTiltDownError",e[e.SendDataError=7]="SendDataError"}(n=e.ErrorReason||(e.ErrorReason={})),function(e){e[e.None=0]="None",e[e.ControlDenied=1]="ControlDenied",e[e.ControlNoResponse=2]="ControlNoResponse",e[e.ControlBusy=3]="ControlBusy",e[e.AckTimeout=4]="AckTimeout",e[e.ControlTerminated=5]="ControlTerminated",e[e.ControllerTerminated=6]="ControllerTerminated",e[e.DataChannelError=7]="DataChannelError",e[e.ControllerCancelled=8]="ControllerCancelled",e[e.ControlDisabled=9]="ControlDisabled",e[e.ControlTerminatedToAllowOtherController=10]="ControlTerminatedToAllowOtherController"}(r=e.SessionTerminatedReason||(e.SessionTerminatedReason={})),e.getCapableParticipants=function(e){if(!e)throw new Error("[remoteCamera.getCapableParticipants] Callback cannot be null");if(Le(ve,N.sidePanel),!o())throw z;yn(i(ua,s.RemoteCamera_GetCapableParticipants),"remoteCamera.getCapableParticipants",e)},e.requestControl=function(e,t){if(!e)throw new Error("[remoteCamera.requestControl] Participant cannot be null");if(!t)throw new Error("[remoteCamera.requestControl] Callback cannot be null");if(Le(ve,N.sidePanel),!o())throw z;yn(i(ua,s.RemoteCamera_RequestControl),"remoteCamera.requestControl",[e],t)},e.sendControlCommand=function(e,t){if(!e)throw new Error("[remoteCamera.sendControlCommand] ControlCommand cannot be null");if(!t)throw new Error("[remoteCamera.sendControlCommand] Callback cannot be null");if(Le(ve,N.sidePanel),!o())throw z;yn(i(ua,s.RemoteCamera_SendControlCommand),"remoteCamera.sendControlCommand",[e],t)},e.terminateSession=function(e){if(!e)throw new Error("[remoteCamera.terminateSession] Callback cannot be null");if(Le(ve,N.sidePanel),!o())throw z;yn(i(ua,s.RemoteCamera_TerminateSession),"remoteCamera.terminateSession",e)},e.registerOnCapableParticipantsChangeHandler=function(e){if(!e)throw new Error("[remoteCamera.registerOnCapableParticipantsChangeHandler] Handler cannot be null");if(Le(ve,N.sidePanel),!o())throw z;Wt(i(ua,s.RemoteCamera_RegisterOnCapableParticipantsChangeHandler),"remoteCamera.capableParticipantsChange",e)},e.registerOnErrorHandler=function(e){if(!e)throw new Error("[remoteCamera.registerOnErrorHandler] Handler cannot be null");if(Le(ve,N.sidePanel),!o())throw z;Wt(i(ua,s.RemoteCamera_RegisterOnErrorHandler),"remoteCamera.handlerError",e)},e.registerOnDeviceStateChangeHandler=function(e){if(!e)throw new Error("[remoteCamera.registerOnDeviceStateChangeHandler] Handler cannot be null");if(Le(ve,N.sidePanel),!o())throw z;Wt(i(ua,s.RemoteCamera_RegisterOnDeviceStateChangeHandler),"remoteCamera.deviceStateChange",e)},e.registerOnSessionStatusChangeHandler=function(e){if(!e)throw new Error("[remoteCamera.registerOnSessionStatusChangeHandler] Handler cannot be null");if(Le(ve,N.sidePanel),!o())throw z;Wt(i(ua,s.RemoteCamera_RegisterOnSessionStatusChangeHandler),"remoteCamera.sessionStatusChange",e)},e.isSupported=o}(da||(da={}));const fa=a.V_1;var pa;!function(e){function t(){return!(!Le(ve)||!ve.supports.appEntity)}e.selectAppEntity=function(e,n,r,o){if(Le(ve,N.content),!t())throw z;if(!e||0==e.length)throw new Error("[appEntity.selectAppEntity] threadId name cannot be null or empty");if(!o)throw new Error("[appEntity.selectAppEntity] Callback cannot be null");yn(i(fa,s.AppEntity_SelectAppEntity),"appEntity.selectAppEntity",[e,n,r],o)},e.isSupported=t}(pa||(pa={}));const ga=a.V_1;var ha;!function(e){let t,n;function r(){return!(!Le(ve)||!ve.supports.teams)}!function(e){e[e.Regular=0]="Regular",e[e.Private=1]="Private",e[e.Shared=2]="Shared"}(t=e.ChannelType||(e.ChannelType={})),e.getTeamChannels=function(e,t){if(Le(ve,N.content),!r())throw z;if(!e)throw new Error("[teams.getTeamChannels] groupId cannot be null or empty");if(!t)throw new Error("[teams.getTeamChannels] Callback cannot be null");yn(i(ga,s.Teams_GetTeamChannels),"teams.getTeamChannels",[e],t)},e.refreshSiteUrl=function(e,t){if(Le(ve),!r())throw z;if(!e)throw new Error("[teams.refreshSiteUrl] threadId cannot be null or empty");if(!t)throw new Error("[teams.refreshSiteUrl] Callback cannot be null");yn(i(ga,s.Teams_RefreshSiteUrl),"teams.refreshSiteUrl",[e],t)},e.isSupported=r,function(e){let t;function n(){return!(!Le(ve)||!ve.supports.teams)&&!!ve.supports.teams.fullTrust}!function(e){function t(){return!(!Le(ve)||!ve.supports.teams)&&(!!ve.supports.teams.fullTrust&&!!ve.supports.teams.fullTrust.joinedTeams)}e.getUserJoinedTeams=function(e){return new Promise((n=>{if(Le(ve),!t())throw z;if((y.hostClientType===V.android||y.hostClientType===V.teamsRoomsAndroid||y.hostClientType===V.teamsPhones||y.hostClientType===V.teamsDisplays)&&!Ne("2.0.1")){const e={errorCode:k.OLD_PLATFORM};throw new Error(JSON.stringify(e))}n(pn(i(ga,s.Teams_FullTrust_JoinedTeams_GetUserJoinedTeams),"getUserJoinedTeams",e))}))},e.isSupported=t}(t=e.joinedTeams||(e.joinedTeams={})),e.getConfigSetting=function(e){return new Promise((t=>{if(Le(ve),!n())throw z;t(pn(i(ga,s.Teams_FullTrust_GetConfigSetting),"getConfigSetting",e))}))},e.isSupported=n}(n=e.fullTrust||(e.fullTrust={}))}(ha||(ha={}));var ma=function(e,t,n,r){function i(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?n(e.value):i(e.value).then(a,s)}l((r=r.apply(e,t||[])).next())}))};const wa=a.V_2;var Ca;!function(e){e.frameProcessingTimeoutInMs=2e3;const t=ue()?void 0:new Oi(yn);let n;function r(){const t=setTimeout((()=>{u(`Frame not processed in ${e.frameProcessingTimeoutInMs}ms`,n.Warn)}),e.frameProcessingTimeoutInMs);return function(){clearTimeout(t)}}function o(e,t){return n=>ma(this,void 0,void 0,(function*(){const i=n.videoFrame;t.reportStartFrameProcessing(i.codedWidth,i.codedHeight);const o=r(),a=yield e(n);return o(),t.reportFrameProcessed(),a}))}function a(e){return e.videoFrameBuffer=e.videoFrameBuffer||e.data,delete e.data,e}function l(){return Le(ve),Vi.isSupported()}function c(e){yn(i(wa,s.VideoEffectsEx_NotifyVideoFrameProcessed),"video.videoFrameProcessed",[e])}function u(e,t=n.Warn){yn(i(wa,s.VideoEffectsEx_NotifyError),"video.notifyError",[e,t])}!function(e){e.Fatal="fatal",e.Warn="warn"}(n=e.ErrorLevel||(e.ErrorLevel={})),e.registerForVideoFrame=function(e){var n,d;if(!l())throw z;if(!e.videoFrameHandler||!e.videoBufferHandler)throw new Error("Both videoFrameHandler and videoBufferHandler must be provided");if(Le(ve,N.sidePanel)){if(Wt(i(wa,s.VideoEffectsEx_RegisterSetFrameProcessTimeLimitHandler),"video.setFrameProcessTimeLimit",(e=>null==t?void 0:t.setFrameProcessTimeLimit(e)),!1),null===(n=ve.supports.video)||void 0===n?void 0:n.mediaStream)Wt(i(wa,s.VideoEffectsEx_RegisterStartVideoExtensibilityVideoStreamHandler),"video.startVideoExtensibilityVideoStream",(n=>ma(this,void 0,void 0,(function*(){const{streamId:r,metadataInTexture:i}=n,a=t?o(e.videoFrameHandler,t):e.videoFrameHandler;i?yield vi(r,a,u,t):yield Ci(r,a,u,t)}))),!1),yn(i(wa,s.VideoEffectsEx_MediaStream_RegisterForVideoFrame),"video.mediaStream.registerForVideoFrame",[e.config]);else{if(!(null===(d=ve.supports.video)||void 0===d?void 0:d.sharedFrame))throw z;Wt(i(wa,s.VideoEffectsEx_RegisterNewVideoFrameHandler),"video.newVideoFrame",(n=>{if(n){null==t||t.reportStartFrameProcessing(n.width,n.height);const i=r(),o=n.timestamp;e.videoBufferHandler(a(n),(()=>{i(),null==t||t.reportFrameProcessed(),c(o)}),u)}}),!1),yn(i(wa,s.VideoEffectsEx_RegisterForVideoFrame),"video.registerForVideoFrame",[e.config])}null==t||t.startMonitorSlowFrameProcessing()}},e.notifySelectedVideoEffectChanged=function(e,t,n){if(Le(ve,N.sidePanel),!l())throw z;yn(i(wa,s.VideoEffectsEx_NotifySelectedVideoEffectChanged),"video.videoEffectChanged",[e,t,n])},e.registerForVideoEffect=function(e){if(Le(ve,N.sidePanel),!l())throw z;Wt(i(wa,s.VideoEffectsEx_RegisterEffectParameterChangeHandler),"video.effectParameterChange",Ri(e,t),!1),yn(i(wa,s.VideoEffectsEx_RegisterForVideoEffect),"video.registerForVideoEffect")},e.updatePersonalizedEffects=function(e){if(Le(ve,N.sidePanel),!Vi.isSupported())throw z;yn(i(wa,s.VideoEffectsEx_UpdatePersonalizedEffects),"video.personalizedEffectsChanged",[e])},e.isSupported=l,e.notifyFatalError=function(e){if(Le(ve),!Vi.isSupported())throw z;u(e,n.Fatal)}}(Ca||(Ca={}))})(),r})()));
//# sourceMappingURL=MicrosoftTeams.min.js.map