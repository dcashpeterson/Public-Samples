(window.webpackJsonpf9e737b7_f0df_4597_ba8c_3060f82380db_1_18_2=window.webpackJsonpf9e737b7_f0df_4597_ba8c_3060f82380db_1_18_2||[]).push([[4],{UJ9R:function(e,t,n){"use strict";n.d(t,"e",function(){return c}),n.d(t,"t",function(){return d});var a=n("17wl"),i=n("cDcd"),r=n("5pbq"),o=n("Z+Hm"),s=n("+ORw");function c(e,t,n,a){return l(e,{change:{description:o.n,label:o.t},delete:{description:o.s,label:o.o}},t,n,a)}function d(e,t,n,a){return l(e,{change:{description:o.i,label:o.a},delete:{description:o.d,label:o.c}},t,n,a)}function l(e,t,n,c,d){var l=t.change,u=l.description,f=l.label,p=t.delete,m=p.description,_=p.label,h={className:c,onClick:e,ariaLabel:f,ariaDescription:u,"data-automation-id":d?"".concat(d,"ChangeButton"):"thumbnailImagePickerChangeButton"},b=Object(s.s)()?i.createElement(r.PrimaryButton,Object(a.__assign)({},h),o.e):i.createElement(r.ActionButton,Object(a.__assign)({},Object(a.__assign)(Object(a.__assign)({},h),{iconProps:{iconName:"Edit"}})),o.e),g=!Object(s.s)()&&n?i.createElement(r.ActionButton,{iconProps:{iconName:"Delete"},className:c,onClick:n,ariaLabel:_,ariaDescription:m,"data-automation-id":d?"".concat(d,"DeleteButton"):"thumbnailImagePickerDeleteButton"},o.r):void 0;return g?i.createElement(r.Stack,{tokens:{childrenGap:40},horizontal:!0},b," ",g):b}},"Z+Hm":function(e){e.exports=JSON.parse('{"l":"[!!--##Ũƥĺōàďĩńĝ...##--!!]","e":"[!!--##Ćĥàńĝē##--!!]","i":"[!!--##Ƥŕēśś ēńţēŕ ţō ćĥàńĝē ţĥē ţĥũmƀńàĩĺ ĩmàĝē.##--!!]","a":"[!!--##Ćĥàńĝē ţĥē ţĥũmƀńàĩĺ ĩmàĝē##--!!]","r":"[!!--##Ďēĺēţē##--!!]","d":"[!!--##Ƥŕēśś ďēĺēţē ţō ďēĺēţē ţĥē ţĥũmƀńàĩĺ ĩmàĝē.##--!!]","c":"[!!--##Ďēĺēţē ţĥē ţĥũmƀńàĩĺ ĩmàĝē##--!!]","n":"[!!--##Ƥŕēśś ēńţēŕ ţō ćĥàńĝē ţĥē ĩćōń.##--!!]","t":"[!!--##Ćĥàńĝē ţĥē ĩćōń##--!!]","s":"[!!--##Ƥŕēśś ďēĺēţē ţō ďēĺēţē ţĥē ĩćōń.##--!!]","o":"[!!--##Ďēĺēţē ţĥē ĩćōń##--!!]"}')},jRqm:function(e,t,n){"use strict";n.d(t,"e",function(){return l});var a=n("17wl"),i=n("cDcd"),r=n("5pbq"),o=n("ut3N"),s=n("ODJL"),c=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isRenderBackup:!1},n}return Object(a.__extends)(t,e),t.prototype.render=function(){var e,t=this._content;return!!t&&i.createElement("div",{role:"img",className:this.props.className,"aria-label":null===(e=this.props.thumbnail)||void 0===e?void 0:e.altText},t)},Object.defineProperty(t.prototype,"_content",{get:function(){if(this.props.onRenderThumbnail)return this.props.onRenderThumbnail();var e=this.props.thumbnail;if(e)switch(e.type){case s.t.FabricReactIcon:return i.createElement(r.Icon,{iconName:e.iconName,style:e.iconColor?{color:e.iconColor}:void 0,role:"presentation",className:this.props.iconClassName});case s.t.IconSizeImage:var t={className:this.props.iconClassName,imageFit:r.ImageFit.cover,src:e.iconUrl,role:"presentation",alt:e.altText};return i.createElement(r.Icon,{iconType:r.IconType.image,style:e.iconColor?{color:e.iconColor}:void 0,imageProps:t,className:this.props.iconClassName});case s.t.Image:var n={imageFit:void 0!==e.imageFit?e.imageFit:r.ImageFit.cover,src:this.state.isRenderBackup&&e.backupImageUrl?e.backupImageUrl:e.imageUrl,alt:e.altText,title:e.altText?e.altText:void 0,role:e.altText?void 0:"presentation",className:this.props.iconClassName,onLoadingStateChange:this._handleImageLoadingStateChange,styles:{image:{width:"100%",height:"100%"}}};return this._imageMonitor=new o._QosMonitor("".concat(this.props.qosPrefix,".ImageLoad")),i.createElement(r.Icon,{iconType:r.IconType.image,imageProps:n,className:this.props.iconClassName});default:return}},enumerable:!1,configurable:!0}),t.prototype._handleImageLoadingStateChange=function(e){this._imageMonitor&&(e===r.ImageLoadState.loaded?this._imageMonitor.writeSuccess():e===r.ImageLoadState.error&&this._imageMonitor.writeUnexpectedFailure("ImageLoadError",void 0,{isRenderBackup:this.state.isRenderBackup})),this.setState(function(t){if(e===r.ImageLoadState.error&&!t.isRenderBackup)return{isRenderBackup:!0}})},Object(a.__decorate)([r.autobind],t.prototype,"_handleImageLoadingStateChange",null),t}(i.PureComponent),d=n("Z+Hm");n("jOlS").loadStyles('.cq_n_d8e860b4{position:relative}.cq_n_d8e860b4.cr_n_d8e860b4{background-color:"[theme:neutralLight, default: #edebe9]"}.cs_n_d8e860b4{padding-bottom:56.25%;width:100%}.ct_n_d8e860b4{height:100px;width:100px}.cu_n_d8e860b4{align-items:center;bottom:0;display:flex;justify-content:center;left:0;overflow:hidden;position:absolute;right:0;top:0}.cu_n_d8e860b4.cv_n_d8e860b4{font-size:64px;line-height:100%;text-align:center}.cu_n_d8e860b4.cw_n_d8e860b4 .cx_n_d8e860b4{height:100%;width:100%}.cu_n_d8e860b4.cy_n_d8e860b4 .cx_n_d8e860b4{height:64px;width:64px}.o_n_d8e860b4{left:50%;margin:0;position:absolute;top:50%;transform:translate(-50%,-50%)}',!0);var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.render=function(){var e,t,n,a,o=Object(r.css)("cq_n_d8e860b4",this.props.previewFullWidth?"cs_n_d8e860b4":"ct_n_d8e860b4",this.props.previewGrayBackground?"cr_n_d8e860b4":"",this.props.wrapperClassName),l=Object(r.css)("cu_n_d8e860b4",((e={}).cv_n_d8e860b4=(null===(t=this.props.thumbnail)||void 0===t?void 0:t.type)===s.t.FabricReactIcon,e.cy_n_d8e860b4=(null===(n=this.props.thumbnail)||void 0===n?void 0:n.type)===s.t.IconSizeImage,e.cw_n_d8e860b4=(null===(a=this.props.thumbnail)||void 0===a?void 0:a.type)===s.t.Image,e));return this.props.showLoading?i.createElement("div",{className:o},i.createElement(r.Spinner,{className:"o_n_d8e860b4",type:r.SpinnerType.large,label:d.l})):i.createElement("div",{className:o},i.createElement(c,{thumbnail:this.props.thumbnail,className:l,iconClassName:Object(r.css)(this.props.iconClassName,"cx_n_d8e860b4"),qosPrefix:this.props.qosPrefix,onRenderThumbnail:this.props.onRenderThumbnail}))},t}(i.PureComponent)},oKa9:function(e,t,n){"use strict";n.r(t),n.d(t,"ThumbnailPickerPreview",function(){return y});var a=n("17wl"),i=n("cDcd"),r=n("5pbq"),o=n("vNcA"),s=n("ut3N"),c=n("8dK2"),d=n("Pk8u"),l=n("X+PM"),u=n("I6O9"),f=function(){function e(){}return e.load=function(e,t){return u.SPComponentLoader.loadComponentById("a81a5cf6-c9ad-4a0a-85aa-68c03d2d22a2").then(function(n){var a=new n.FilePicker(e);return a.initialize(t),a.fetchData().catch(function(e){return s._TraceLogger.logError(s._LogSource.create("FilePickerLoader"),e,"fetchData")}),a})},e}(),p=f,m=n("vhYV"),_=n("yQVM"),h=function(){function e(e){var t=this;this._options=e,this._spFileHandlerPromise=Promise.resolve().then(n.t.bind(null,"vhYV",7)).then(function(e){return void 0===t._spFileHandler&&(t._spFileHandler=new e.SPFileHandler({serviceScope:t._options.serviceScope,qosPrefix:t._options.callerName})),t._spFileHandler}),this._options.serviceScope.whenFinished(function(){var e=t._options.serviceScope.consume(l.PageContext.serviceKey);t._webId=e.web.id.toString(),t._siteId=e.site.id.toString()})}return e.prototype.openFilePicker=function(e,t){d.merge(this._options,e),this._sourceItemUrl=t,this._ensureFilePickerAsync().then(function(e){e.open()}).catch(function(){})},e.prototype._ensureFilePickerAsync=function(){if(!this._filePicker){var e={selectableType:3,onSelect:this._handleSelectFile,onCancel:this._options.onClose,selectionMode:this._options.isMultiSelectMode?o.SelectionMode.multiple:o.SelectionMode.single,itemTypes:this._options.itemTypes,allowExternalTenantLinks:this._options.allowExternalTenantLinks,disableWebSearch:this._options.disableWebSearch,callerName:this._options.callerName,enableMailtoSchema:!0};this._filePicker=p.load(this._options.serviceScope,e)}return this._filePicker},e.prototype._handleSelectFile=function(e){var t=this;e&&e.selectedItems&&e.selectedItems.length>0?e.selectedItems.forEach(function(n){if(t._options.onSelectFile){var a=Boolean(n.ListId||n.UniqueId||n.WebId||n.SiteId)?{listId:n.ListId,uniqueId:n.UniqueId,webId:n.WebId,siteId:n.SiteId}:void 0;t._options.onSelectFile(n.Link,a,e.selectedItems.length)}}):e&&e.localFilesPickedToUpload?(this._itemsCount=e.localFilesPickedToUpload.length,e.localFilesPickedToUpload.forEach(function(e){var n=e.file;t._startUpload(n)})):e&&e.externalImagesPickedToUpload?(this._itemsCount=e.externalImagesPickedToUpload.length,e.externalImagesPickedToUpload.forEach(function(e){t._startUpload(e)})):s._TraceLogger.logErrorWithLogEntry(s._LogSource.create(this._options.callerName),new s._LogEntry(this._options.callerName,"HandleSelectFileFromFilePicker",s._LogType.Error,{response:JSON.stringify(e)}))},e.prototype._startUpload=function(e){var t,n,a,i,r=this;if(e instanceof File){var o=!1;this._sourceItemUrl&&(o=this._sourceItemUrl.split("/").pop()===e.name);var d=Math.floor(4294967296*Math.random()).toString(),l=o?d+m.SPFileHandler.replaceSpecialCharacters(e.name):m.SPFileHandler.replaceSpecialCharacters(e.name);a=new s._QosMonitor("".concat(this._options.callerName,".UploadItem")),i=this._spFileHandlerPromise.then(function(t){return t.uploadLocalFile(e,l)})}else{if(c._ThumbnailUrlGenerator.getThumbnailProvider(e.src)===c._ThumbnailProviderType.HubbleStock)return void(null===(n=(t=this._options).onSelectFile)||void 0===n||n.call(t,e.src,void 0,this._itemsCount));a=new s._QosMonitor("".concat(this._options.callerName,".UploadExternalItem")),i=this._spFileHandlerPromise.then(function(t){return t.uploadExternalFile(e.src,e.name)})}window.addEventListener("beforeunload",this._promptUploadingWarning),this._options.onUploadFileStart&&this._options.onUploadFileStart(),i.then(function(e){r._onUploadComplete(e),a.writeSuccess()},function(e){e instanceof m.SPFileHandlerError?-2147024891===e.errorCode?a.writeExpectedFailure("PermissionAccessDenied",e):-2130575257===e.errorCode?a.writeExpectedFailure("FileNameExisted",e):a.writeUnexpectedFailure("FailedToUpload",e,{errorCode:e.errorCode}):a.writeUnexpectedFailure("FailedToUploadNoSPFileHandlerError",e),r._onUploadError(e)})},e.prototype._promptUploadingWarning=function(e){var t=_.e;return e.returnValue=t,t},e.prototype._onUploadComplete=function(e){if(window.removeEventListener("beforeunload",this._promptUploadingWarning),this._options.onSelectFile){var t=e.uniqueId?{listId:e.listId,uniqueId:e.uniqueId,webId:this._webId,siteId:this._siteId}:void 0;this._options.onSelectFile(e.serverRelativeUrl,t,this._itemsCount)}},e.prototype._onUploadError=function(e){window.removeEventListener("beforeunload",this._promptUploadingWarning)},Object(a.__decorate)([r.autobind],e.prototype,"openFilePicker",null),Object(a.__decorate)([r.autobind],e.prototype,"_handleSelectFile",null),e}(),b=n("jRqm"),g=n("UJ9R"),v=n("+ORw");n("jOlS").loadStyles(".bb_k_d8e860b4{align-items:stretch;display:flex;flex-direction:column;width:100%}.bb_k_d8e860b4 .ce_k_d8e860b4{align-self:flex-start;margin-bottom:10px;margin-top:10px}",!0);var y=function(e){function t(t){var n=e.call(this,t)||this;return n._handleChangeImageClick=function(){n._filePicker.openFilePicker()},n._filePicker=new h({serviceScope:n.props.serviceScope,itemTypes:new Set([2]),onSelectFile:n._handleSelectFile,onUploadFileError:n._handleUploadError,onUploadFileStart:n._handleUploadFileStart,allowExternalTenantLinks:!1,disableWebSearch:!1,isMultiSelectMode:!1,callerName:n.props.callerName}),n._thumbnailWrapperRef=i.createRef(),n.state={isUploadInProgress:!1},n}return Object(a.__extends)(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.setState({isUploadInProgress:!1})},t.prototype.render=function(){return i.createElement("div",{className:"bb_k_d8e860b4",ref:this._thumbnailWrapperRef},i.createElement(b.e,{key:this.props.thumbnail.imageUrl,thumbnail:this.props.thumbnail,showLoading:this.state.isUploadInProgress,previewFullWidth:this.props.previewFullWidth,previewGrayBackground:this.props.previewGrayBackground,wrapperClassName:this.props.thumbnailRendererWrapperClassName,iconClassName:this.props.thumbnailRendererIconClassName,qosPrefix:this.props.callerName}),Object(g.t)(this._handleChangeImageClick,this.props.onItemDeleted,"ce_k_d8e860b4","thumbnailImagePicker"))},t.prototype._handleUploadFileStart=function(){this.setState({isUploadInProgress:!0})},t.prototype._handleUploadError=function(e){this.setState({isUploadInProgress:!1})},t.prototype._handleSelectFile=function(e,t){this.setState(function(e){return{isUploadInProgress:!1}}),this.props.onItemChanged(e,t),this._handleImageChangeFocus()},t.prototype._handleImageChangeFocus=function(){var e=this;Object(v.o)()||setTimeout(function(){var t,n=null===(t=e._thumbnailWrapperRef.current)||void 0===t?void 0:t.querySelector('[data-automation-id="thumbnailImagePickerChangeButton"]');n&&n.focus()},0)},Object(a.__decorate)([r.autobind],t.prototype,"_handleUploadFileStart",null),Object(a.__decorate)([r.autobind],t.prototype,"_handleUploadError",null),Object(a.__decorate)([r.autobind],t.prototype,"_handleSelectFile",null),t}(i.PureComponent)},vNcA:function(e,t,n){var a=n("fglE");e.exports=a._Utilities},yQVM:function(e){e.exports=JSON.parse('{"e":"[!!--##Ŵē\\u0027ŕē śţĩĺĺ ũƥĺōàďĩńĝ ŷōũŕ ĩţēm. Ĩƒ ŷōũ ĺēàvē ţĥĩś ƥàĝē, ũƥĺōàďĩńĝ màŷ ńōţ ƒĩńĩśĥ àńď ŷōũ\\u0027ĺĺ ĥàvē ţō ţŕŷ àĝàĩń.##--!!]"}')}}]);