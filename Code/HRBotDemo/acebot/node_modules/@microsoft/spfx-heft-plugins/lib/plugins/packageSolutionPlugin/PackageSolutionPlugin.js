"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const PluginNames_1 = require("../PluginNames");
const SolutionPackager_1 = require("./SolutionPackager");
/**
 * @internal
 */
class PackageSolutionPlugin {
    apply(taskSession, heftConfiguration) {
        const logger = taskSession.logger;
        taskSession.hooks.run.tapPromise(PluginNames_1.PackageSolutionPlugin, async () => {
            const prettyPrintXmlParameter = taskSession.parameters.getFlagParameter('--pretty-print-xml');
            const noSpppkgParameter = taskSession.parameters.getFlagParameter('--no-spppkg');
            const solutionPackager = new SolutionPackager_1.SolutionPackager({
                buildFolder: heftConfiguration.buildFolderPath,
                terminal: heftConfiguration.globalTerminal,
                emitError: logger.emitError.bind(logger),
                emitWarning: logger.emitWarning.bind(logger)
            });
            await solutionPackager.packageSolutionAsync(taskSession.parameters.production, prettyPrintXmlParameter.value, noSpppkgParameter.value);
        });
    }
}
exports.default = PackageSolutionPlugin;
//# sourceMappingURL=PackageSolutionPlugin.js.map