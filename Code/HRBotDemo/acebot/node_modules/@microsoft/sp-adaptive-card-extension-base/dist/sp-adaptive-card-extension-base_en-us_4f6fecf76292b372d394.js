define("eeec822e-c28a-46b4-affc-7058e4c1aa80_1.18.2",["tslib","@microsoft/sp-http-base","@ms/sp-telemetry","@microsoft/sp-component-base","@microsoft/sp-loader","@microsoft/sp-lodash-subset","@microsoft/sp-core-library","@microsoft/sp-page-context","@microsoft/sp-diagnostics"],function(n,a,i,r,o,s,c,d,l){return function(e){var t={};function n(a){if(t[a])return t[a].exports;var i=t[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(a,i,function(t){return e[t]}.bind(null,i));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="mwqp")}({"17wl":function(e,t){e.exports=n},"2SXB":function(e,t){e.exports=a},"2q6Q":function(e,t){e.exports=i},"7Awa":function(e,t){e.exports=r},I6O9:function(e,t){e.exports=o},Pk8u:function(e,t){e.exports=s},UWqr:function(e,t){e.exports=c},"X+PM":function(e,t){e.exports=d},mGD9:function(e){e.exports=JSON.parse('{"r":"Action Id: \\u0027{0}\\u0027 target URL should not be undefined or empty string. ","t":"Adaptive card extension icon.","n":"{0} card icon","a":"{0} card image","i":"Search","e":"The action for button {0} is undefined. Please, specify the action in the card view\\u0027s configuration."}')},mwqp:function(e,t,n){"use strict";n.r(t),n.d(t,"_AdaptiveCardExtensionActionShim",function(){return S}),n.d(t,"_getOnBeforeActionArguments",function(){return y}),n.d(t,"AdaptiveCardExtensionContext",function(){return I}),n.d(t,"_AdaptiveCardExtensionHost",function(){return x}),n.d(t,"_AdaptiveCardExtensionLoader",function(){return L}),n.d(t,"BaseAdaptiveCardExtension",function(){return Le}),n.d(t,"_BaseAdaptiveCardExtensionCache",function(){return Ce}),n.d(t,"_LocalStorageACECache",function(){return Oe}),n.d(t,"_isSurfaceOnBeforeActionKSActivated",function(){return l}),n.d(t,"_isSupportActionExecuteKSActivated",function(){return _}),n.d(t,"_isEnableHTMLQuickViewKSActivated",function(){return g}),n.d(t,"MediaType",function(){return me}),n.d(t,"_IsolatedAdaptiveCardExtensionService",function(){return Te}),n.d(t,"BaseView",function(){return F}),n.d(t,"BaseBasicCardView",function(){return _e}),n.d(t,"BaseCardView",function(){return H}),n.d(t,"BaseImageCardView",function(){return Ue}),n.d(t,"BasePrimaryTextCardView",function(){return Fe}),n.d(t,"QuickViewNavigator",function(){return xe}),n.d(t,"ViewNavigator",function(){return Ie}),n.d(t,"_ViewRegistry",function(){return Se}),n.d(t,"BaseAdaptiveCardQuickView",function(){return ge}),n.d(t,"BaseAdaptiveCardView",function(){return ve}),n.d(t,"_ACEMySiteCacheManager",function(){return He}),n.d(t,"BaseTemplateCardView",function(){return B}),n.d(t,"BaseQuickView",function(){return be}),n.d(t,"BaseHTMLQuickView",function(){return Re}),n.d(t,"_generateComponentId",function(){return j}),n.d(t,"_cardViewBarConfigurationToParameters",function(){return re}),n.d(t,"BasicCardView",function(){return ce}),n.d(t,"PrimaryTextCardView",function(){return de}),n.d(t,"ImageCardView",function(){return le}),n.d(t,"TextInputCardView",function(){return ue}),n.d(t,"TextInputImageCardView",function(){return fe}),n.d(t,"_footerConfigurationToFooterParameters",function(){return pe}),n.d(t,"SearchCardView",function(){return je}),n.d(t,"_createAction",function(){return U}),n.d(t,"BaseComponentsCardView",function(){return Ve}),n.d(t,"_getRenderArgumentsForMessaging",function(){return Ge}),n.d(t,"_prepareRenderArgumentsForMessaging",function(){return ze});var a=n("ut3N"),i=n("UWqr");function r(){return i._SPKillSwitch.isActivated("db2c6f89-2750-4b0c-87f4-fd4b28af598e")}function o(){return i._SPKillSwitch.isActivated("63a9cba3-4d6e-44a7-bdfb-3464aeb6a4a4")}function s(){return i._SPKillSwitch.isActivated("080770ac-5b8a-4f68-97b3-abf37230c2ce")}function c(){return i._SPKillSwitch.isActivated("aebbeddc-284c-470d-8bd2-98a4d200cb86")}function d(){return i._SPKillSwitch.isActivated("c761d258-674d-4c2c-91ca-37cd43dd78a5")}function l(){return i._SPKillSwitch.isActivated("96512177-c963-43cb-b876-87ee06253a2c")}function u(){return i._SPKillSwitch.isActivated("b80ce106-cdb0-42b6-87ab-0b3257902e37")}function f(){return i._SPKillSwitch.isActivated("aafb30e0-3b0d-4f43-a2e9-59bc2ef942dc")}function p(){return i._SPKillSwitch.isActivated("06dfa773-bc74-41ca-9496-5ebb4afdfd5e")}function m(){return i._SPKillSwitch.isActivated("4bd7e0a9-c17a-411b-bda8-1e130c7346ec")}function _(){return i._SPKillSwitch.isActivated("9050e5ae-5e51-4939-9394-7be770d5de93")}function h(){return i._SPKillSwitch.isActivated("29970e19-de66-45b7-adcf-74eed779ea77")}function b(){return i._SPKillSwitch.isActivated("01795526-5047-424b-ab23-026e44862189")}function g(){return i._SPKillSwitch.isActivated("5e86c072-4f36-4fff-8691-3a8b5b4a25aa")}var v=n("17wl");function y(e,t,n){var a;if("Action.OpenUrl"===e)return{type:"ExternalLink",url:t.url};if("Action.Submit"===e){var i=t.data;return i&&i._internalQuickViewId?{type:"QuickView",viewId:i._internalQuickViewId,data:n}:{id:t.id,data:Object(v.__assign)(Object(v.__assign)({},t.data),n),type:"Submit"}}return"Action.Execute"===e?{id:t.id,data:Object(v.__assign)(Object(v.__assign)({},t.data),n),verb:t.verb,type:"Execute"}:"Action.ShowCard"===e?{id:t.id,type:"ShowCard"}:"VivaAction.ShowLocation"===e?{type:"VivaAction.ShowLocation",parameters:{locationCoordinates:null===(a=t.parameters)||void 0===a?void 0:a.locationCoordinates}}:void 0}var S=function(){function e(e,t,n){var a=this;this.handleAction=function(e){var t=e,n=t.getJsonTypeName(),i=y(n,e);switch(!l()&&i&&a._ace._onBeforeAction(i,a._location),n){case"Action.OpenUrl":a._handleOpenUrl(t);break;case"Action.ShowCard":a._handleShowCard(t);break;case"Action.Submit":a._handleSubmit(t);break;case"Action.Execute":a._handleExecute(t);break;case"VivaAction.GetLocation":a._handleGetLocation(t);break;case"VivaAction.SelectMedia":a._handleSelectMedia(t);break;case"VivaAction.ShowLocation":a._handleShowLocation(t)}},this._ace=e,this._provider=t,this._location=n}return e.prototype._handleGetLocation=function(e){var t,n=new a._QosMonitor("AdaptiveCardExtension._onExecuteAction.GetLocation",!0);try{var i={chooseLocationOnMap:null===(t=e.parameters)||void 0===t?void 0:t.chooseLocationOnMap};this._provider.getLocation(this._ace).getLocation(i),n.writeSuccess(),this._provider.log(this._ace,"VivaAction.GetLocation")}catch(e){n.writeUnexpectedFailure(void 0,e)}},e.prototype._handleOpenUrl=function(e){var t=e.url;t&&(this._provider.openUrl(this._ace,t),this._provider.log(this._ace,"OpenUrl"))},e.prototype._handleSelectMedia=function(e){this._provider.selectMedia(this._ace,e).getMedia(e),this._provider.log(this._ace,"VivaAction.SelectMedia")},e.prototype._handleShowCard=function(e){var t={id:e.id,type:"ShowCard"};this._provider.aceActionHandler(this._ace,t),this._provider.log(this._ace,"ShowCard")},e.prototype._handleShowLocation=function(e){var t,n=new a._QosMonitor("AdaptiveCardExtension._onExecuteAction.ShowLocation",!0);try{var i={locationCoordinates:null===(t=e.parameters)||void 0===t?void 0:t.locationCoordinates};this._provider.showLocation(this._ace).showLocation(i),n.writeSuccess(),this._provider.log(this._ace,"VivaAction.ShowLocation")}catch(e){n.writeUnexpectedFailure(void 0,e)}},e.prototype._handleSubmit=function(e){var t,n=this,i=new a._QosMonitor("AdaptiveCardExtension._onExecuteAction.handleConfirmationDialog",!0),r=null===(t=e.data)||void 0===t?void 0:t._internalQuickViewId;if(r)this._provider.quickView(r);else{var o={data:e.data,id:e.id,type:"Submit"};this._provider.confirmationDialog(o).then(function(e){i.writeSuccess(),e||(n._provider.aceActionHandler(n._ace,o),n._provider.log(n._ace,"Submit"))}).catch(function(){i.writeUnexpectedFailure()})}},e.prototype._handleExecute=function(e){if(!_()){var t={id:e.id,verb:e.verb,data:e.data,type:"Execute"};this._provider.aceActionHandler(this._ace,t),this._provider.log(this._ace,"Execute")}},e}(),D=n("7Awa"),I=function(e){function t(t){var n=e.call(this,t)||this;return n._aceHost=t.host,n.manifest=t.manifest,n._deviceContext=t.deviceContext,n._location=t.location,n._logACEEditCustomerPromiseFailure=t.logEditCustomerPromiseFailure,n._getPositionOnPage=t.getPositionOnPage,n._hostContext=t.hostContext,n._sdks=t.sdks,n}return Object(v.__extends)(t,e),Object.defineProperty(t.prototype,"_host",{get:function(){return this._aceHost},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"propertyPane",{get:function(){return this._host.propertyPane},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"deviceContext",{get:function(){return this._deviceContext},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hostContext",{get:function(){return this._hostContext},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sdks",{get:function(){return this._sdks},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"location",{get:function(){return this._location()},enumerable:!1,configurable:!0}),t.prototype._logEditCustomerPromiseFailure=function(e,t,n){this._logACEEditCustomerPromiseFailure&&this._logACEEditCustomerPromiseFailure(e,t,n)},t}(D.BaseComponentContext),x=function(){function e(e){this._onBeforeInitializedCallback=e.onBeforeInitializedCallback,this._onUpdateCallback=e.onUpdateCallback,this._onErrorCallback=e.onError,this._onRequestRenderTypeCallback=e.onRequestRenderTypeCallback,this._onVisibilityChanged=e.onVisibilityChanged,this._onRenderCompleted=e.onRenderCompleted,this._cache=e.cache,this.propertyPane=e.propertyPane}return e.prototype.update=function(e){this._onUpdateCallback(e)},e.prototype.onBeforeInitialized=function(e){this._onBeforeInitializedCallback&&this._onBeforeInitializedCallback(e)},e.prototype.onError=function(e){this._onErrorCallback&&this._onErrorCallback(e)},e.prototype.requestRenderTypeChange=function(e,t){this._onRequestRenderTypeCallback(e,t)},Object.defineProperty(e.prototype,"cache",{get:function(){return this._cache},enumerable:!1,configurable:!0}),e.prototype.onVisibilityChanged=function(e){this._onVisibilityChanged(e)},e.prototype.onRenderCompleted=function(e,t){this._onRenderCompleted&&this._onRenderCompleted(e,t)},e}(),C=n("I6O9"),O=n("2q6Q"),w="AdaptiveCardExtensionInitializationFailed",E="AdaptiveCardExtensionLoadFailed",A="Adaptive Card Extension Failure",L=function(){function e(){}return e._createQosExtraData=function(e,t){var n=e.aceData,a=e.deviceContext,r=e.initialDisplayMode,o=e.manifest,s=e.getPositionOnPage,c=e.workloadName,d={alias:o.alias,deviceContext:a,displayMode:r,isInternal:o.isInternal,instanceId:n.instanceIdForLogs?n.instanceIdForLogs:n.instanceId,manifestId:o.id,mpnId:o.mpnId,scenarioId:O._PerformanceLogger.getScenarioId(),storeAppId:o.storeAppId,teamsHosted:i._BrowserUtilities.isTeamsHosted(),isIntentional:!0,cardSize:n.cardSize,workLoad:c};if(s){var l=s();l&&(d.cardPosition=l.componentOrder,d.NumberOfCardsAudienceTargeted=l.numberOfSectionComponents)}return p()||(d.appHostType=t),d},e.prototype.load=function(t){var n,r,o=this,s=i._BrowserUtilities.getTeamsAppType(),c=new a._QosMonitor("AdaptiveCardExtension.Load",!0,!0),d=e._createQosExtraData(t,s),l="WebPart.ACE_".concat(t.manifest.alias,".").concat(t.manifest.isInternal?"internal":"external",".").concat(t.instanceId);return O._PerformanceLogger.startMarkForComponent(l),C.SPComponentLoader.loadComponent(t.manifest).then(function(e){return e.default&&(e=e.default),O._PerformanceLogger.markComponentModuleLoaded(l),new e}).catch(function(e){throw t.manifest.isInternal&&t.initialDisplayMode===i.DisplayMode.Edit&&t.logEditCustomerPromiseFailure&&t.logEditCustomerPromiseFailure(t.manifest.alias,e.message,E),O._PerformanceLogger.endFailureForComponent(l,E,e,void 0,b()?void 0:A),c.writeUnexpectedFailure(E,e,d),n=e,e}).then(function(e){var n,a=t.cacheObject?{state:(n=t.cacheObject).cachedState,cardNavigatorState:n.cardNavigatorState}:void 0;return(r=e)._internalInitialize(o._getContext(t),t.addedFromPersistedData,t.initialDisplayMode,l,!!a,p()?void 0:s),r._internalDeserialize(t.aceData),t.host.onBeforeInitialized(r),r.onInit(a)}).then(function(){O._PerformanceLogger.markComponent(l,"init");var e=m()?d:Object(v.__assign)(Object(v.__assign)({},d),r._aceLoadExtraData);return c.writeSuccess(e),r._internalOnAfterInit(),r}).catch(function(e){if(!n){t.manifest.isInternal&&t.initialDisplayMode===i.DisplayMode.Edit&&t.logEditCustomerPromiseFailure&&t.logEditCustomerPromiseFailure(t.manifest.alias,e.message,w),O._PerformanceLogger.endFailureForComponent(l,w,e,void 0,b()?void 0:A);var a=m()?d:Object(v.__assign)(Object(v.__assign)({},d),null==r?void 0:r._aceLoadExtraData);i._SPKillSwitch.isActivated("20bb1d51-eadf-49ec-8617-c21ae9010ba4")||"SchemaError"!==e.name?c.writeUnexpectedFailure(w,e,a):c.writeExpectedFailure(w,e,a)}throw e})},e.prototype._getContext=function(e){return new I({host:e.host,manifest:e.manifest,instanceId:e.instanceId,parentServiceScope:e.serviceScope,loggingTag:"",deviceContext:e.deviceContext,location:e.location,hostContext:e.hostContext,sdks:e.sdks,logEditCustomerPromiseFailure:e.logEditCustomerPromiseFailure,getPositionOnPage:e.getPositionOnPage})},e}(),k=n("Pk8u"),M=n("mGD9"),P={Medium:1,Large:2};function T(e,t,n,a){var i=function(e,t,n){if(("Image"!==t||"Medium"!==n)&&void 0!==e){for(var a=[],i=Math.min(P[n],e.length),r=0;r<i;r++)_()&&"Execute"===e[r].action.type||a.push(e[r]);return a}}(e,t,n);if(i)return i.map(function(e,t){var n=e.id?e.id:c()?"ac-button-".concat(t):"ac-button-".concat(a,"-").concat(t);return U(e.action,n,e.title,e.style)})}function U(e,t,n,a,r){var o,s;if(!e&&!i._SPKillSwitch.isActivated("ce36fe97-2871-4264-9418-b992195b2dfa"))throw new Error(i.Text.format(M.e,t));if("Submit"===e.type)(s=e).confirmationDialog&&(s.parameters||(s.parameters={}),s.parameters.__MSConfirmationDialog__=s.confirmationDialog),o={id:t,type:"Action.Submit",style:a,title:n,data:e.parameters||void 0};else if("Execute"===e.type)o={id:t,type:"Action.Execute",style:a,title:n,verb:e.verb,data:e.parameters||void 0};else if("ExternalLink"===e.type){var c=e.parameters.target;if(!c||""===c)throw new Error(i.Text.format(M.r,t));o={id:t,type:"Action.OpenUrl",style:a,title:n,url:c}}else"QuickView"===e.type?o={id:t,type:"Action.Submit",style:a,title:n,data:{_internalQuickViewId:e.parameters.view,_target:r}}:"VivaAction.SelectMedia"===e.type?o={id:t,type:"VivaAction.SelectMedia",style:a,title:n,parameters:e.parameters}:"VivaAction.GetLocation"===e.type?o={id:t,type:"VivaAction.GetLocation",style:a,title:n,parameters:e.parameters}:"VivaAction.ShowLocation"===e.type&&(o={id:t,type:"VivaAction.ShowLocation",style:a,title:n,parameters:e.parameters});return o}var F=function(){function e(){}return Object.defineProperty(e.prototype,"cardNavigator",{get:function(){return this._ace.cardNavigator},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"quickViewNavigator",{get:function(){return this._ace.quickViewNavigator},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"properties",{get:function(){return this._properties},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"context",{get:function(){return this._context},enumerable:!1,configurable:!0}),e.prototype.setState=function(e){this._ace.setState(e)},e}(),H=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(v.__extends)(t,e),Object.defineProperty(t.prototype,"cardSize",{get:function(){return this._getCardSize()},enumerable:!1,configurable:!0}),t.prototype.setVisibility=function(e){this._ace.isVisible=e},Object.defineProperty(t.prototype,"onCardSelection",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isCacheEnabled",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.onAction=function(e){},t.prototype.onActionError=function(e){},t}(F);function R(e){return Object(v.__assign)(Object(v.__assign)({},e),{componentName:"cardButton"})}function N(e){return{componentName:"cardButton",title:e.title,action:e.action,style:"destructive"===e.style?void 0:e.style,id:e.id}}var B=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(v.__extends)(t,e),Object.defineProperty(t.prototype,"cardButtons",{get:function(){},enumerable:!1,configurable:!0}),t.prototype._getTemplate=function(e,t){return Object(k.cloneDeep)(this.onCardSelection?t:e)},t.prototype._getGenericCardViewFooterConfiguration=function(){var e=this.cardButtons;if(e)return 1===e.length?N(e[0]):e.length>2?e.splice(0,2).map(function(e){return N(e)}):e.map(function(e){return N(e)})},t.prototype._getCardBarConfiguration=function(){var e=this.data,t=e.title,n=e.iconProperty,a=e.iconAltText,i=e._iconPropertyFallback;return{componentName:"cardBar",title:t||this._ace.title,icon:{url:n||this._ace.iconProperty,altText:a,_urlFallback:i}}},t}(H);function j(e,t,n,a){return n.id||"".concat(e,"-").concat(t,"-").concat(a,"-").concat(n.componentName)}var V="auto",z={type:"TextBlock",subType:"Primary",text:"${primaryText}",weight:"Bolder",maxLines:1,spacing:"none"},G={type:"TextBlock",subType:"BodySecondary",text:"${description}",spacing:"none",wrap:!0},K={type:"TextBlock",subType:"BodyPrimary",text:"${primaryText}",spacing:"none",wrap:!0},W={type:"TextBlock",subType:"Title",text:"${title}",wrap:!1,maxLines:1,spacing:"none"},q=function(e,t){var n={type:"ColumnSet",columns:[]};if(e.iconBefore&&n.columns.push({type:"Column",width:16,spacing:"none",items:[{type:"Icon",iconProperty:"${iconBeforeProperty}",altText:"${iconBeforeAltText}"}]}),n.columns.push({type:"Column",width:"stretch",spacing:"none",items:[{type:"Input.Text",placeholder:e.placeholder,value:e.defaultValue,id:"".concat(t,"-input")}]}),e.iconAfter&&n.columns.push({type:"Column",width:"16px",spacing:"none",items:[{type:"Icon",iconProperty:"${iconAfterProperty}",altText:"${iconAfterAltText}"}]}),e.button){var a=e.button;if(null==a?void 0:a.icon)n.columns.push({type:"Column",width:24,spacing:"small",items:[{type:"Icon",iconProperty:"${buttonIconProperty}",altText:"${buttonIconAltText}"}],selectAction:U(a.action,a.id||"".concat(t,"-input-button"))});else{var i=a;n.columns.push({type:"Column",width:"auto",spacing:"small",items:[{type:"ActionSet",actions:[U(i.action,i.id||"".concat(t,"-input-button"),i.title,"positive")]}]})}}return n},Q={$schema:"http://adaptivecards.io/schemas/adaptive-card.json",type:"AdaptiveCard",version:"1.2",body:[{type:"Container",items:[{type:"ColumnSet",columns:[{type:"Column",spacing:"none",items:[{type:"Icon",iconProperty:"${iconProperty}",altText:"${iconAltText}"}],width:V},{type:"Column",spacing:"none",items:[W],width:"stretch"}]},K]}]},Y={$schema:"http://adaptivecards.io/schemas/adaptive-card.json",type:"AdaptiveCard",version:"1.2",body:[{type:"Container",items:[{type:"Image",url:"${imageUrl}",altText:"${imageAltText}"},{type:"ColumnSet",spacing:"none",columns:[{type:"Column",items:[{type:"Icon",iconProperty:"${iconProperty}",altText:"${iconAltText}"}],width:V},{type:"Column",spacing:"none",items:[W],width:"stretch"}]},K]}]},J={$schema:"http://adaptivecards.io/schemas/adaptive-card.json",type:"AdaptiveCard",version:"1.2",body:[{type:"Container",items:[{type:"ColumnSet",columns:[{type:"Column",spacing:"none",items:[{type:"Icon",iconProperty:"${iconProperty}",altText:"${iconAltText}"}],width:V},{type:"Column",spacing:"none",items:[W],width:"stretch"}]},{type:"Container",spacing:"none",items:[z,G]}]}]},X={$schema:"http://adaptivecards.io/schemas/adaptive-card.json",type:"AdaptiveCard",version:"1.2",body:[{type:"Container",selectAction:"${selectAction}",items:[{type:"Image",url:"${imageUrl}",altText:"${imageAltText}"},{type:"ColumnSet",spacing:"none",columns:[{type:"Column",items:[{type:"Icon",iconProperty:"${iconProperty}",altText:"${iconAltText}"}],width:V},{type:"Column",spacing:"none",items:[W],width:"stretch"}]},K]}]},Z={$schema:"http://adaptivecards.io/schemas/adaptive-card.json",type:"AdaptiveCard",version:"1.2",body:[{type:"Container",selectAction:"${selectAction}",items:[{type:"ColumnSet",columns:[{type:"Column",spacing:"none",items:[{type:"Icon",iconProperty:"${iconProperty}",altText:"${iconAltText}"}],width:V},{type:"Column",spacing:"none",items:[W],width:"stretch"}]},{type:"Container",spacing:"none",items:[z,G]}]}]},$={$schema:"http://adaptivecards.io/schemas/adaptive-card.json",type:"AdaptiveCard",version:"1.2",body:[{type:"Container",selectAction:"${selectAction}",items:[{type:"ColumnSet",columns:[{type:"Column",spacing:"none",items:[{type:"Icon",iconProperty:"${iconProperty}",altText:"${iconAltText}"}],width:V},{type:"Column",spacing:"none",items:[W],width:"stretch"}]},K]}]};function ee(e,t,n,a,s,d,l,u,f){var p,m,h,b,g=e.onCardSelection,y=i._SPKillSwitch.isActivated("d2cb3786-200c-408f-a646-6d091eadc1be")?e._getCardViewParameters():function(e,t){return te(e,"cardBar",t.cardBar),te(e,"header",t.header),te(e,"body",t.body),te(e,"footer",t.footer),t}(u,e._getCardViewParameters()),S="Basic";if(e instanceof B?(p=e.cardButtons,m=e.data,h=e.template,S=e._templateType):("Mobile"===n||sessionStorage.getItem("spfx-debug"))&&(S=y.image?"Image":"Basic",y.footer&&y.footer.length&&"cardButton"===y.footer[0].componentName&&(p=y.footer.map(function(e){return{title:(t=e).title,action:t.action,style:t.style,id:t.id};var t})),m=function(e){var t,n,a,i,r,o,s=e.cardBar,c=e.image,d=e.header,l=e.body,u=e.footer,f={title:s[0].title,iconProperty:null===(t=s[0].icon)||void 0===t?void 0:t.url,iconAltText:null===(n=s[0].icon)||void 0===n?void 0:n.altText,_iconPropertyFallback:null===(a=s[0].icon)||void 0===a?void 0:a._urlFallback};if(d&&d.length&&(f.primaryText=d[0].text),c){var p=f;p.imageUrl=c.url,p.imageAltText=c.altText,p._imageUrlFallback=c._urlFallback}if(l&&l.length)switch(l[0].componentName){case"text":var m=l[0];f.description=m.text;break;case"searchBox":f=Object(v.__assign)(Object(v.__assign)({},f),{placeholder:(i=l[0]).placeholder||"",defaultValue:i.defaultValue||""});break;default:f=Object(v.__assign)(Object(v.__assign)({},f),ne(l[0]))}if(u&&u.length)switch(u[0].componentName){case"searchFooter":f=Object(v.__assign)(Object(v.__assign)({},f),(o=(r=u[0]).title,{footerImageUrl:r.imageUrl||"",footerTitle:o,footerText:r.text}));break;case"textInput":f=Object(v.__assign)(Object(v.__assign)({},f),ne(u[0]))}return f}(y),a||(h=function(e,t,n,a){var i=e.body,r=e.footer,o=e.image;if(i&&i.length)switch(i[0].componentName){case"textInput":return function(e,t,n,a){var i=Object(k.cloneDeep)(e.image?Y:Q),r=e.body[0];return t&&(i.body[0].selectAction="${selectAction}"),e.image&&"Medium"===n||i.body[0].items.push(q(r,j(a,"body",r,0))),i}(e,t,n,a);case"searchBox":return function(e,t,n){var a=Object(k.cloneDeep)(Q),i=e.body[0],r=e.footer&&e.footer[0];return t&&(a.body[0].selectAction="${selectAction}"),a.body[0].items.push(function(e,t){var n={type:"ColumnSet",columns:[]};n.columns.push({type:"Column",width:"stretch",spacing:"none",items:[{type:"Input.Text",placeholder:e.placeholder,value:e.defaultValue,id:"".concat(t,"-searchbox")}]});var a=e.button;return n.columns.push({type:"Column",width:"auto",spacing:"small",items:[{type:"ActionSet",actions:[U(a.action,a.id||"".concat(t,"-searchbox-button"),M.i,"positive")]}]}),n}(i,i.id||"".concat(i.componentName,"-").concat(n,"-body-0"))),r&&a.body[0].items.push(function(e,t){var n={type:"ColumnSet",columns:[],selectAction:e.onSelection?U(e.onSelection,t):void 0};n.columns.push({type:"Column",width:"auto",items:[{type:"Image",style:"Person",url:"${footerImageUrl}",height:"24px",width:"24px"}]}),n.columns.push({type:"Column",width:"stretch",items:[{type:"TextBlock",weight:"Bolder",text:"${footerText}",wrap:!1}]});var a={type:"Container",items:[]};return a.items.push({type:"TextBlock",text:"${footerTitle}",wrap:!1,size:"Small",isSubtle:!0}),a.items.push(n),a}(r,j(n,"footer",r,0))),a}(e,t,a)}return r&&1===r.length&&"textInput"===r[0].componentName?function(e,t,n){var a=void 0;a=e.image?Object(k.cloneDeep)(Y):e.body?Object(k.cloneDeep)(J):Object(k.cloneDeep)(Q),t&&(a.body[0].selectAction="${selectAction}");var i=e.footer[0];return a.body[0].items.push(q(i,j(n,"footer",i,0))),a}(e,t,a):o?t?X:Y:i&&i.length?t?Z:J:t?$:Q}(y,!!g,t,u))),a||(a=h),a&&(r()&&(void 0===p||"Image"===S&&"Large"!==t)||function(e,t,n,a,i){if(r()){u=[];for(var o=Math.min(P[n],(null==t?void 0:t.length)||0),s=0;s<o;s++){var d=t[s],l=d.id?d.id:c()?"ac-button-".concat(s):"ac-button-".concat(i,"-").concat(s);u.push(U(d.action,l,d.title,d.style))}e.actions=u}else{var u;(u=t&&T(t,a,n,i))&&(e.actions=u)}}(a,p,t,S,u)),g){var D=U(g,"select-action");(!_()&&"Action.Execute"===D.type||"Action.OpenUrl"===D.type||"Action.Submit"===D.type||"VivaAction.GetLocation"===D.type||"VivaAction.ShowLocation"===D.type||"VivaAction.SelectMedia"===D.type)&&(b=D)}"Image"===e._templateType&&void 0===m.imageAltText&&(m.imageAltText=o()?"":i.Text.format(M.a,l.alias));var I=i._SPKillSwitch.isActivated("60de4d2f-cafc-48bc-a95f-27b630e60daf")?Object(v.__assign)({selectAction:b,iconProperty:s,iconAltText:o()?(null==m?void 0:m.iconAltText)||M.t:(null==m?void 0:m.iconAltText)||i.Text.format(M.n,l.alias),title:d,actionButtons:"Mobile"!==n?T(p,S,t,u):void 0},m):Object(v.__assign)(Object(v.__assign)({selectAction:b,iconProperty:s,title:d,actionButtons:"Mobile"!==n?T(p,S,t,u):void 0},m),{iconAltText:o()?(null==m?void 0:m.iconAltText)||M.t:(null==m?void 0:m.iconAltText)||i.Text.format(M.n,l.alias)}),x={iconProperty:(null==m?void 0:m.iconProperty)||s,size:t,title:(null==m?void 0:m.title)||d,templateType:S,cardViewId:i._SPKillSwitch.isActivated("f34f1dc6-aefd-4c08-8530-f4ad7e7ad0d4")?void 0:f};return i._SPKillSwitch.isActivated("bf5fcd98-4eb8-4768-9c33-6690cc5693e3")||(x.defaultIconAltText=i.Text.format(M.n,l.alias),x.selectAction=b,x.defaultImageAltText=y.image?i.Text.format(M.a,l.alias):void 0),{data:I,template:a,cardViewParameters:y,cardProperties:x}}function te(e,t,n){n&&n.forEach(function(n,a){if(n.id=j(e,t,n,a),"searchBox"===n.componentName||"textInput"===n.componentName){var i=n.button;i&&!i.id&&(i.id="".concat(n.id,"-button"))}})}function ne(e){var t,n={placeholder:e.placeholder||"",defaultValue:e.defaultValue||""};if(e.iconBefore&&(n.iconBeforeProperty=e.iconBefore.url,n.iconBeforeAltText=e.iconBefore.altText,n._iconBeforeUrlFallback=e.iconBefore._urlFallback),e.iconAfter&&(n.iconAfterProperty=e.iconAfter.url,n.iconAfterAltText=e.iconAfter.altText,n._iconAfterUrlFallback=e.iconAfter._urlFallback),e.button&&(null===(t=e.button)||void 0===t?void 0:t.icon)){var a=e.button;n.buttonIconProperty=a.icon.url,n.buttonIconAltText=a.icon.altText,n._buttonIconUrlFallback=a.icon._urlFallback}return n}var ae=function(){function e(e,t,n,a,i,r){this._context=e,this._getCardSize=t,this._getIconProperty=n,this._getTitle=a,this._handleInitializeCallback=i,this._settings=Object(v.__assign)(Object(v.__assign)({},this._defaultCacheSettings()),r)}return e.prototype.save=function(e,t,n,a,i,r,o,s){var c,d;if(this._settings.isEnabled){var l=this._initializeCustomCardView();if(l&&l.isCacheEnabled||!l&&n.isCacheEnabled){var u=l?ee(l,this._getCardSize(),this._context.deviceContext,void 0,this._getIconProperty(),this._getTitle(),o,t,s):a.card;d=this._createCacheObject(a,u,i,r),null===(c=this._context._host.cache)||void 0===c||c.save(e,t,d)}}return d},e.prototype._createCacheObject=function(e,t,n,a){return{cachedCard:t,cardNavigatorState:n,isVisible:e.isVisible,cachedState:a,expirationTime:(new Date).getTime()+1e3*this._settings.expiryTimeInSeconds}},e.prototype._initializeCustomCardView=function(){if(this._settings.cachedCardView){var e=this._settings.cachedCardView();return this._handleInitializeCallback(e),e}},e.prototype._defaultCacheSettings=function(){return{isEnabled:!0,expiryTimeInSeconds:e.CACHE_EXPIRATION_TIME,cachedCardView:void 0}},e.CACHE_EXPIRATION_TIME=864e3,e}();function ie(){return i._SPFlight.isEnabled(60236)}function re(e){return Object(v.__assign)(Object(v.__assign)({},e),{componentName:"cardBar"})}function oe(e){return Object(v.__assign)(Object(v.__assign)({},e),{componentName:"text"})}function se(e){return Object(v.__assign)(Object(v.__assign)({},e),{componentName:"textInput"})}function ce(e){var t=e.cardBar,n=e.header,a=e.footer;return{cardViewType:"text",image:void 0,body:void 0,cardBar:[re(t)],header:[oe(n)],footer:pe(a)}}function de(e){var t=e.cardBar,n=e.header,a=e.body,i=e.footer;return{cardViewType:"text",image:void 0,cardBar:[re(t)],header:[oe(n)],body:[oe(a)],footer:pe(i)}}function le(e){var t=e.image,n=e.cardBar,a=e.header,i=e.footer;return{cardViewType:"text",image:t,cardBar:[re(n)],header:[oe(a)],body:void 0,footer:pe(i)}}function ue(e){var t=e.cardBar,n=e.header,a=e.body,i=e.footer;return{cardViewType:"textInput",image:void 0,cardBar:[re(t)],header:[oe(n)],body:[se(a)],footer:pe(i)}}function fe(e){var t=e.cardBar,n=e.header,a=e.body,i=e.footer;return{cardViewType:"textInput",image:e.image,cardBar:[re(t)],header:[oe(n)],body:[se(a)],footer:pe(i)}}function pe(e){if(e)return Array.isArray(e)?e.map(function(e){return R(e)}):"textInput"===e.componentName?[se(e)]:[R(e)]}var me,_e=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._templateType="Basic",t}return Object(v.__extends)(t,e),t.prototype._getCardViewParameters=function(){var e=this.data,t=ce({cardBar:this._getCardBarConfiguration(),header:{componentName:"text",text:e.primaryText},footer:this._getGenericCardViewFooterConfiguration()});return t.cardViewType="basic-template",t},Object.defineProperty(t.prototype,"template",{get:function(){return this._getTemplate(Q,$)},enumerable:!1,configurable:!0}),t}(B),he=function(e){function t(t){var n=e.call(this)||this;return n._templateType="Basic",n._primaryText=t,n}return Object(v.__extends)(t,e),Object.defineProperty(t.prototype,"data",{get:function(){return{primaryText:this._primaryText}},enumerable:!1,configurable:!0}),t}(_e),be=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(v.__extends)(t,e),Object.defineProperty(t.prototype,"externalLink",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"title",{get:function(){return""},enumerable:!1,configurable:!0}),t}(F),ge=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._viewType="AdaptiveCardQuickView",t}return Object(v.__extends)(t,e),Object.defineProperty(t.prototype,"data",{get:function(){return{}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"focusParameters",{get:function(){},enumerable:!1,configurable:!0}),t.prototype.onAction=function(e){},t.prototype.onActionError=function(e){},t}(be),ve=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(v.__extends)(t,e),t}(ge),ye=/\{(\d+)\}/g,Se=function(){function e(){this._registeredCallbacks=new Map}return e.prototype.register=function(e,t){this._registeredCallbacks.has(e)||this._registeredCallbacks.set(e,t)},e.prototype.consume=function(e){var t=this._registeredCallbacks.get(e);if(!t)throw new Error(function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.replace(ye,function(e,n){return null===t[n]?"":""+t[n]})}("View with id {0} must be registered before being used",e));return this._registeredCallbacks.delete(e),t},Object.defineProperty(e.prototype,"size",{get:function(){return this._registeredCallbacks.size},enumerable:!1,configurable:!0}),e}(),De=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(v.__extends)(t,e),Object.defineProperty(t.prototype,"data",{get:function(){return{}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"template",{get:function(){return{}},enumerable:!1,configurable:!0}),t}(ge),Ie=function(){function e(e,t){this._handleStackChangedCallback=e,this._handleInitializeCallback=t,this._viewStack=new Array,this._viewCache=new Map,this._viewRegistry=new Se}return e.prototype.register=function(e,t){this._viewRegistry.register(e,t)},e.prototype.push=function(e,t){void 0===t&&(t=!1),this._push(e),this._handleStackChangedCallback(t)},e.prototype.replace=function(e,t){void 0===t&&(t=!1),this._pop(),this._push(e),this._handleStackChangedCallback(t)},e.prototype.pop=function(e){void 0===e&&(e=!1),this.size>1&&(this._pop(),this._handleStackChangedCallback(e))},Object.defineProperty(e.prototype,"size",{get:function(){return this._viewStack.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentId",{get:function(){var e=this.size;return e?this._viewStack[e-1]:void 0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_currentView",{get:function(){return this._viewCache.get(this._viewStack[this.size-1])},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewStack",{get:function(){return this._viewStack},enumerable:!1,configurable:!0}),e.prototype._clear=function(){this._viewStack=[]},e.prototype._forEach=function(e){this._viewCache.forEach(e)},e.prototype._getRegistrySize=function(){return this._viewRegistry.size},e.prototype._push=function(e){var t=this;if(void 0===this._viewCache.get(e)){var n=this._viewRegistry.consume(e)();n instanceof Promise?(n.then(function(n){t._handleInitializeCallback(n),t._viewCache.set(e,n),t._handleStackChangedCallback(!1)}).catch(function(e){console.error("could not load quickview",e)}),n=new De):n=n,this._handleInitializeCallback(n),this._viewCache.set(e,n)}this._viewStack.push(e)},e.prototype._pop=function(){this._viewStack.pop()},e}(),xe=function(e){function t(t,n,a){var i=e.call(this,t,n)||this;return i._closeQuickViewCallback=a,i}return Object(v.__extends)(t,e),t.prototype.close=function(){this._closeQuickViewCallback()},t}(Ie),Ce=function(){function e(){}return e.prototype.get=function(e,t){return this.getFromSource(e,t).then(function(e){if(i._SPKillSwitch.isActivated("63a9cba3-4d6e-44a7-bdfb-3464aeb6a4a4"))return e&&(new Date).getTime()<e.expirationTime?e:void 0;var t=new a._QosMonitor("ACECache.Get");return e&&(new Date).getTime()<e.expirationTime?(t.writeSuccess(),e):void t.writeExpectedFailure(e?"CacheExpired":"CacheMiss")})},e}(),Oe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._cachedMap=new Map,t}return Object(v.__extends)(t,e),t.getKey=function(e,t){return"AdaptiveCardExtension_LKG_".concat(e,"_").concat(t)},Object.defineProperty(t,"instance",{get:function(){return void 0===this._instance&&(this._instance=new t),this._instance},enumerable:!1,configurable:!0}),t.prototype.save=function(e,t,n){var i=new a._QosMonitor("ACE.LocalStorage.save");try{var r=this._getLocalStorageEntry(e);r.set(t,n);var o=Array.from(r.entries());localStorage.setItem(e,JSON.stringify(o)),i.writeSuccess()}catch(e){var s=n.cachedCard.cardProperties.title||"";i.writeUnexpectedFailure("",e,{alias:s,instanceId:t})}},t.prototype.getFromSource=function(e,t){var n=new a._QosMonitor("ACE.LocalStorage.get");try{var i=this._getLocalStorageEntry(e).get(t);return i?n.writeSuccess():n.writeExpectedFailure("cacheMiss",void 0,{instanceId:t}),Promise.resolve(i)}catch(e){return n.writeUnexpectedFailure("",e,{instanceId:t}),Promise.resolve(void 0)}},t.prototype._getLocalStorageEntry=function(e){var t=this._cachedMap.get(e);if(t)return t;var n=localStorage.getItem(e),a=n?new Map(JSON.parse(n)):new Map;return this._cachedMap.set(e,a),a},t}(Ce),we="AdaptiveCardExtension.CardAction",Ee=new Set(["AppChrome.PageOpenedInTeamsVivaConnections1PAppContext","TeamsSiteHeader.RefreshButtonClicked","TeamsSiteHeader.CopyLinkButtonClicked.successful","TeamsSiteHeader.GoToBrowserButtonClicked","SPO.DashboardWebPart.Load",we,"TeamsNavigation.Navigation.ClickedInTeamsviva1pAppContext"]),Ae=(function(){function e(){}e.isVivaConnectionsAnalyticsEngagementEvent=function(e){return Ee.has(e)},e.getQoSEventFromEngagementEvent=function(e){if(this.isVivaConnectionsAnalyticsEngagementEvent(e))return"QoS."+e}}(),"d2c6f111-ffad-42a0-b65e-ee00425598aa"),Le=function(e){function t(){var t=e.call(this)||this;return t._isLoggedRenderPerf=!1,t._isInitialized=!1,t._isInitializedWithLKG=!1,t._isUpdating=!1,t._getCard=function(e){try{return ee(t.cardNavigator._currentView,t.cardSize,t.context.deviceContext,e?t._ACRenderArgs.card.template:void 0,t.iconProperty,t.title,t.manifest,t.instanceId,t.cardNavigator.currentId)}catch(e){throw t.context._host.onError(e.toString()),e}},t._assignAndRenderHTMLQuickView=function(e){var n=t.quickViewNavigator._currentView,i=new a._QosMonitor("ACE.HTMLQuickView.Render");try{if(void 0===n||"AdaptiveCardQuickView"===n._viewType)return void i.writeExpectedFailure("IncorrectQVType",void 0,{viewType:n._viewType});n._setDomElement(e),n.render(),i.writeSuccess()}catch(e){i.writeUnexpectedFailure("FailedToRender",e)}},t._disposeHTMLQuickView=function(e){var t=new a._QosMonitor("ACE.HTMLQuickView.Dispose");try{if(void 0===e||"AdaptiveCardQuickView"===e._viewType)return void t.writeExpectedFailure("IncorrectQVType",void 0,{viewType:e._viewType});e.dispose(),e._setDomElement(void 0),t.writeSuccess()}catch(e){t.writeUnexpectedFailure("FailedToDispose",e)}},t._onViewInitialized=function(e){t._initializeCardView(e)},t._onQuickViewInitialized=function(e){t._initializeBaseView(e)},t._navigatorCallback=function(e){e||t.update(t._renderType)},t._closeQuickViewCallback=function(){t.context._host.requestRenderTypeChange("Card",t.instanceId)},t._cardSize="Medium",t._renderType="Card",t._isVisible=!0,t._urlParams=new URLSearchParams(window.location.search),f()&&(t._cardNavigator=new Ie(t._navigatorCallback,t._onViewInitialized),t._quickViewNavigator=new xe(t._navigatorCallback,t._onQuickViewInitialized,t._closeQuickViewCallback)),t}return Object(v.__extends)(t,e),Object.defineProperty(t.prototype,"cardNavigator",{get:function(){return this._cardNavigator||f()||(this._cardNavigator=this._initializeCardNavigator()),this._cardNavigator},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cardSize",{get:function(){return this._cardSize},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataVersion",{get:function(){return i.Version.parse("1.0")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"description",{get:function(){return this._description},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"displayMode",{get:function(){return this._displayMode},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"properties",{get:function(){return this._properties},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"siteId",{get:function(){return this.context.pageContext.site.id.toString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"itemId",{get:function(){var e;return null===(e=this.context.pageContext.listItem)||void 0===e?void 0:e.uniqueId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"mySiteCacheEnabled",{get:function(){return(i._SPFlight.isEnabled(60399)||1===i._SPExperiment.getVariantAndLogExposure(90148))&&(i._SPKillSwitch.isActivated("5c806b76-07fd-4ea8-afce-10c676a1739e")||!i._BrowserUtilities.isVivaHome())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"quickViewNavigator",{get:function(){return this._quickViewNavigator||f()||(this._quickViewNavigator=this._initializeQuickViewNavigator()),this._quickViewNavigator},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderedFromPersistedData",{get:function(){return this._renderedFromPersistedData},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderedOnce",{get:function(){return this._renderedOnce},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderType",{get:function(){return this._renderType},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"propertiesMetadata",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isRenderAsync",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this._state},set:function(e){if(this._state)throw new Error("state can only be initialized once");this._state=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"title",{get:function(){return this._title},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_aceLoadExtraData",{get:function(){return{}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_cardActionEngagementExtraData",{get:function(){return{}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"iconProperty",{get:function(){return this._iconProperty},enumerable:!1,configurable:!0}),t.prototype.getPropertyPaneConfiguration=function(){return{pages:[]}},t.prototype.loadPropertyPaneResources=function(){return Promise.resolve()},t.prototype.getCacheSettings=function(){return{}},t.prototype.getCachedState=function(e){return{}},t.prototype.onNotificationReceived=function(e){},t.prototype.onBeforeAction=function(e){},t.prototype._onBeforeAction=function(e,t,n,a,i){if(!_()||"Execute"!==e.type){this._logCardActionEngagement(e.type,t,n,a,i),h()||this._beginUpdate();try{this.onBeforeAction(e)}finally{h()||this._endUpdate()}}},t.prototype._internalOnAction=function(e){var t=this.navigator._currentView;if(!t||!t.onAction){var n=new Error("_internalOnAction is called for non-actionable ACE view");throw this._logInternalOnActionError(n,"internalOnActionFailure"),n}_()&&"Execute"===e.type||t.onAction(e)},t.prototype._internalOnActionError=function(e){var t=this.navigator._currentView;if(!t||!t.onActionError){var n=new Error("_internalOnActionError is called for non-actionable ACE view");throw this._logInternalOnActionError(n,"internalOnActionErrorFailure"),n}t.onActionError(e)},t.prototype.onBeforeSerialize=function(){},t.prototype.onAfterPropertiesUpdatedExternally=function(e){},t.prototype.onAfterDeserialize=function(e,t){return e},t.prototype.onDisplayModeChanged=function(e){},t.prototype.onDispose=function(){},t.prototype.onInit=function(e){return Promise.resolve()},t.prototype._initializeCardNavigator=function(){return new Ie(this._navigatorCallback,this._onViewInitialized)},t.prototype._initializeQuickViewNavigator=function(){return new xe(this._navigatorCallback,this._onQuickViewInitialized,this._closeQuickViewCallback)},t.prototype.onPropertyPaneFieldChanged=function(e,t,n){},t.prototype.onRenderTypeChanged=function(e){},t.prototype.renderCard=function(){},t.prototype._getPreFrameworkPropertyPaneConfiguration=function(){return[]},Object.defineProperty(t.prototype,"_isFrameworkPropertyPaneEnabled",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isVisible",{get:function(){return this._isVisible},set:function(e){this._isVisible=e,this._isInitialized&&(this.cardNavigator._getRegistrySize()>0||this.cardNavigator._currentView)&&this.context._host.onVisibilityChanged(this._getRenderArguments(this.renderType))},enumerable:!1,configurable:!0}),t.prototype.renderCompleted=function(e){this._renderCompletedPromiseResolver&&this._renderCompletedPromiseResolver(e)},t.prototype._endMarkForRenderComplete=function(e,t){var n=new a._QosMonitor("AdaptiveCardExtension.RenderCompleted");this._isLoggedRenderPerf||(e?t?O._PerformanceLogger.endFailureForComponent(this._perfTagName,"TimeOut",void 0,void 0,b()?void 0:A):O._PerformanceLogger.endMarkForComponent(this._perfTagName):O._PerformanceLogger.endMarkForComponentWithTimestamp(this._perfTagName,this._lkgRenderTime),this._isLoggedRenderPerf=!0);var i=D._WebPartLoadDataCollector.collect(this.context.manifest,this._perfTagName,this.context.pageContext),r=Object(v.__assign)(Object(v.__assign)({},i),{isInternal:this.manifest.isInternal||!1,isInitializedWithLKG:this._isInitializedWithLKG,didTimeOut:t,didUpdate:e,displayMode:this.displayMode});t?n.writeUnexpectedFailure("",void 0,r):n.writeSuccess(r),this.context._host.onRenderCompleted(this.instanceId,e),this._clearRenderCompletedGuardTimer()},t.prototype._resolveRenderCompleted=function(){var e=this;this._renderCompletedPromise.then(function(t){e._endMarkForRenderComplete(t,!1)}).catch(function(){e._endMarkForRenderComplete(!0,!0)})},t.prototype.setState=function(e){this._internalSetState(e,!0)},t.prototype._internalSetState=function(e,t){if(void 0===t&&(t=!0),!this._state)throw new Error("state must be initialized before calling setState");e&&(this._state=Object(v.__assign)(Object(v.__assign)({},this.state),Object(k.cloneDeep)(e)),this.cardNavigator._forEach(this._onViewInitialized),this.quickViewNavigator._forEach(this._onQuickViewInitialized)),this._isInitialized&&(h()||!this._isUpdating)&&t&&this.context._host.update(this._getRenderArguments(this._renderType))},t.prototype.update=function(e,t){void 0===t&&(t=!1);var n=this._getRenderArguments(e,t);this.context._host.update(n)},t.prototype._getRenderArguments=function(e,t,n){var r,o=this;void 0===t&&(t=!1);var s=new a._QosMonitor("AdaptiveCardExtension.GetRenderArguments.".concat(e));try{if(!this._isInitialized)throw s.writeUnexpectedFailure("ACE is not initialized"),new Error("".concat(this.context.manifest.alias," is not initialized"));if(this._setRenderType(e,n),"Card"===e&&0===this.cardNavigator.size){var c=this.renderCard();c||(c="_InternalDefaultCardView",this.cardNavigator.register(c,function(){return new he(o.description)})),this.cardNavigator.push(c,!0)}if(void 0===this._ACRenderArgs?this._ACRenderArgs={card:"Card"===e?this._getCard(t):void 0,isVisible:this._isVisible,instanceId:this.instanceId,lastUpdatedType:e,quickLook:"QuickView"===e?this._getQuickView(t):void 0}:this._updateRenderArgs(e,t),(!i._SPKillSwitch.isActivated("b8c50ded-d048-4eb9-bc41-21190d9d3bbb")&&this.context.manifest.isolatedDomain||this.displayMode===i.DisplayMode.Read)&&"Card"===e){var d=null===(r=this._cacheManager)||void 0===r?void 0:r.save(this._cacheKey,this.instanceId,this.cardNavigator._currentView,this._ACRenderArgs,this.cardNavigator.viewStack,this.getCachedState(Object(v.__assign)({},this._state)),this.manifest,this.cardNavigator.currentId);this._ACRenderArgs.cacheObject=d}var l=void 0;this._isLoggedRenderPerf||this.isRenderAsync||(O._PerformanceLogger.endMarkForComponent(this._perfTagName),l=D._WebPartLoadDataCollector.collect(this.context.manifest,this._perfTagName,this.context.pageContext),this._isLoggedRenderPerf=!0,this.context._host.onRenderCompleted(this.instanceId,!0)),l=Object(v.__assign)(Object(v.__assign)({},l),{isInternal:this.manifest.isInternal||!1,displayMode:this.displayMode}),s.writeSuccess(l)}catch(e){if(l=void 0,this._isLoggedRenderPerf||(O._PerformanceLogger.endFailureForComponent(this._perfTagName,"Render",e,void 0,b()?void 0:A),l=D._WebPartLoadDataCollector.collect(this.context.manifest,this._perfTagName,this.context.pageContext),this._isLoggedRenderPerf=!0,this.context._host.onRenderCompleted(this.instanceId,!0)),s.writeUnexpectedFailure("failedGetRenderArguments",e,Object(v.__assign)(Object(v.__assign)({},l),{alias:this.context.manifest.alias,deviceContext:this.context.deviceContext,instanceId:this.instanceId,isInternal:this.manifest.isInternal||!1,manifestId:this.context.manifest.id,displayMode:this.displayMode})),this.manifest.isInternal&&this.displayMode===i.DisplayMode.Edit&&this.context._logEditCustomerPromiseFailure(this.manifest.alias,e.message,"AdaptiveCardExtensionGetRenderArgumentsFailed"),!i._SPKillSwitch.isActivated("04fc0392-7564-42c1-9bb4-37b2844d13c6"))throw e}return this._ACRenderArgs},t.prototype._propertiesMetadata=function(){return this.propertiesMetadata},t.prototype._getPropertyPaneConfiguration=function(){return this.getPropertyPaneConfiguration()},Object.defineProperty(t.prototype,"navigator",{get:function(){return"Card"===this.renderType?this.cardNavigator:this.quickViewNavigator},enumerable:!1,configurable:!0}),t.prototype._internalDeserialize=function(e){e.title&&(this._title=e.title),e.iconProperty&&(this._iconProperty=e.iconProperty),e.description&&(this._description=e.description),e.cardSize&&(this._cardSize=e.cardSize);var t=e.properties;this.renderedFromPersistedData&&(D._PropertyMetadataProcessor.reInstateServerProcessedData(this.propertiesMetadata,t,e.serverProcessedContent),e.serverProcessedContent=void 0),this._properties?Object.assign(this._properties,t):this._properties=this.onAfterDeserialize(t,e.dataVersion?i.Version.parse(e.dataVersion):this.dataVersion),this.isRenderAsync&&this._startRenderCompletedGuardTimer(),this._cacheKey=this._generateCacheKey(e.dashboardWebPartInstanceId),this._instanceIdForLogs=e.instanceIdForLogs?e.instanceIdForLogs:e.instanceId,this._dashboardUniqueId=e.dashboardUniqueId},t.prototype._internalInitialize=function(t,n,a,i,r,o){var s=this;e.prototype._initializeContext.call(this,t),this._displayMode=a,this._renderedOnce=!1,this._renderedFromPersistedData=n,this._cacheManager=new ae(this.context,function(){return s.cardSize},function(){return s.iconProperty},function(){return s.title},this._onViewInitialized,this.getCacheSettings()),this._perfTagName=i,this._isInitializedWithLKG=r,p()||(this._appHostType=o)},t.prototype._internalSetDisplayMode=function(e){if(this._displayMode!==e){var t=this._displayMode;this._displayMode=e,this.onDisplayModeChanged(t)}},t.prototype._loadPropertyPaneResources=function(){return this.loadPropertyPaneResources()},t.prototype._onPropertyPaneFieldChanged=function(e,t,n){Object(k.isEqual)(t,n)||(this._updateProperty(e,n),this.onPropertyPaneFieldChanged(e,t,n))},t.prototype._renderCompleted=function(){this._renderedOnce=!0},t.prototype._internalOnAfterInit=function(){this._isInitialized=!0,this.isRenderAsync&&(this._lkgRenderTime=O._PerformanceLogger.now())},t.prototype._internalSerialize=function(){return this.onBeforeSerialize(),{dataVersion:this.dataVersion.toString(),id:this.componentId,instanceId:this.instanceId,properties:this.properties,title:this.title,description:this._description,iconProperty:this.iconProperty,cardSize:this._cardSize}},t.prototype._setRenderType=function(e,t){if(this._renderType!==e){var n=this._renderType;"QuickView"===n&&this.quickViewNavigator._clear(),"Card"===n&&(this.quickViewNavigator._clear(),void 0!==t&&this.quickViewNavigator.push(t,!0)),this._renderType=e,this.onRenderTypeChanged(n)}},t.prototype._updateConfigurableFields=function(e,t){"cardSize"===e&&(this._cardSize=t)},t.prototype._logCardActionEngagement=function(e,t,n,a,r){var o,s,c,d,f,p,_,h,b,g,y,S,D,I;if(i._SPKillSwitch.isActivated("f530e9d6-0952-46f2-9d43-5871b6ce1168")){var x,C={};if(this.context._getPositionOnPage){var O=this.context._getPositionOnPage();O&&(C.cardPosition=O.componentOrder,C.NumberOfCardsAudienceTargeted=O.numberOfSectionComponents)}x=ie()?this._dashboardUniqueId||(null===(s=this.context.pageContext.listItem)||void 0===s?void 0:s.uniqueId)||"":this._urlParams.get("id")?this._urlParams.get("id"):null===(o=this.context.pageContext.listItem)||void 0===o?void 0:o.id,I={name:we,isIntentional:!0,siteId:null===(d=null===(c=this.context.pageContext)||void 0===c?void 0:c.site)||void 0===d?void 0:d.id.toString(),webId:null===(p=null===(f=this.context.pageContext)||void 0===f?void 0:f.web)||void 0===p?void 0:p.id.toString(),extraData:Object(v.__assign)(Object(v.__assign)(Object(v.__assign)({actionType:u()||"ExternalLink"!==e?e:"OpenUrl",alias:this.manifest.alias,appHostType:this._appHostType,cardSize:this.cardSize,componentDeveloperName:this.manifest.componentDeveloperName,correlationId:null===(b=null===(h=null===(_=this.context.pageContext)||void 0===_?void 0:_.site)||void 0===h?void 0:h.correlationId)||void 0===b?void 0:b.toString(),deviceContext:this.context.deviceContext,eventSchemaVersion:10,isInternal:this.manifest.isInternal||!1,instanceId:this._instanceIdForLogs,listId:this._urlParams.get("dashboardListID")?this._urlParams.get("dashboardListID"):null===(g=this.context.pageContext.list)||void 0===g?void 0:g.id.toString(),listItemUniqueId:x,manifestId:this.manifest.id,mobileSessionId:n,mobileBootType:a,mpnId:this.manifest.mpnId,renderType:l()&&"QuickView"===e?"Card":this.renderType,tenantId:null===(D=null===(S=null===(y=this.context.pageContext)||void 0===y?void 0:y.aadInfo)||void 0===S?void 0:S.tenantId)||void 0===D?void 0:D.toString().toLowerCase(),vivaConnectionsAppId:Ae,vivaConnectionsName:"MEE",workLoad:t,templateType:this.cardNavigator._currentView._templateType},C),m()?{}:this._cardActionEngagementExtraData),{componentName:r})}}else(I=this._getBaseEngagementData(t,l()&&"QuickView"===e?"Card":this.renderType,n,a)).name=we,I.isIntentional=!0,I.extraData.actionType=u()||"ExternalLink"!==e?e:"OpenUrl",I.extraData.componentName=r;this._logEngagement(I)},t.prototype._logCardComponentEventEngagement=function(e,t,n,a,i){var r=this._getBaseEngagementData(n,"Card",a,i);r.name="AdaptiveCardExtension.ComponentEvent",r.isIntentional=!0,r.extraData.componentName=e,r.extraData.eventName=t,this._logEngagement(r)},t.prototype._initializeCardView=function(e){var t=this;this._initializeBaseView(e),e._getCardSize=function(){return t.cardSize}},t.prototype._initializeBaseView=function(e){e._state=this.state,e._ace=this,e._properties=this.properties,e._context=this.context},Object.defineProperty(t.prototype,"_disableReactivePropertyChanges",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype._onPropertyPaneChangesApplied=function(){return Promise.resolve()},t.prototype._onAfterPropertyPaneChangesApplied=function(){},t.prototype._getQuickView=function(e){var t,n,i,r,o,s,c,d;if(0!==this.quickViewNavigator.size){var l=this.quickViewNavigator._currentView;if(void 0!==l){var u=l._viewType;g()||(this._previousQuickViewId!==this.quickViewNavigator.currentId&&a._EngagementLogger.log({name:"AdaptiveCardExtension.QuickView",isIntentional:!0,siteId:null===(n=null===(t=this.context.pageContext)||void 0===t?void 0:t.site)||void 0===n?void 0:n.id.toString(),webId:null===(r=null===(i=this.context.pageContext)||void 0===i?void 0:i.web)||void 0===r?void 0:r.id.toString(),extraData:{alias:this.manifest.alias,appHostType:this._appHostType,correlationId:null===(o=this.context.pageContext.site.correlationId)||void 0===o?void 0:o.toString(),deviceContext:this.context.deviceContext,instanceId:this._instanceIdForLogs,quickViewType:u,tenantId:null===(d=null===(c=null===(s=this.context.pageContext)||void 0===s?void 0:s.aadInfo)||void 0===c?void 0:c.tenantId)||void 0===d?void 0:d.toString().toLowerCase()}}),this._previousQuickViewId=this.quickViewNavigator.currentId);var f={externalLink:l.externalLink,leftNavigationButtonType:this.quickViewNavigator.size>1?"Back":"Close",title:l.title};if("HTMLQuickView"===u){var p=void 0;return g()||(p={render:this._assignAndRenderHTMLQuickView,dispose:this._disposeHTMLQuickView.bind(this,l),pageBarProperties:f,viewId:this.quickViewNavigator.currentId,viewStackSize:this.quickViewNavigator.size,quickViewType:"HTMLQuickView"}),p}var m=l;return{data:m.data,template:e?this._ACRenderArgs.quickLook.template:m.template,pageBarProperties:f,viewId:this.quickViewNavigator.currentId,viewStackSize:this.quickViewNavigator.size,focusParameters:m.focusParameters,quickViewType:"AdaptiveCardQuickView"}}}},t.prototype._updateRenderArgs=function(e,t){this._ACRenderArgs.lastUpdatedType=e,this._ACRenderArgs.isVisible=this._isVisible,"Card"===e?this._ACRenderArgs.card=this._getCard(t):this._ACRenderArgs.quickLook=this._getQuickView(t)},t.prototype._updateProperty=function(e,t){Object(k.update)(this._properties,e,function(){return t})},t.prototype._startRenderCompletedGuardTimer=function(){var e=this;this._renderCompletedPromise=new Promise(function(t,n){e._renderCompletedPromiseResolver=t,e._renderCompletedPromiseRejector=n}),this._renderCompletedGuardTimer=window.setTimeout(function(){e._renderCompletedPromiseRejector()},i._SPKillSwitch.isActivated("8a4feb2f-ae4e-4174-9be1-0eb0b1371665")?15e3:1e4),this._resolveRenderCompleted()},t.prototype._clearRenderCompletedGuardTimer=function(){this._renderCompletedGuardTimer&&(window.clearTimeout(this._renderCompletedGuardTimer),this._renderCompletedGuardTimer=void 0,this._renderCompletedPromiseResolver=void 0,this._renderCompletedPromiseRejector=void 0,this._renderCompletedPromise=void 0)},t.prototype._generateCacheKey=function(e){return!this.mySiteCacheEnabled||"Mobile"===this.context.deviceContext||this.context.manifest.isolatedDomain?Oe.getKey(this.siteId,this.itemId):null!=e?e:this.instanceId},t.prototype._logInternalOnActionError=function(e,t){new a._QosMonitor("AdaptiveCardExtension._internalOnAction").writeUnexpectedFailure(t,e,{alias:this.context.manifest.alias,deviceContext:this.context.deviceContext,instanceId:this.instanceId,isInternal:this.manifest.isInternal||!1,manifestId:this.context.manifest.id,displayMode:this.displayMode})},t.prototype._beginUpdate=function(){this._isUpdating=!0},t.prototype._endUpdate=function(){this._isUpdating=!1},t.prototype._getBaseEngagementData=function(e,t,n,a){var i,r,o,s,c,d,l,u,f,p,_,h,b,g,y={};if(this.context._getPositionOnPage){var S=this.context._getPositionOnPage();S&&(y.cardPosition=S.componentOrder,y.NumberOfCardsAudienceTargeted=S.numberOfSectionComponents)}return g=ie()?this._dashboardUniqueId||(null===(r=this.context.pageContext.listItem)||void 0===r?void 0:r.uniqueId)||"":this._urlParams.get("id")?this._urlParams.get("id"):null===(i=this.context.pageContext.listItem)||void 0===i?void 0:i.id,{siteId:null===(s=null===(o=this.context.pageContext)||void 0===o?void 0:o.site)||void 0===s?void 0:s.id.toString(),webId:null===(d=null===(c=this.context.pageContext)||void 0===c?void 0:c.web)||void 0===d?void 0:d.id.toString(),extraData:Object(v.__assign)(Object(v.__assign)({alias:this.manifest.alias,appHostType:this._appHostType,cardSize:this.cardSize,componentDeveloperName:this.manifest.componentDeveloperName,correlationId:null===(f=null===(u=null===(l=this.context.pageContext)||void 0===l?void 0:l.site)||void 0===u?void 0:u.correlationId)||void 0===f?void 0:f.toString(),deviceContext:this.context.deviceContext,eventSchemaVersion:10,isInternal:this.manifest.isInternal||!1,instanceId:this._instanceIdForLogs,listId:this._urlParams.get("dashboardListID")?this._urlParams.get("dashboardListID"):null===(p=this.context.pageContext.list)||void 0===p?void 0:p.id.toString(),listItemUniqueId:g,manifestId:this.manifest.id,mobileSessionId:n,mobileBootType:a,mpnId:this.manifest.mpnId,renderType:t,tenantId:null===(b=null===(h=null===(_=this.context.pageContext)||void 0===_?void 0:_.aadInfo)||void 0===h?void 0:h.tenantId)||void 0===b?void 0:b.toString().toLowerCase(),vivaConnectionsAppId:Ae,vivaConnectionsName:"MEE",workLoad:e,templateType:this.cardNavigator._currentView._templateType},y),m()?{}:this._cardActionEngagementExtraData)}},t.prototype._logEngagement=function(e){a._EngagementLogger.log(e)},t}(D.BaseComponent);!function(e){e[e.Image=1]="Image",e[e.Audio=4]="Audio",e[e.Document=8]="Document"}(me||(me={}));var ke=n("2SXB"),Me=n("X+PM"),Pe="embedded-page-container",Te=function(){function e(e){var t=this;this._callbackCache=new Map,this._isolatedFrames=new Map,this._isolatedListeners=new Map,this._handleIframeTimeout=function(e,n){var a=t._isolatedFrames.get(e),i=a.frameMonitor,r=a.retryMonitor,o=a.tokenMonitor;if(a.retryCount<1)return a.retryCount+=1,a.retryMonitor=t._createRetryMonitor(),void(a.timeoutId=setTimeout(function(){return t._handleIframeTimeout(e,n)},14500));if(r&&r.writeUnexpectedFailure("reloadFailed"),i&&!i.hasEnded)try{o?(i.writeUnexpectedFailure("tokenTimeout"),o.hasEnded||o.writeUnexpectedFailure("timeout")):n?i.writeUnexpectedFailure("authorizeTimeout"):i.writeExpectedFailure("authorizeTimeout")}catch(e){i.writeUnexpectedFailure("unexpectedFailure",e)}},this._handleIsolatedApplicationMessage=function(e){var n=e.data;if("applicationMessage"===n.messageType){var a=n.instanceId,i=n.kind;switch(i){case"Card":t._invokeCallback(a,{aceData:n.aceData,card:n.card,cacheObject:n.cacheObject,type:i});break;case"CloseQuickView":var r=t._isolatedFrames.get(new URL(e.origin).hostname);r&&(r.iframe.hidden=!0);break;case"Error":t._invokeCallback(a,{error:n.error,type:i});break;case"OpenQuickView":var o=t._isolatedFrames.get(new URL(e.origin).hostname);o&&(o.iframe.hidden=!1);break;case"OpenUrl":t._invokeCallback(a,{type:i,url:n.url});break;case"LocationRequest":t._invokeCallback(a,{type:i});break;case"RenderCompleted":t._invokeCallback(a,{type:i,didUpdate:n.didUpdate});break;case"Ready":var s=t._isolatedFrames.get(new URL(e.origin).hostname);if(s){s.retryMonitor&&s.retryMonitor.writeSuccess(),clearTimeout(s.timeoutId),s.frameMonitor.writeSuccess(),s.isReady=!0;for(var c=0,d=s.messageQueue;c<d.length;c++){var l=d[c],u=l[0],f=l[1];t._sendMessage(t._getIsolatedFrame(u),u,f)}s.messageQueue=[]}break;case"OBOTokenRequest":var p=n.applicationId,m=n.claims;t._getAuthToken(p,m,e.origin);break;case"PropertyPaneConfiguration":t._invokeCallback(a,{propertyPaneConfiguration:n.propertyPaneConfiguration,type:i});break;default:t._logError("Unexpected message: ".concat(JSON.stringify(e.data)))}}else if("bridgeMessage"===n.messageType&&"onTokenRequested"===n.bridgeAction){var _=t._createTokenRequestMonitor(),h=(p=n.applicationId,m=n.claims,t._isolatedFrames.get(new URL(e.origin).hostname));if(!h)return void _.writeUnexpectedFailure("missingIsolatedFrame");h.tokenMonitor=_;var b=ke._AadTokenProviders.configurable;if(!b._oboThirdPartyTokenCallback)return void _.writeUnexpectedFailure("missingThirdPartyTokenCallback");try{b._oboThirdPartyTokenCallback(p,m).then(function(e){if(!h.iframe.contentWindow)throw new Error("missingContentWindow");h.iframe.contentWindow.postMessage({token:e,messageType:"dashboardMessage",kind:"Token"},"*"),_.writeSuccess()}).catch(function(e){_.writeUnexpectedFailure("oboThirdPartyTokenCallbackError",e)})}catch(e){_.writeUnexpectedFailure("unexpectedException",e)}}},this._serviceScope=e,window.addEventListener("message",this._handleIsolatedApplicationMessage)}return Object.defineProperty(e.prototype,"_pageContext",{get:function(){return this._pContext||(this._pContext=this._serviceScope.consume(Me.PageContext.serviceKey)),this._pContext},enumerable:!1,configurable:!0}),e.prototype.disposeEntry=function(e,t){if(this._isolatedListeners.delete(e),!s()){this._callbackCache.delete(e);var n=this._isolatedFrames.get(t);n&&(n.childInstanceIds.delete(e),0===n.childInstanceIds.size&&(document.body.removeChild(n.iframe),this._isolatedFrames.delete(t)))}},e.prototype.load=function(e){var t=this,n=e.callback,a=e.instanceId,r=e.listenerId,o=e.isolatedDomain.toLowerCase(),c=this._isolatedFrames.get(o);if(!c){var d=this._createLoadMonitor(),l=document.createElement("iframe");i._SPKillSwitch.isActivated("1c48a38c-d3a7-4440-9c3e-58a56a92f5be")||window.name!==Pe||(l.name=Pe);var u=i._BrowserUtilities.isTeams1PVivaDesktopHosted();l.src=this._configureIframeSrc(o,e,u),l.hidden=!0,l.scrolling="no",l.style.overflow="hidden",l.style.height="100%",l.style.width="100%",l.style.top="0",l.style.left="0",l.style.position="fixed",l.style.zIndex="99999",l.style.border="none",l.setAttribute("allow","geolocation"),l.setAttribute("data-automation-id","isolated_ACE_iframe"),document.body.appendChild(l);var f=o.toLowerCase();(c={iframe:l,frameMonitor:d,isReady:!1,messageQueue:[],retryCount:0,childInstanceIds:new Set}).timeoutId=setTimeout(function(){t._handleIframeTimeout(f,u)},15e3),this._isolatedFrames.set(f,c)}s()||c.childInstanceIds.add(a);var p=this._isolatedListeners.get(a);if(p)p.listeners.get(r)||p.listeners.set(r,{callback:n});else{var m=this._createIsolatedListenerEntry(o,c.iframe,e);this._isolatedListeners.set(a,m)}e.isRenderedFromPersistedData?this._handleRenderingFromPersistedData(e):this.sendInitialize(e);var _=this._callbackCache.get(a);_&&this._invokeCallback(a,_,r)},e.prototype.renderQuickView=function(e){var t=e.instanceId,n=e.isSelectAction,a=e.listenerId,i=e.pageTheme,r=e.targetRect,o=e.theme,s=e.viewId;this._sendMessage(this._getIsolatedFrame(t),t,{serviceAction:"Action",action:{action:{type:"QuickView",isSelectAction:n,pageTheme:i,targetRect:r,theme:o,viewId:s},instanceId:t,listenerId:a}})},e.prototype.setDisplayMode=function(e){},e.prototype.setRenderType=function(e){},e.prototype.sendAction=function(e){var t=e.instanceId;this._sendMessage(this._getIsolatedFrame(t),t,{serviceAction:"Action",action:e})},e.prototype.sendOnBeforeAction=function(e){var t=e.instanceId;this._sendMessage(this._getIsolatedFrame(t),t,{serviceAction:"OnBeforeAction",action:e})},e.prototype.sendInitialize=function(e){var t=e.instanceId,n=e.manifestId;this._sendMessage(this._getIsolatedFrame(t),t,{serviceAction:"Initialize",instanceId:t,manifestId:n})},e.prototype.updateACEData=function(e,t){this._isolatedListeners.has(e)&&this._sendMessage(this._getIsolatedFrame(e),e,{aceData:t,instanceId:e,serviceAction:"UpdateACEData"})},e.prototype.handleLocationRequest=function(e,t,n){this._sendMessage(this._getIsolatedFrame(e),e,{location:t,locationError:n,instanceId:e,serviceAction:"LocationResponse"})},e.prototype._createLoadMonitor=function(){return new a._QosMonitor("IsolatedAdaptiveCardExtensionService.load")},e.prototype._createRetryMonitor=function(){return new a._QosMonitor("IsolatedAdaptiveCardExtension.iframeReload")},e.prototype._createTokenRequestMonitor=function(){return new a._QosMonitor("IsolatedAdaptiveCardExtensionService.onTokenRequested")},e.prototype._createGetAuthTokenMonitor=function(){return new a._QosMonitor("IsolatedAdaptiveCardExtensionService._getAuthToken")},e.prototype._configureDestUrlParams=function(e){var t=e.dashboardListId,n=e.itemId,a=new URLSearchParams(window.location.search);return a.append("dashboardListID",t),a.append("id",n),1===O._SPPerfExperiment.getVariantAndTrackExperiment(O._PerformanceExperiment.WEXOOPIF)&&a.append("OOPIF","1"),a.append("deviceContext",i._BrowserUtilities.isTeams1PVivaDesktopHosted()?"TeamsDesktop":"WebView"),i._SPKillSwitch.isActivated("1c24002d-a9fe-462b-b168-b020b9817747")||a.append("parentWindowOrigin",window.location.origin),a},e.prototype._configureIframeSrc=function(e,t,n){var a=this._pageContext.site.serverRelativeUrl,r="/"===a?"":a,o=Object(D._ensureIsolatedDomainUrl)(e,this._pageContext.web.absoluteUrl),s=this._configureDestUrlParams(t),c=t.serviceDestinationEndpoint,d=i._SPKillSwitch.isActivated("e8daf7db-132e-4225-93a4-70cc5fc06bb9")||void 0===c?"adaptivecardextensions.aspx":c,l="/_layouts/15/".concat(d,"?").concat(s.toString());return i._BrowserUtilities.isUsingSecureBroker()?"".concat(o,"/_layouts/15/brokerlogon.aspx?spfx=true&").concat(i._BROKER_IN_USE_KEY,"=true&dest=").concat(encodeURIComponent(o+l)):n&&i._SPFlight.isEnabled(60128)?"".concat(o,"/_layouts/15/framedteamslogon.aspx?spfx=true&dest=").concat(encodeURIComponent(r+l)):o+l},e.prototype._createIsolatedListenerEntry=function(e,t,n){var a=n.listenerId,i=n.callback,r=n.manifestId;return{isolatedDomain:e,iframe:t,listeners:new Map([[a,{callback:i}]]),manifestId:r}},e.prototype._handleRenderingFromPersistedData=function(e){},e.prototype._getIsolatedFrame=function(e){var t=this._isolatedListeners.get(e);return t?this._isolatedFrames.get(t.isolatedDomain):void 0},e.prototype._sendMessage=function(e,t,n){e?this._postOrQueueMessage(e,n,t):this._logError("No entry for ".concat(t))},e.prototype._invokeCallback=function(e,t,n){var a,i=this._isolatedListeners.get(e);this._callbackCache.set(e,t),i?n?null===(a=i.listeners.get(n))||void 0===a||a.callback(t):i.listeners.forEach(function(e){return e.callback(t)}):this._logError("No entry for ".concat(e))},e.prototype._logError=function(t){a._TraceLogger.logError(e._logSource,new Error(t))},e.prototype._getAuthToken=function(e,t,n){var a=this,i=this._createGetAuthTokenMonitor(),r=ke._AadTokenProviders.configurable;if(!r._oboThirdPartyTokenCallback)return i.writeUnexpectedFailure("oboThirdPartTokenCallbackUndefined"),void this._logError("Unexpected message: oboThirdPartyTokenCallback is not defined.");r._oboThirdPartyTokenCallback(e,t).then(function(t){var r=new URL(n),o=a._isolatedFrames.get(r.hostname);a._sendMessage(o,"",{token:t,applicationId:e,serviceAction:"OBOToken"}),i.writeSuccess()}).catch(function(e){i.writeUnexpectedFailure("oboThirdPartTokenCallbackFailure"),a._logError("Unexpected message: ".concat(JSON.stringify(e)))})},e.prototype._postOrQueueMessage=function(e,t,n){e.isReady?(t.messageType="serviceMessage",e.iframe.contentWindow.postMessage(t,"*")):e.messageQueue.push([n,t])},e.serviceKey=i.ServiceKey.create("sp-adaptive-card-extension-base::IsolatedAdaptiveCardExtensionService",e),e._logSource={id:"IsolatedAdaptiveCardExtensionService"},e}(),Ue=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._templateType="Image",t}return Object(v.__extends)(t,e),t.prototype._getCardViewParameters=function(){var e=this.data,t=le({image:{url:e.imageUrl,altText:e.iconAltText,_urlFallback:e._imageUrlFallback},cardBar:this._getCardBarConfiguration(),header:{componentName:"text",text:e.primaryText},footer:this._getGenericCardViewFooterConfiguration()});return t.cardViewType="image-template",t},Object.defineProperty(t.prototype,"template",{get:function(){return this._getTemplate(Y,X)},enumerable:!1,configurable:!0}),t}(B),Fe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._templateType="PrimaryText",t}return Object(v.__extends)(t,e),t.prototype._getCardViewParameters=function(){var e=this.data,t=de({cardBar:this._getCardBarConfiguration(),header:{componentName:"text",text:e.primaryText},body:{componentName:"text",text:e.description},footer:this._getGenericCardViewFooterConfiguration()});return t.cardViewType="primaryText-template",t},Object.defineProperty(t.prototype,"template",{get:function(){return this._getTemplate(J,Z)},enumerable:!1,configurable:!0}),t}(B),He=function(e){function t(t){var n=e.call(this)||this;return n._serviceScope=t,n._cacheEntries={},n._cacheProvider=n._serviceScope.consume(Object(ke._getCacheDataProviderServiceKey)())._provider,n._providerPromises=new Map,n}return Object(v.__extends)(t,e),t.instance=function(e){return t._instance||(t._instance=new t(e)),t._instance},t.prototype.save=function(e,t,n){var i,r,o=e!==t?"DashboardWebPart":"DashboardPage",s=new a._QosMonitor("ACEMySiteCache.save.".concat(o)),c={key:e};if(d()||this._cacheProvider){if(!this._cacheEntries[e]){var l=((i={})[t]=n,i);this._cacheEntries[e]=l}this._cacheEntries[e][t]=n,null===(r=this._cacheProvider)||void 0===r||r.setData(c,this._cacheEntries[e],this._getCacheConfig(e)).then(function(e){if(e)return s.writeSuccess({isDataSaved:e}),Promise.resolve();s.writeUnexpectedFailure("dataIsNotSaved")}).catch(function(e){s.writeUnexpectedFailure("mySiteCacheSetDataFailed",e)})}else s.writeExpectedFailure("cacheProvider is undefined")},t.prototype.get=function(t,n){return e.prototype.get.call(this,t,n)},t.prototype.getFromSource=function(e,t){var n=this,i=e!==t?"DashboardWebPart":"DashboardPage",r=new a._QosMonitor("ACEMySiteCache.getFromSource.".concat(i)),o={key:e},s=this._providerPromises.get(e);return d()||this._cacheProvider?(s||(s=this._cacheProvider.getData(o,this._getCacheConfig(e)).then(function(e){return r.writeSuccess(),e.data}).then(function(t){n._populateLocalCache(e,t)}).catch(function(a){n._providerPromises.delete(e);var i={instanceId:t};return 100001===a.errorCode?r.writeExpectedFailure("cacheMiss",a,i):r.writeUnexpectedFailure("unexpectedError",a,i),Promise.reject(a)}),this._providerPromises.set(e,s)),s.then(function(){return n._cacheEntries[e]?n._cacheEntries[e][t]:void 0})):(r.writeExpectedFailure("cacheProvider is undefined"),Promise.resolve(void 0))},t.prototype._populateLocalCache=function(e,t){var n=Object.keys(t),a={};n.forEach(function(e){a[e]=t[e]}),this._cacheEntries[e]=a},t.prototype._getCacheConfig=function(e){return{cacheStrategy:ke._CacheStrategy.CacheAndNetwork,expirationDuration:void 0,id:e,alias:"ACEMySiteCacheManager",extraProps:t._cacheExtraProps}},t._cacheExtraProps=new Map([["onlyMySiteCache",!0]]),t}(Ce),Re=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._viewType="HTMLQuickView",t}return Object(v.__extends)(t,e),t.prototype._setDomElement=function(e){this._domElement=e},t.prototype.setState=function(e){this._ace._internalSetState(e,!1)},t.prototype.dispose=function(){},Object.defineProperty(t.prototype,"domElement",{get:function(){if(!this._domElement)throw new Error("Accessing DOM before initialized");return this._domElement},enumerable:!1,configurable:!0}),t}(be);function Ne(e){return Object(v.__assign)(Object(v.__assign)({},e),{componentName:"searchBox"})}function Be(e){return Object(v.__assign)(Object(v.__assign)({},e),{componentName:"searchFooter"})}function je(e){var t=e.cardBar,n=e.header,a=e.body,i=e.footer;return{cardViewType:"search",image:void 0,cardBar:[re(t)],header:[oe(n)],body:[Ne(a)],footer:[Be(i)]}}var Ve=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(v.__extends)(t,e),t.prototype._getCardViewParameters=function(){var e=this.cardViewParameters;return this.cardViewParameters.cardBar[0].title&&this.cardViewParameters.cardBar[0].icon?e:Object(v.__assign)(Object(v.__assign)({},e),{cardBar:[this._ensureCardBarParameters(e.cardBar[0])]})},t.prototype._ensureCardBarParameters=function(e){var t,n,a;return Object(v.__assign)(Object(v.__assign)({},e),{title:e.title||this._ace.title,icon:{url:(null===(t=e.icon)||void 0===t?void 0:t.url)||this._ace.iconProperty,altText:null===(n=e.icon)||void 0===n?void 0:n.altText,_urlFallback:null===(a=e.icon)||void 0===a?void 0:a._urlFallback}})},t}(H);function ze(e){var t,n;if("QuickView"===e.lastUpdatedType&&(i._SPKillSwitch.isActivated("b764e8cc-79df-4487-a967-5ade7b428b61")||"AdaptiveCardQuickView"===(null===(t=e.quickLook)||void 0===t?void 0:t.quickViewType))||!(null===(n=e.card)||void 0===n?void 0:n.cardViewParameters))return{renderArguments:e};var r,o,s,c,d,l=new a._QosMonitor("AdaptiveCardExtension.prepareRenderArgumentsForMessaging");if("QuickView"===e.lastUpdatedType)e.quickLook=(s=e.quickLook,c=Object(k.cloneDeep)(s),d=c,Object.keys(d).forEach(function(e){"function"==typeof d[e]&&delete d[e]}),c),r=e.quickLook.quickViewType;else{var u=function(e,t){var n=function(e){var t=We(e.body),n=We(e.footer);if(t||n)return{body:t,footer:n}}(e);if(!n)return[e,void 0];var a=Object(k.cloneDeep)(e),i=a.body,r=a.footer,o=new Map;return Ke(t,"body",i,e.body,n.body,o),Ke(t,"footer",r,e.footer,n.footer,o),[a,o]}(e.card.cardViewParameters,e.instanceId),f=u[0],p=u[1];e.card.cardViewParameters=f,o=p,r=f.cardViewType}return l.writeSuccess({viewType:r}),{renderArguments:e,eventComponents:o}}function Ge(e,t){var n,a=e._getRenderArguments(t);return"Card"===t&&(null===(n=a.card)||void 0===n?void 0:n.cardViewParameters)?ze(a):{renderArguments:a}}function Ke(e,t,n,a,r,o){n&&r&&n.forEach(function(n,s){var c=r[s];if(c){var d=j(e,t,n,s);n.id=d,n._events=c,i._SPKillSwitch.isActivated("239e997f-e9d4-4202-ac2f-8d2dfda99e69")||c.forEach(function(e){delete n[e]}),o.set(d,a[s])}})}function We(e){if(e){var t=!1,n=e.map(function(e){var n,a=e;return Object.keys(e).forEach(function(e){"function"==typeof a[e]&&(n||(n=[]),n.push(e))}),t=t||!!n,n});if(t)return n}}},ut3N:function(e,t){e.exports=l}})});