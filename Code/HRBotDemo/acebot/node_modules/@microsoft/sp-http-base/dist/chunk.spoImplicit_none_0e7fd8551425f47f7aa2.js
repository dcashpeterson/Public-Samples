(window.webpackJsonp_8496636c_2300_4915_abef_20de64c98d8b_1_18_2=window.webpackJsonp_8496636c_2300_4915_abef_20de64c98d8b_1_18_2||[]).push([[10],{nUPw:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n("jtSf"),i=n("MGiw"),r=n("UWqr"),o=n("bB1B"),s=function(){function e(){}return e._handleInteractionRequiredFailures=function(t,n,s){e._doesAadErrorCodeExist(n,i.e.UNRESOLVABLE_AAD_ERROR_CODES)||i.e.RESOLVABLE_ERROR_CODES.forEach(function(e){if(n.indexOf(e)>-1){var i=t._getNavigateUrl(t.RESPONSE_TYPE.TOKEN,s)+"&prompt=select_account";r._SPEventManager.instance.raiseEvent(a.a._tokenAcquisitionEventId,new a.n(o.e,i))}})},e._isInteractionRequired=function(t,n){return!e._doesAadErrorCodeExist(t,i.e.UNRESOLVABLE_AAD_ERROR_CODES)&&i.e.RESOLVABLE_ERROR_CODES.has(n)},e._isTokenRenewalTimeout=function(e){return e===i.e.TOKEN_RENEWAL_TIMEOUT},e._isEndpointsResolutionError=function(e){return e===i.e.ENDPOINTS_RESOLUTION_ERROR},e._isSessionDoesNotExistError=function(e,t){return e.indexOf(i.e.SESSION_DOES_NOT_EXIST_ERROR)>-1||t.indexOf(i.e.SESSION_DOES_NOT_EXIST_ERROR)>-1},e._doesAadErrorCodeExist=function(e,t){for(var n=0,a=e.match(/(AADSTS)[0-9]+/g)||[];n<a.length;n++){var i=a[n];if(t.has(i))return!0}return!1},e}()},onrO:function(e,t,n){"use strict";n.r(t),n.d(t,"ImplicitFlowTokenProvider",function(){return _});var a=n("ut3N"),i="adal.access.token.key",r="adal.expiration.key",o=function(){function e(e){this._memoryCache=new Map,this._aadUserId=e.aadUserId||"",this._clientId=e.servicePrincipalId}return e.getCacheKey=function(e,t,n,a){return e+"|"+t+"|"+n+"|"+a},e._getTokenExpirationInMilliseconds=function(e){var t=parseInt(e,10);return Date.now()+1e3*t},e._isExpired=function(e){return Date.now()>=parseInt(e,10)-1e4},e._isValid=function(t,n){return!(!t||!n||e._isExpired(n))},e.prototype.getToken=function(t){var n=e.getCacheKey(this._aadUserId,this._clientId,i,t),a=e.getCacheKey(this._aadUserId,this._clientId,r,t),o=this._memoryCache.get(t);if(o){if(e._isValid(o.token,o.expiration))return o.token;this._memoryCache.delete(t)}var s="";try{s=sessionStorage.getItem(n)||"";var c=sessionStorage.getItem(a)||"";e._isValid(s,c)||(sessionStorage.setItem(n,""),sessionStorage.setItem(a,""),s="")}catch(e){}return s},e.prototype.saveToken=function(t,n){var a=e.getCacheKey(this._aadUserId,this._clientId,i,n),o=e.getCacheKey(this._aadUserId,this._clientId,r,n);this._memoryCache.set(n,t);try{sessionStorage.setItem(a,t.token),sessionStorage.setItem(o,e._getTokenExpirationInMilliseconds(t.expiration).toString())}catch(e){}},e}(),s=n("UWqr"),c=n("jtSf"),d=n("MGiw"),l=n("nUPw"),u=n("bB1B"),f=/\+/g,p=/([^&=]+)=([^&]*)/g,m=function(){function e(e){this._defaultConfiguration=e,this._resourceMap=new Map}return e.isSuccessfulResponse=function(e){return!!e.token&&!!e.expiration},e.isExpectedError=function(e){var t=s._BrowserDetection.getBrowserInformation().userAgent||"";return l.e._doesAadErrorCodeExist(e,d.e.EXPECTED_AAD_ERRORS)||t.indexOf("TabStop/1.0")>-1},e._createResourceMetadata=function(e){return{correlationId:s.Guid.newGuid().toString(),state:s.Guid.newGuid().toString(),uri:e}},e._monitorWindowForHash=function(e,t){return new Promise(function(n,a){var i=t/50,r=0,o=Date.now(),s=setInterval(function(){var t;e.closed&&(clearInterval(s),a(new Error("User closed iframe")));try{t=e.location.hash}catch(e){}r++,t?(clearInterval(s),t.indexOf("#/")>-1?t=t.substring(t.indexOf("#/")+2):t.indexOf("#")>-1&&(t=t.substring(1)),n(t)):r>i&&(clearInterval(s),Date.now()>o+6e4?a(new Error("Timeout due to TAB suspension")):a(new Error("Token retrieval timeout")))},50)})},e._deserialize=function(e){var t,n=f,a=p,i=function(e){return decodeURIComponent(e.replace(n," "))},r={};for(t=a.exec(e);t;)r[i(t[1])]=i(t[2]),t=a.exec(e);return r},e._createIframe=function(e,t){var n=document.createElement("iframe");n.setAttribute("id",e),n.setAttribute("aria-hidden","true"),n.setAttribute("sandbox","allow-same-origin allow-scripts allow-forms allow-pointer-lock"),n.style.visibility="hidden",n.style.position="absolute",n.style.width=n.style.height=n.style.border="0";var a=document.getElementsByTagName("body")[0].appendChild(n);return a.src=t,a},e.prototype.getToken=function(t,n){var a=this._resourceMap.get(t);return a||(a=e._createResourceMetadata(t),this._resourceMap.set(t,a)),this._getToken(t,n,a,0)},e.prototype._getToken=function(t,n,i,r){var o=this;void 0===r&&(r=0);var s=new a._QosMonitor("ImplicitTokenProvider.FetchAccessTokenSilent"),c=this._generateTelemetryExtraData(t,i.correlationId);return this._generateTokenRequestPromise(i,n).then(function(a){if(e.isSuccessfulResponse(a))s.writeSuccess(c);else if(o._handleAuthErrors(s,t,a.errorDescription,a.errorCode,c),r<1){var l=n;return a.errorDescription.indexOf(d.e.LOGIN_REQUIRED)>-1&&(l=!1),o._getToken(t,l,i,++r)}return a}).catch(function(e){if(s.writeUnexpectedFailure("Timeout",e),r<1)return o._getToken(t,n,i,++r);throw e})},e.prototype._generateTelemetryExtraData=function(e,t){return{alias:"false",CorrelationId:t,isInternal:this._defaultConfiguration.servicePrincipalId===d.e.PRE_AUTHORIZED_APP_PRINCIPAL_ID,name:e}},e.prototype._handleAuthErrors=function(t,n,a,d,f){if(l.e._isInteractionRequired(a,d)){try{sessionStorage.setItem("adal.login.request",window.location.href),sessionStorage.setItem("SPORedirectTokenKey",o.getCacheKey(this._defaultConfiguration.aadUserId||"",this._defaultConfiguration.servicePrincipalId,i,n)),sessionStorage.setItem("SPORedirectExpirationKey",o.getCacheKey(this._defaultConfiguration.aadUserId||"",this._defaultConfiguration.servicePrincipalId,r,n))}catch(e){}s._SPEventManager.instance.raiseEvent(c.a._tokenAcquisitionEventId,new c.n(u.e,this._getTokenRequestUrl(e._createResourceMetadata(n),!1,!1)))}var p=new Error(d+": "+a);e.isExpectedError(a)?t.writeExpectedFailure(d,p,f):t.writeUnexpectedFailure(d,p,f)},e.prototype._getTokenRequestUrl=function(e,t,n){var a=t&&this._defaultConfiguration.userPrincipalName?"&login_hint="+encodeURIComponent(this._defaultConfiguration.userPrincipalName):"",i=n?"&prompt=none":"&prompt=select_account";return this._defaultConfiguration.aadInstanceUrl+"/"+this._defaultConfiguration.aadTenantId+"/oauth2/authorize?response_type=token&client_id="+encodeURIComponent(this._defaultConfiguration.servicePrincipalId)+"&resource="+encodeURIComponent(e.uri)+"&redirect_uri="+encodeURIComponent(this._defaultConfiguration.redirectUri)+"&state="+encodeURIComponent(e.state)+a+"&client-request-id="+encodeURIComponent(e.correlationId)+"&x-client-SKU=Js&x-client-Ver=SPFxImplicitTokenProvider"+i},e.prototype._generateTokenRequestPromise=function(t,n){var a=this,i=this._getTokenRequestUrl(t,n,!0),r=e._createIframe(t.correlationId+"|"+t.uri,i);return e._monitorWindowForHash(r.contentWindow,1e4).then(function(e){return a._convertHashtoTokenResponse(t,e)})},e.prototype._convertHashtoTokenResponse=function(t,n){var a=e._deserialize(n);if(t.state!==a.state)return{errorCode:"Invalid State",errorDescription:"State mismatch. Expected:"+t.state+" Actual: "+a.state,isExpected:!1};var i=a.access_token;return i?{expiration:a.expires_in||"3600",token:i}:{errorCode:a.error||"Unknown",errorDescription:a.error_description||"Error Description was missing",isExpected:e.isExpectedError(a.error_description||"Error Description was missing")}},e}(),_=function(){function e(e){this._configuration=e,this._tokenStorage=new o(e),this._tokenRequestManager=new m(e)}return e.prototype.getToken=function(e,t){var n=this;void 0===t&&(t=!0);var i=(t&&"object"==typeof t?t:{useCachedToken:t}).useCachedToken,r=void 0===i||i,o=new a._QosMonitor("ImplicitTokenProvider.GetAccessTokenSilent"),s=this._tokenRequestManager._generateTelemetryExtraData(e,this._configuration.spRequestGuid),c=this._tokenStorage.getToken(e);return r&&c?(s.alias="true",o.writeSuccess(s),Promise.resolve(c)):this._tokenRequestManager.getToken(e,!0).then(function(t){if(m.isSuccessfulResponse(t))return n._tokenStorage.saveToken(t,e),o.writeSuccess(s),t.token;throw new Error(t.errorCode+": "+t.errorDescription)}).catch(function(e){throw m.isExpectedError(e.message)?o.writeExpectedFailure("GetTokenFailure",e):o.writeUnexpectedFailure("GetTokenFailure",e),e})},e}()}}]);