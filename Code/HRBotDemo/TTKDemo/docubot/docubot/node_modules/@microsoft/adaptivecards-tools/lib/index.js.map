{"version":3,"file":"index.js","sources":["../src/AdaptiveCards.ts","../src/AdaptiveCard.tsx","../src/jsxExamples.tsx"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-namespace */\n// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\nimport { Template } from \"adaptivecards-templating\";\nimport { AdaptiveCard as AC, IAdaptiveCard } from \"adaptivecards\";\nimport Markdown from \"markdown-it\";\n\nconst md = new Markdown();\n\nAC.onProcessMarkdown = function (text, result) {\n  result.outputHtml = md.render(text);\n  result.didProcess = true;\n};\n\nexport namespace AdaptiveCards {\n  export type Schema = IAdaptiveCard;\n  export type Payload = IAdaptiveCard;\n\n  export function isAdaptiveCardSchema(object: any): object is Schema {\n    return object.type == \"AdaptiveCard\";\n  }\n\n  export function renderWithData<D>(template: Schema, data: D): Schema {\n    const payload = new Template(template).expand({ $root: data });\n    return payload;\n  }\n\n  export function renderToHtmlElement<D extends object = any>(template: Schema, data?: D) {\n    return declare<D>(template).renderToHtmlElement(data);\n  }\n\n  export function declare<D extends object>(template: any, defaults?: (d: D) => D) {\n    return {\n      template,\n      render(data?: D): Schema {\n        return typeof defaults == \"function\"\n          ? renderWithData<D>(template, defaults(data as any))\n          : data\n          ? renderWithData<D>(template, data)\n          : template;\n      },\n      refresh(verb: string, userIds: string[], data?: D) {\n        template.refresh = {\n          action: {\n            type: \"Action.Execute\",\n            title: verb,\n            verb,\n            data,\n          },\n          userIds,\n        };\n        return this;\n      },\n      renderToHtmlElement(data?: D): HTMLElement | undefined {\n        const ac = new AC();\n        ac.parse(this.render(typeof defaults == \"function\" ? defaults(data as any) : data));\n        return ac.render();\n      },\n    };\n  }\n\n  export function declareWithoutData(template: any) {\n    const withoutData = declare<object>(template);\n    return {\n      template,\n      render(): Schema {\n        return withoutData.render();\n      },\n      renderToHtmlElement(): HTMLElement | undefined {\n        return withoutData.renderToHtmlElement();\n      },\n    };\n  }\n}\n","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\nimport { AdaptiveCards } from \"./AdaptiveCards\";\nimport React from \"react\";\n\nexport interface AdaptiveCardProps<D> {\n  template: AdaptiveCards.Schema;\n  data?: D;\n}\n\n// TODO: Error handling\n// TODO: plain payload without templating\n// TODO: better rendering to JSX instead of DOM manipulation directly\n// TODO: support themes and simulating renderers (Teams, Outlook, themes)\nexport function AdaptiveCard<D = any>(props: AdaptiveCardProps<D>): any {\n  const { template, data } = props;\n\n  try {\n    const payload = data ? AdaptiveCards.renderWithData(template, data) : template;\n    return (\n      <div\n        className=\"ac-container\"\n        ref={(v) => {\n          v?.firstChild && v?.removeChild(v.firstChild);\n          const ac = AdaptiveCards.renderToHtmlElement(payload);\n          ac && v?.appendChild(ac);\n        }}\n      ></div>\n    );\n  } catch (err) {\n    return (\n      <div className=\"ac-container error\">\n        <div>{(err as unknown as any).toString()}</div>\n      </div>\n    );\n  }\n}\n","// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\nimport React from \"react\";\n\nexport function TextBlock(p: { children: any }): any {\n  return <div></div>;\n}\nexport function Bold(p: { children: any }): any {\n  return <div></div>;\n}\n"],"names":["Markdown","AC","AdaptiveCards","Template","React"],"mappings":"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"}